#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass ctex-article
\begin_preamble
% 如果没有这一句命令，XeTeX会出错，原因参见
% http://bbs.ctex.org/viewthread.php?tid=60547
\DeclareRobustCommand\nobreakspace{\leavevmode\nobreak\ }

%\XeTeXlinebreaklocale "zh"
%\XeTeXlinebreakskip = 0pt plus 1pt
%\usepackage{setspace}
%\onehalfspacing
%\XeTeXinterchartokenstate=1

%\usepackage[utf8]{inputenc}

%\usepackage{polyglossia}
%\setdefaultlanguage[variant=american]{english}
%\setotherlanguage{french}

\usepackage[title]{appendix}
\end_preamble
\options UTF8,fontset=founder
\use_default_options true
\begin_modules
subequations
\end_modules
\maintain_unincluded_children false
\language chinese-simplified
\language_package default
\inputencoding utf8-plain
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts true
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format pdf4
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_title "用于GPS缺失时可观测的导航相对乘性扩展卡尔曼滤波"
\pdf_author "Daniel P Koch, David O Wheeler, Randal W Beard, Timothy W McLain, Kevin M Brink"
\pdf_keywords "Sensor fusion, vision-aided inertial navigation, multiplicative extended Kalman filter, aerial robotics"
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize a4paper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 25.4mm
\topmargin 30mm
\rightmargin 25.4mm
\bottommargin 30mm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
\begin_inset CommandInset href
LatexCommand href
name "用于GPS缺失时可观测的导航相对乘性扩展卡尔曼滤波"
target "https://scholarsarchive.byu.edu/facpub/1963/"
literal "false"

\end_inset


\end_layout

\begin_layout Author
Daniel P Koch, David O Wheeler, Randal W Beard, Timothy W McLain, Kevin
 M Brink
\end_layout

\begin_layout Date
August 1, 2020
\end_layout

\begin_layout Abstract
本文提出了一种乘性扩展Kalman滤波(multiplicative extended Kalman filter, MEKF)，用于估计在GPS缺失环境下运行
的多旋翼飞行器的相对状态。该滤波器将来自惯性测量单元和高度计的数据，与相对位姿更新数据，该数据来自基于关键帧的视觉里程计或激光扫描匹配算法，进行融合。由于车辆的
全局位置和航向状态在没有GPS等全局测量的情况下是不可观测的，因此本文中的滤波器估计的是相对于与里程计关键帧共同定位的局部帧的状态。因此，里程计更新提供了对于相
对车辆位姿几乎是直接的测量，使得这些状态可观测。最近的出版物严格记录了这种可观测参数化的理论优势，包括改进的一致性、准确性和系统鲁棒性，并在长时间的多旋翼飞行试
验中证明了这种方法的有效性。本文通过提供一个完整的、自包含的、相关MEKF的教程式的推导来补充以前的工作，这个推导已经得到了充分的激发，但到目前为止只有简单的描
述。本文介绍了对滤波器的一些改进和扩展，同时清楚地定义了所使用的所有四元数约定和属性，包括与误差四元数及其欧拉角分解有关的一些新的有用属性。最后，本文推导的滤波
器，既可用于是相对于惯性坐标系定义的传统动力学，也可用于相对于机体坐标系定义的机器人中心动力学，本文并对这两套公式之间产生的细微差异进行了深入的分析。
\end_layout

\begin_layout Section
简介
\end_layout

\begin_layout Standard
小型无人飞机系统(UAS)在GPS缺失环境下导航是一个活跃而丰富的研究领域，具有重要的实际应用，如基础设施检查和安全。大多数无人机系统将GPS与加速计和速率陀螺
数据融合，以提供适合于反馈控制的精确全局状态估计。但是，当GPS不可用时，需要额外的传感器，如照相机或激光雷达。由于尺寸、重量和功率限制以及与小型无人机相关的快
速车辆动力学，许多此类系统采用基于滤波的估计技术来整合这些附加传感器，而不是传统的完全的同步定位和建图(SLAM)算法。基于滤波器的方法在计算上是高效的，并能确
保控制所需的平滑、及时的状态估计。
\end_layout

\begin_layout Standard
在没有GPS更新的情况下，许多滤波方法利用来自视觉里程计或激光扫描匹配的增量里程计测量。这些里程测量可以逐帧计算，或者可以针对同一
\series bold
关键帧
\series default
(
\emph on
keyframe
\emph default
)图像或扫描计算多个测量。当与当前图像或扫描的重叠不足以计算可靠的里程测量值时，关键帧图像或扫描将被更新。基于关键帧的方法具有减少里程测量中时间漂移的优势(Le
utenegger等人，2015[24])。
\end_layout

\begin_layout Standard
尽管只有增量测量可用，大多数GPS缺失导航方法直接估计车辆相对于某些固连原点的全局位姿。然而，如果没有全局位置测量，车辆的全局位姿和航向是不可观测的(Marti
nelli，2012[26]；Weiss等人，2012[35]；Jones等人，2007[15])。因此，全局滤波器可能会受到不一致和无界的状态不确定性、在应用
相对测量时的不稳定状态跳跃的影响，以及无法直接应用间歇性的全局信息而不引起大的状态跳跃(Julier和Uhlmann，2001[16]；Bailey和Durra
nt-Whyte，2006[2]；Kottas等人，2013[18]；Wheeler等人，2018[38])。相比之下，相对导航方法仅估计车辆相对于最新里程计关
键帧定位的相对状态(Leishman等人，2014b[23])。因此，里程计提供了位置和航向状态的直接测量，使它们在结构上可被观测，从而确保一致和有界的状态估计
。每次声明一个新的关键帧时，当前状态和协方差估计都会传递给后端地图，后端地图将它们连接为位姿图中的边，以重建车辆的全局路径。然后将滤波器中的位置和航向状态重置为
零并继续估计。相关的导航架构如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:01"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示，与SLAM文献中的观点相类似(Chong和Kleeman，1999[12]；Kim等人，2010[17])。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig01.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:01"

\end_inset

通用相对导航系统结构框图。飞行临界估计和控制相对于一个局部坐标系进行。Wheeler等人(2020)[37]对该框架进行了更详细的描述。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
最近的模拟结果表明，使用相对导航框架来确保可观测性，在估计的相对和全局状态的一致性方面提供了显著的优势，并且在合并间歇性全局信息时，在精度和系统鲁棒性方面也有一
些改进(Wheeler等人，2018[38])。此外，最近的多旋翼硬件飞行试验结果已经证明了相对导航对于小型无人机长期GPS降级导航的有效性(Wheeler等人
，2020[37])。本文对Wheeler等人(2018)[38]和Wheeler等人(2020)[37]的工作进行了补充，提供了这些论文中使用的相对状态估计滤
波器的完整、自包含的教程推导，以获得硬件结果。虽然这些论文为相对导航方法提供了充分的理论和实践依据，但到目前为止，核心的相对估计器组件本身仅在文献中作了简要描述
。
\end_layout

\begin_layout Standard
本文旨在填补这一空白。Wheeler等人(2018)[38]和Wheeler等人(2020)[37]提出的飞行试验成功地利用了本文提出的相对乘性扩展Kalman
滤波器(relative multiplicative extended Kalman filter, RMEKF)。虽然这项工作证明了相对导航框架的有效性，并
对各个组成部分进行了概述，但它并没有详细描述RMEKF。RMEKF建立在乘性扩展Kalman滤波器(multiplicative extended
 Kalman filter, MEKF)的基础上，它使用四元数表示姿态，用四元数乘法来定义姿态误差。RMEKF扩展了MEKF，将UAS状态定义为相对于与当前关
键帧图像相关联的局部坐标帧。为了适应这种相对状态，RMEKF引入了一个额外的
\series bold
关键帧重置
\series default
(
\emph on
keyframe reset
\emph default
)步骤，该步骤在每次声明新关键帧时应用。
\end_layout

\begin_layout Standard
本文从三个方面对该文献做出了贡献。首先，本文提供了一个用于无人机系统状态估计的MEKF的教程推导，该推导给出了Hamilton四元数。其次，本文对多旋翼无人机的
RMEKF进行了完整推导，包括对Leishman和McLain(2014)[22]最初陈述的几个重要扩展。第三，本文对惯性和机体固连(机器人中心，robocen
tric)的状态表示的RMEKF进行了全面推导，强调了这两种方法之间存在的细微但重要的差异。以下段落将进一步详细描述这些贡献，并将它们与现有文献进行比较。
\end_layout

\begin_layout Paragraph
MEKF教程。
\end_layout

\begin_layout Standard
本文的重要部分都是教程性质的，清楚地说明了当用四元数表示姿态时，为什么需要一个间接或误差状态公式，并对推导滤波方程的每一步都提供了完整的解释。MEKF最早由Le
fferts等人(1982)[20]提出，并且MEKF实现的几个深入讨论和推导已经发表(Markley，2003[25]；Sola，2016[32]；Trawn
y和Roumeliotis，2005[34])。其中一些有价值的出版物的范围与当前的工作类似，但本文提供了几个有意义的扩展。首先，本文推导了无人机完全状态(位置
、速度、姿态、加速计偏差和陀螺仪偏差)的估计器，而之前类似范围的大多数MEKF论文只关注姿态和偏差的估计。Sola(2016)[32]确实推导出了一个完全的ME
KF状态，但本文为一组独特的传播和测量模型提供了推导。其次，本文使用Hamilton四元数约定推导MEKF，而不是在其它一些著作中使用JPL约定。虽然四元数约定
的选择并不能从根本上改变问题，但是Hamilton四元数在机器人学文献中被普遍使用，并且这就出现了微妙但重要的差异。本文提供了一个对比性视角，以帮助加深对四元数
的理解，并旨在澄清由于不同作品中使用的不同约定(这些约定并不总是明确定义)而可能产生的一些混淆。第三，本文的教程性质为推导与四元数、其四元数的误差表示和四元数的
欧拉角分解有关的几个新特性提供了足够的背景。这些特性在RMEKF的推导中起着关键作用，以允许部分姿态更新。
\end_layout

\begin_layout Paragraph
RMEKF推导。
\end_layout

\begin_layout Standard
本文的另一个目的是对Wheeler等人(2020)[37]成功使用的RMEKF估计器进行全面推导，该估计器用于GPS降级环境中的无人机长时间导航。本文介绍的RM
EKF以几个重要的方式扩展了Leishman和McLain(2014)[22]最初的RMEKF推导，这些方式已被证明是长时间飞行所必需的。首先，本文提出了一种新
的视觉里程测量模型，即激光扫描匹配测量模型和关键帧重置操作，它们一起确保了在GPS缺失的环境下，车辆的状态保持可观测。其次，推导了误差四元数的一些新性质，这些性
质使得四元数状态及其协方差能够部分更新。第三，本文在状态向量中添加了新的项，以正确解释在声明关键帧时车辆的横滚、俯仰和高度的不确定性。最后，更小的差异包括求逆里
程测量模型的方向，以避免不必要地将航向不确定性耦合到更新中，以及估计车辆距地全局高度，而不是将高度视为相对状态。
\end_layout

\begin_layout Paragraph
惯性和机体固连动力学。
\end_layout

\begin_layout Standard
本文的另一个独特贡献是，当状态是相对于惯性系或机体固连的机器人中心系来定义的时候，推导了RMEKF。传统上，车辆动力学表达为惯性固连、重力对齐的坐标系(参见Le
ishman等人(2014b)[23]以及Leishman和McLain(2014)[22])。这是合理的，尤其是当传感器是惯性传感器，如GPS。然而，当使用机
器人中心传感器时，例如照相机和激光测距仪，在机器人中心系中表达动力学通常更自然，而且当只需要相对状态时，可以帮助解决EKF-SLAM的一些不一致问题(Bloes
ch等人，2015[6]；Castellanos等人，2007[10])。本文的一个相关贡献是介绍了使用惯性参考系和机器人中心参考系之间的细微差异。这些差异可能
会导致目前尚不存在的并列比较的文献出现混乱。例如，除了动力学的变化外，四元数积分、误差状态定义、测量模型和关键帧重置操作中也会出现细微的变化。通过并排介绍这两个
公式，可以清楚地解释这些差异。
\end_layout

\begin_layout Standard
本文的最后贡献是对滤波器和所有相关四元数特性的完整、自包含的推导。四元数和误差状态的定义在当前的估计文献中有细微的不同。当这些定义没有被彻底记录下来时，就很难正
确利用来自多个来源的特性。由于本文的教程性质和一步一步的解释，本文旨在提出一个完整的，自包含的推导，相对于一个一致的，明确的定义。这使得读者能够理解、实现并可能
修改RMEKF，以用于新的车辆或应用程序。请注意，虽然关键帧重置步骤和几个测量模型特定于相对导航，但传播方程和一般滤波器结构同样适用于其它应用，例如GPS/惯性
导航系统(inertial navigation system, INS)导航。
\end_layout

\begin_layout Standard
第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节总结了整篇文章中使用的符号。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节概述了本文中使用的四元数定义。具体来说，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:3.8"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节推导了误差四元数的几个相关的新性质。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节概述了MEKF的结构。关键帧重置步骤在第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:5"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中描述，并且给出了完整RMEKF算法的概述。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:6"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节推导了惯性相对导航(inertial relative navigation, iRN)的具体滤波方程，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:7"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节推导了机体固连的机器人中心相对导航(robocentric relative navigation, bRN)的滤波方程。最后，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:8"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节和第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:9"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节分别给出了实验结果和结论。
\end_layout

\begin_layout Section
术语表
\begin_inset CommandInset label
LatexCommand label
name "sec:2"

\end_inset


\end_layout

\begin_layout Standard
下面的变量、算子和符号在本文中都有定义和动机，为了方便起见，在这里进行了总结。设
\begin_inset Formula $\mathcal{B}$
\end_inset

表示车辆机体坐标系，
\begin_inset Formula $\mathcal{I}$
\end_inset

表示惯性坐标系。
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="15" columns="2">
<features islongtable="true" longtabularalignment="left">
<column alignment="center" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
状态变量
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{x}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
状态
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{x}_{\mathbf{v}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
状态的向量分量
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{x}_{\mathbf{q}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
状态的四元数分量
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $^{c}\mathbf{p}_{a}^{b}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $b$
\end_inset

相对于
\begin_inset Formula $a$
\end_inset

的位置，用
\begin_inset Formula $c$
\end_inset

表示
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{p}_{a}^{b}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $b$
\end_inset

相对于
\begin_inset Formula $a$
\end_inset

的位置，用
\begin_inset Formula $a$
\end_inset

表示
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{q}_{a}^{b}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
从
\begin_inset Formula $a$
\end_inset

到
\begin_inset Formula $b$
\end_inset

旋转的四元数
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathcal{B}$
\end_inset

相对于
\begin_inset Formula $\mathscr{\mathcal{I}}$
\end_inset

的速度，用
\begin_inset Formula $\mathcal{B}\left(\mathbf{v}\triangleq{}^{\mathcal{B}}\mathbf{v}_{\mathcal{I}}^{\mathcal{B}}\right)$
\end_inset

表示
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathcal{B}$
\end_inset

相对于
\begin_inset Formula $\mathscr{\mathcal{I}}$
\end_inset

的角速度，用
\begin_inset Formula $\mathcal{B}\left(\boldsymbol{\omega}\triangleq{}^{\mathcal{B}}\boldsymbol{\omega}_{\mathcal{I}}^{\mathcal{B}}\right)$
\end_inset

表示
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{a}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathscr{\mathcal{B}}$
\end_inset

相对于
\begin_inset Formula $\mathscr{\mathcal{I}}$
\end_inset

的加速度，用
\begin_inset Formula $\mathcal{B}\left(\mathbf{a}\triangleq{}^{\mathcal{B}}\mathbf{a}_{\mathcal{I}}^{\mathcal{B}}\right)$
\end_inset

表示
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{\beta}_{\boldsymbol{\omega}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
速率陀螺偏差，用
\begin_inset Formula $\mathcal{B}$
\end_inset

表示
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{\beta}_{\mathbf{a}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
加速计偏压，用
\begin_inset Formula $\mathcal{B}$
\end_inset

表示
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
特定的线性阻力系数
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{\eta}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
零均值高斯过程噪声
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{\nu}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
零均值高斯输入噪声
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features islongtable="true" longtabularalignment="left">
<column alignment="center" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
误差状态变量
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\delta\mathbf{x}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
误差状态
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\delta\mathbf{x}_{\mathbf{v}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
误差状态的向量分量
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\delta\mathbf{x}_{\boldsymbol{\theta}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
误差状态的姿态分量
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\delta\mathbf{p}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
位置误差状态
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\delta\mathbf{q}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
四元数误差状态
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
姿态误差状态(最小表示)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="14" columns="2">
<features islongtable="true" longtabularalignment="left">
<column alignment="center" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
滤波器变量
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
输入
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{z}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
测量
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
测量残差
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
状态协方差矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{Q}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
过程噪声协方差矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
测量噪声协方差矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{S}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
残差协方差矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{K}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Kalman增益
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{F},\mathbf{G}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
传播Jacobian矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{H}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
测量Jacobian矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{N}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
关键帧重置Jacobian矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{N_{P}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
位置重置Jacobian矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{N}_{\boldsymbol{\theta}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
姿态重置Jacobian矩阵
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features islongtable="true" longtabularalignment="left">
<column alignment="center" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
算子
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\otimes$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
四元数乘法(Hamilton)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\lfloor \cdot\right\rfloor $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
斜对称矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\cdot\right)^{\wedge}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
从向量到四元数的映射
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\cdot\right)^{\vee}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
从四元数到向量的映射
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E\left[\cdot\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
期望值
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{R}\left[\mathbf{q}\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
与
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\mathbf{q}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
相关的旋转矩阵
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="2">
<features islongtable="true" longtabularalignment="left">
<column alignment="center" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
其它
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{\mathbf{y}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{y}$
\end_inset

的估计值(或期望值)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\tilde{\mathbf{y}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{y}$
\end_inset

的测量值
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\dot{\mathbf{y}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{y}$
\end_inset

的时间导数
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{y}^{+}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{y}$
\end_inset

的
\series bold
后验
\series default
(
\emph on
posteriori
\emph default
)值
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{k}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单位向量
\begin_inset Formula $\left[\begin{array}{lll}
0 & 0 & 1\end{array}\right]^{\top}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{I}_{a\times b}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
在
\begin_inset Formula $\mathbb{R}^{a\times b}$
\end_inset

中的单位矩阵
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{\Pi}_{\mathbf{k}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
投影矩阵
\begin_inset Formula $\mathbf{I}_{3\times3}-\mathbf{k}\mathbf{k}^{\top}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{g}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
重力向量
\begin_inset Formula $g\mathbf{k}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Section
四元数特性
\begin_inset CommandInset label
LatexCommand label
name "sec:3"

\end_inset


\end_layout

\begin_layout Standard
四元数是表示姿态的常用方法，因为与其它方法相比，四元数的计算效率和精度都有所提高(Casey等人，2013[9])。四元数及其相关操作存在各种定义，导致了细微的
差异和潜在的混淆。Sola(2016)[32]更详细地描述了各种方法，包括左手与右手四元数乘法、主动与被动表示、局部到全局与全局到局部姿态方向以及四元数排序。本
节明确地建立了本文中使用的定义和符号，并另外推导了滤波器推导所需的几个特性。本节不是对四元数的完整介绍，而是对相关要点的总结。
\end_layout

\begin_layout Subsection
四元数约定
\end_layout

\begin_layout Standard
四元数
\begin_inset Formula $\mathbf{q}\in\mathbb{H}$
\end_inset

是由标量和向量部分组成的秩为
\begin_inset Formula $4$
\end_inset

的超复数
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}=q_{0}+q_{x}i+q_{y}j+q_{z}k.
\]

\end_inset


\end_layout

\begin_layout Standard
我们使用Hamilton对四元数的定义，为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{rl}
ij=-ji & =k,\\
jk=-kj & =i,\\
ki=-ik & =j,\\
i^{2}=j^{2}=k^{2}=ijk & =-1.
\end{array}\label{eq:1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
为便于记述，我们将四元数的向量部分定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\bar{\mathbf{q}}=\left[\begin{array}{lll}
q_{x} & q_{y} & q_{z}\end{array}\right]^{\top},
\]

\end_inset


\end_layout

\begin_layout Standard
并将四元数写为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}=\left[\begin{array}{c}
\bar{\mathbf{q}}\\
q_{0}
\end{array}\right].\label{eq:2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
四元数乘法用
\begin_inset Formula $\otimes$
\end_inset

算子表示，并根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的规则和标准代数乘法进行。使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:2"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的符号，四元数乘法可以写成矩阵乘法，根据
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:3"

\end_inset


\begin_inset Formula 
\begin{align}
\mathbf{p}\otimes\mathbf{q} & =\left[\begin{array}{cc}
p_{0}\mathbf{I}+\left\lfloor \bar{\mathbf{p}}\right\rfloor  & \bar{\mathbf{p}}\\
-\bar{\mathbf{p}}^{\top} & p_{0}
\end{array}\right]\left[\begin{array}{c}
\bar{\mathbf{q}}\\
q_{0}
\end{array}\right],\label{eq:3a}\\
 & =\left[\begin{array}{cc}
q_{0}\mathbf{I}-\left\lfloor \bar{\mathbf{q}}\right\rfloor  & \bar{\mathbf{q}}\\
-\bar{\mathbf{q}}^{\top} & q_{0}
\end{array}\right]\left[\begin{array}{c}
\bar{\mathbf{p}}\\
p_{0}
\end{array}\right],\label{eq:3b}
\end{align}

\end_inset


\end_layout

\end_inset

其中算子
\begin_inset Formula $\left\lfloor \cdot\right\rfloor $
\end_inset

是斜对称算子
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left\lfloor \mathbf{a}\right\rfloor =\left[\begin{array}{ccc}
0 & -a_{z} & a_{y}\\
a_{z} & 0 & -a_{x}\\
-a_{y} & a_{x} & 0
\end{array}\right]
\]

\end_inset

所以，
\begin_inset Formula $\mathbf{a}\times\mathbf{b}=\left\lfloor \mathbf{a}\right\rfloor \mathbf{b}$
\end_inset

。斜对称算子的特性是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\lfloor \mathbf{a}\right\rfloor \mathbf{b}=-\left\lfloor \mathbf{b}\right\rfloor \mathbf{a}.\label{eq:4}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
四元数
\begin_inset Formula $\mathbf{q}$
\end_inset

的共轭值用
\begin_inset Formula $\mathbf{q}^{*}$
\end_inset

表示，它等于
\begin_inset Formula $\mathbf{q}$
\end_inset

，但向量部分的元素取反。四元数的逆值由下式给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}^{-1}=\dfrac{\mathbf{q}^{*}}{\left\Vert \mathbf{q}\right\Vert }.
\]

\end_inset


\end_layout

\begin_layout Standard
本文中使用的四元数都表示旋转，也就是
\series bold
单位四元数
\series default
(
\emph on
unit quaternions
\emph default
)，这意味着它们的范数是
\begin_inset Formula $1$
\end_inset

。 因此，对于单位四元数，我们有
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{-1}=\mathbf{q}^{*}=\left[\begin{array}{c}
-\bar{\mathbf{q}}\\
q_{0}
\end{array}\right].\label{eq:5}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
将两个四元数的乘积求逆，则与每个四元数的其逆的乘积的顺序相反，如下所示：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left(\mathbf{p}\otimes\mathbf{q}\right)^{-1}=\mathbf{q}^{-1}\otimes\mathbf{p}^{-1}.
\]

\end_inset


\end_layout

\begin_layout Subsection
向量旋转
\begin_inset CommandInset label
LatexCommand label
name "subsec:3.2"

\end_inset


\end_layout

\begin_layout Standard
在本文中，四元数是被动表示的，这意味着它们表示了在不同坐标系中表示向量所需的旋转。让四元数
\begin_inset Formula $\mathbf{q}_{a}^{b}$
\end_inset

表示从帧
\begin_inset Formula $a$
\end_inset

到帧
\begin_inset Formula $b$
\end_inset

的旋转，让
\begin_inset Formula $^{a}\mathbf{y}$
\end_inset

表示在帧
\begin_inset Formula $a$
\end_inset

中表示的向量。正如Kuipers(1999)[19]所描述的，
\begin_inset Formula $^{a}\mathbf{y}$
\end_inset

可以用四元数共轭操作表示在
\begin_inset Formula $b$
\end_inset

帧中的向量
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
^{b}\mathbf{y}\\
0
\end{array}\right]=\left(\mathbf{q}_{a}^{b}\right)^{-1}\otimes\left[\begin{array}{c}
^{a}\mathbf{y}\\
0
\end{array}\right]\otimes\mathbf{q}_{a}^{b}.\label{eq:6}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
项
\begin_inset Formula $\left[\begin{array}{ll}
^{a}\mathbf{y}^{\top} & 0\end{array}\right]^{\top}$
\end_inset

被称为由
\begin_inset Formula $^{a}\mathbf{y}$
\end_inset

构造的
\series bold
纯虚四元数
\series default
(
\emph on
pure quaternion
\emph default
)。
\end_layout

\begin_layout Standard
定义一个等价的旋转矩阵
\begin_inset Formula $\mathbf{R}\left(\mathbf{q}\right)$
\end_inset

是很方便的，如
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
\mathbf{R}\left(\mathbf{q}\right)\mathbf{y}\\
0
\end{array}\right]=\mathbf{q}^{-1}\otimes\left[\begin{array}{l}
\mathbf{y}\\
0
\end{array}\right]\otimes\mathbf{q}.\label{eq:7}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
对于
\begin_inset Formula $\mathbf{R}\left(\mathbf{q}\right)$
\end_inset

的表达式可以根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:5"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:3a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:3b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:7"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的右手侧推导出来，如下所示：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\left[\begin{array}{c}
\mathbf{R}\left(\mathbf{q}\right)\mathbf{y}\\
0
\end{array}\right] & =\left[\begin{array}{cc}
q_{0}\mathbf{I}-\left\lfloor \bar{\mathbf{q}}\right\rfloor  & -\bar{\mathbf{q}}\\
\bar{\mathbf{q}}^{\top} & q_{0}
\end{array}\right]\left[\begin{array}{l}
\mathbf{y}\\
0
\end{array}\right]\otimes\mathbf{q}\\
 & =\left[\begin{array}{c}
q_{0}\mathbf{y}-\left\lfloor \bar{\mathbf{q}}\right\rfloor \mathbf{y}\\
\bar{\mathbf{q}}^{\top}\mathbf{y}
\end{array}\right]\otimes\mathbf{q}\\
 & =\left[\begin{array}{cc}
q_{0}\mathbf{I}-\left\lfloor \bar{\mathbf{q}}\right\rfloor  & \bar{\mathbf{q}}\\
-\bar{\mathbf{q}}^{\top} & q_{0}
\end{array}\right]\left[\begin{array}{c}
q_{0}\mathbf{y}-\left\lfloor \bar{\mathbf{q}}\right\rfloor \mathbf{y}\\
\bar{\mathbf{q}}^{\top}\mathbf{y}
\end{array}\right]\\
 & =\left[\begin{array}{c}
\left(q_{0}^{2}\mathbf{I}-2q_{0}\left\lfloor \bar{\mathbf{q}}\right\rfloor +\bar{\mathbf{q}}\bar{\mathbf{q}}^{\boldsymbol{\top}}+\left\lfloor \bar{\mathbf{q}}\right\rfloor ^{2}\right)\mathbf{y}\\
0
\end{array}\right],
\end{aligned}
\label{eq:8}
\end{equation}

\end_inset

这意味着
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{R}\left(\mathbf{q}\right)=q_{0}^{2}\mathbf{I}-2q_{0}\left\lfloor \bar{\mathbf{q}}\right\rfloor +\bar{\mathbf{q}}\bar{\mathbf{q}}^{\top}+\left\lfloor \bar{\mathbf{q}}\right\rfloor ^{2}.
\]

\end_inset


\end_layout

\begin_layout Standard
然而，可以证明
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left\lfloor \bar{\mathbf{q}}\right\rfloor ^{2}=\bar{\mathbf{q}}\bar{\mathbf{q}}^{\top}-\left(1-q_{0}^{2}\right)\mathbf{I},
\]

\end_inset

所以
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{R}\left(\mathbf{q}\right)=\left(2q_{0}^{2}-1\right)\mathbf{I}-2q_{0}\left\lfloor \bar{\mathbf{q}}\right\rfloor +2\bar{\mathbf{q}}\bar{\mathbf{q}}^{\top}.\label{eq:9}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
旋转矩阵具有以下特性：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{R}^{-1}\left(\mathbf{q}_{a}^{b}\right) & =\mathbf{R}^{\top}\left(\mathbf{q}_{a}^{b}\right)=\mathbf{R}\left(\mathbf{q}_{b}^{a}\right)\\
\mathbf{R}\left(\mathbf{q}_{a}^{c}\right) & =\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\mathbf{q}_{a}^{b}\right)\\
\det\left(\mathbf{R}\left(\mathbf{q}\right)\right) & =1.
\end{aligned}
\label{eq:10}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:6"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的向量旋转公式可以用来推导出两个旋转的组合方式。如果
\begin_inset Formula $\mathbf{q}_{a}^{b}$
\end_inset

定义了从帧
\begin_inset Formula $a$
\end_inset

到帧
\begin_inset Formula $b$
\end_inset

的旋转，
\begin_inset Formula $\mathbf{q}_{b}^{c}$
\end_inset

定义了从帧
\begin_inset Formula $b$
\end_inset

到帧
\begin_inset Formula $c$
\end_inset

的旋转，那么要把一个在帧
\begin_inset Formula $a$
\end_inset

中表示的向量在帧
\begin_inset Formula $c$
\end_inset

中表示，我们有
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\left[\begin{array}{c}
^{c}\mathbf{y}\\
0
\end{array}\right] & =\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left[\begin{array}{c}
^{b}\mathbf{y}\\
0
\end{array}\right]\otimes\mathbf{q}_{b}^{c}\\
 & =\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\left(\mathbf{q}_{a}^{b}\right)^{-1}\otimes\left[\begin{array}{c}
^{a}\mathbf{y}\\
0
\end{array}\right]\otimes\mathbf{q}_{a}^{b}\right)\otimes\mathbf{q}_{b}^{c}\\
 & =\left(\mathbf{q}_{a}^{b}\otimes\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left[\begin{array}{c}
^{a}\mathbf{y}\\
0
\end{array}\right]\otimes\left(\mathbf{q}_{a}^{b}\otimes\mathbf{q}_{b}^{c}\right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
因此，我们的结论是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}_{a}^{c}=\mathbf{q}_{a}^{b}\otimes\mathbf{q}_{b}^{c}.\label{eq:11}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
比较方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:10"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:11"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们看到旋转矩阵和四元数的组合顺序相反。
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{R}\left(\mathbf{q}_{a}^{b}\otimes\mathbf{q}_{b}^{c}\right)=\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\mathbf{q}_{a}^{b}\right).\label{eq:12}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
当四元数共轭操作应用于不是纯虚四元数的四元数时，可以重复方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:8"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的分析过程以显示
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{-1}\otimes\mathbf{p}\otimes\mathbf{q}=\left[\begin{array}{c}
\mathbf{R}\left(\mathbf{q}\right)\bar{\mathbf{p}}\\
p_{0}
\end{array}\right]\label{eq:13}
\end{equation}

\end_inset

对于由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:9"
plural "false"
caps "false"
noprefix "false"

\end_inset

)定义的相同旋转矩阵
\begin_inset Formula $\mathbf{R}\left(\mathbf{q}\right)$
\end_inset

。该操作的结果是
\begin_inset Formula $\mathbf{p}$
\end_inset

的向量部分的基被
\begin_inset Formula $\mathbf{q}$
\end_inset

定义的旋转矩阵所旋转。当根据四元数的轴角表示来解释四元数时，此属性非常有用，并且需要在不同的坐标系中表示轴向量。这出现在本文中的一些测量模型和Jacobian矩
阵的推导中。
\end_layout

\begin_layout Subsection
单位球面传播
\end_layout

\begin_layout Standard
姿态用单位长度的四元数表示。单位四元数并不构成一个向量空间，而是在单位球面
\begin_inset Formula $S^{3}\subset\mathbb{H}$
\end_inset

上形成一个群。群算子是四元数乘法，单位四元数群给出了旋转群
\begin_inset Formula $SO(3)$
\end_inset

的双倍覆盖参数化。
\end_layout

\begin_layout Standard
将单位四元数乘以非单位四元数将使乘积四元数离开单位球面。将产生的四元数归一化，根据
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}\leftarrow\dfrac{\mathbf{q}}{\left\Vert \mathbf{q}\right\Vert }
\]

\end_inset

将使乘积四元数返回到单位球面，但会引入线性化误差。
\end_layout

\begin_layout Standard
要沿着流形正确地旋转一个四元数，必须用一个单位四元数来表示该旋转。旋转可以用单位四元数表示为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}=\left[\begin{array}{c}
\hat{\mathbf{e}}\sin\dfrac{\theta}{2}\\
\cos\dfrac{\theta}{2}
\end{array}\right],\label{eq:14}
\end{equation}

\end_inset

其中，
\begin_inset Formula $\hat{\mathbf{e}}$
\end_inset

是定义旋转轴的单位向量，
\begin_inset Formula $\theta$
\end_inset

是绕该轴旋转的角度。令
\begin_inset Formula $\boldsymbol{\theta}\triangleq\theta\hat{\mathbf{e}}\in\mathbb{R}^{3}$
\end_inset

定义旋转的大小和方向。从这个
\begin_inset Formula $3$
\end_inset

参数向量旋转参数化到四元数的映射用算子
\begin_inset Formula $^{\wedge}:\mathbb{R}^{3}\rightarrow\mathbb{H}$
\end_inset

表示，逆映射用算子
\begin_inset Formula $^{\vee}:\mathbb{H}\rightarrow\mathbb{R}^{3}$
\end_inset

表示。这个
\begin_inset Formula $^{\wedge}$
\end_inset

算子用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:14"
plural "false"
caps "false"
noprefix "false"

\end_inset

)定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\theta}^{\wedge}\triangleq\left[\begin{array}{c}
\dfrac{\boldsymbol{\theta}}{\left\Vert \boldsymbol{\theta}\right\Vert }\sin\dfrac{\left\Vert \boldsymbol{\theta}\right\Vert }{2}\\
\cos\dfrac{\left\Vert \boldsymbol{\theta}\right\Vert }{2}
\end{array}\right].\label{eq:15}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
将一个四元数
\begin_inset Formula $\mathbf{q}$
\end_inset

沿单位球面旋转
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

即为
\begin_inset Formula $\mathbf{q}\otimes\boldsymbol{\theta}^{\wedge}$
\end_inset

。这类似于符号
\begin_inset Formula $\mathbf{q}\boxplus\boldsymbol{\theta}$
\end_inset

和
\begin_inset Formula $\mathbf{q}\otimes\exp\left(\dfrac{\theta}{2}\right)$
\end_inset

，参见估计文献(Hertzberg等人，2013[14])。这个
\begin_inset Formula $^{\vee}$
\end_inset

算子定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{\vee}\triangleq2\mathrm{atan2}\left(\left\Vert \bar{\mathbf{q}}\right\Vert ,q_{0}\right)\dfrac{\bar{\mathbf{q}}}{\left\Vert \bar{\mathbf{q}}\right\Vert }.\label{eq:16}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
提取
\begin_inset Formula $\mathbf{q}_{a}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{b}$
\end_inset

之间的基本旋转是通过
\begin_inset Formula $\left(\mathbf{q}_{a}\otimes\left(\mathbf{q}_{b}\right)^{-1}\right)^{\vee}$
\end_inset

完成的。这类似于符号
\begin_inset Formula $\log\left(\mathbf{q}_{a}\boxminus\mathbf{q}_{b}\right)$
\end_inset

，参见估计文献(Hertzberg等人，2013[14])。做为逆映射，可以证明
\begin_inset Formula $\boldsymbol{\theta}=\left(\boldsymbol{\theta}^{\wedge}\right)^{\vee}$
\end_inset

和
\begin_inset Formula $\mathbf{q}=\left(\mathbf{q}^{\vee}\right)^{\wedge}$
\end_inset

。
\end_layout

\begin_layout Standard
当
\begin_inset Formula $\left\Vert \boldsymbol{\theta}\right\Vert $
\end_inset

等于零时，方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:15"
plural "false"
caps "false"
noprefix "false"

\end_inset

)是未定义的，并且在实践中，当
\begin_inset Formula $\left\Vert \boldsymbol{\theta}\right\Vert $
\end_inset

接近零时，该方程在数值上变得不稳定。对于小角度
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

，有一些常见的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:15"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的近似，例如二阶Gibbs向量参数化(Markley，2003[25])
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\theta}^{\wedge}\approx\dfrac{1}{\sqrt{4+\delta\boldsymbol{\theta}^{\top}\delta\boldsymbol{\theta}}}\left[\begin{array}{c}
\delta\boldsymbol{\theta}\\
2
\end{array}\right].\label{eq:17}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:15"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:17"
plural "false"
caps "false"
noprefix "false"

\end_inset

)两者的一阶近似为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\theta}^{\wedge}\approx\left[\begin{array}{c}
\dfrac{1}{2}\delta\boldsymbol{\theta}\\
1
\end{array}\right],\label{eq:18}
\end{equation}

\end_inset

这在推导一阶Jacobian矩阵时很有用。方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:16"
plural "false"
caps "false"
noprefix "false"

\end_inset

)对于小的四元数
\begin_inset Formula $\delta\mathbf{q}$
\end_inset

同样可以近似为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\mathbf{q}^{\vee}\approx2\mathrm{sign}\left(\delta q_{0}\right)\delta\bar{\mathbf{q}}.\label{eq:19}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
时间积分
\begin_inset CommandInset label
LatexCommand label
name "subsec:3.4"

\end_inset


\end_layout

\begin_layout Standard
可以使用几种方法对表示刚体姿态的四元数进行数值积分。数值积分是在一个有限的时间步长
\begin_inset Formula $\Delta t$
\end_inset

上进行的，并受机体相对于惯性坐标系的角速度所支配，在机体坐标系中表示为
\begin_inset Formula $\boldsymbol{\omega}\triangleq{}^{\mathcal{B}}\boldsymbol{\omega}_{\mathcal{I}}^{\mathcal{B}}$
\end_inset

。设
\begin_inset Formula $\mathbf{q}_{\Delta t}$
\end_inset

为增量四元数，
\begin_inset Formula $\boldsymbol{\omega}_{0}$
\end_inset

为标称角速度。零阶四元数积分假设角速度在时间步长上是恒定的，
\begin_inset Formula $\boldsymbol{\omega}_{0}=\boldsymbol{\omega}_{t}$
\end_inset

，而一阶积分使用线性插值，
\begin_inset Formula $\boldsymbol{\omega}_{0}=\dfrac{1}{2}\left(\boldsymbol{\omega}_{t}+\boldsymbol{\omega}_{t-1}\right)$
\end_inset

。从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:15"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中，我们把
\begin_inset Formula $\mathbf{q}_{\Delta t}$
\end_inset

写成
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{q}_{\Delta t} & =\left(\boldsymbol{\omega}_{0}\Delta t\right)^{\wedge}\nonumber \\
 & =\left[\begin{array}{c}
\dfrac{\boldsymbol{\omega}_{0}}{\left\Vert \boldsymbol{\omega}_{0}\right\Vert }\sin\left(\dfrac{\left\Vert \boldsymbol{\omega}_{0}\right\Vert \Delta t}{2}\right)\\
\cos\left(\dfrac{\left\Vert \boldsymbol{\omega}_{0}\right\Vert \Delta t}{2}\right)
\end{array}\right].\label{eq:20}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
时间
\begin_inset Formula $t+\Delta t$
\end_inset

的四元数
\begin_inset Formula $\mathbf{q}_{t+\Delta t}$
\end_inset

的值可以表示为时间
\begin_inset Formula $t$
\end_inset

的四元数
\begin_inset Formula $\mathbf{q}_{t}$
\end_inset

和增量四元数
\begin_inset Formula $\mathbf{q}_{\Delta t}$
\end_inset

的组合。这些四元数的组合方式取决于姿态四元数是表示机体相对于惯性系(iRN)的姿态，还是表示惯性系相对于机体(bRN)的姿态。如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:02"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示，在这些情况下，时间
\begin_inset Formula $t+\Delta t$
\end_inset

的姿态为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathrm{iRN:} & \mathbf{q}_{t+\Delta t}=\mathbf{q}_{t}\otimes\mathbf{q}_{\Delta t},\\
\mathrm{bRN:} & \mathbf{q}_{t+\Delta t}=\left(\mathbf{q}_{\Delta t}\right)^{-1}\otimes\mathbf{q}_{t},
\end{aligned}
\label{eq:21}
\end{equation}

\end_inset

其中，组合的阶遵循方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:11"
plural "false"
caps "false"
noprefix "false"

\end_inset

)。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig02.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:02"

\end_inset

四元数定义用于推导四元数的时间导数和积分。iRN和bRN使用相同的
\begin_inset Formula $\mathbf{q}_{\Delta t}$
\end_inset

，因为它对应于速率陀螺仪测量得的机体固连角速度
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:20"
plural "false"
caps "false"
noprefix "false"

\end_inset

)代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:21"
plural "false"
caps "false"
noprefix "false"

\end_inset

)得到
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:22"

\end_inset


\begin_inset Formula 
\begin{align}
\mathrm{iRN:}\ \mathbf{q}_{t+\Delta t} & =\mathbf{q}_{t}\otimes\left[\begin{array}{c}
\dfrac{\boldsymbol{\omega}_{0}}{\left\Vert \boldsymbol{\omega}_{0}\right\Vert }\sin\left(\dfrac{\left\Vert \boldsymbol{\omega}_{0}\right\Vert \Delta t}{2}\right)\\
\cos\left(\dfrac{\left\Vert \boldsymbol{\omega}_{0}\right\Vert \Delta t}{2}\right)
\end{array}\right],\label{eq:22a}\\
\mathrm{bRN:}\ \mathbf{q}_{t+\Delta t} & =\left[\begin{array}{c}
-\dfrac{\boldsymbol{\omega}_{0}}{\left\Vert \boldsymbol{\omega}_{0}\right\Vert }\sin\left(\dfrac{\left\Vert \boldsymbol{\omega}_{0}\right\Vert \Delta t}{2}\right)\\
\cos\left(\dfrac{\left\Vert \boldsymbol{\omega}_{0}\right\Vert \Delta t}{2}\right)
\end{array}\right]\otimes\mathbf{q}_{t}.\label{eq:22b}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:22"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的积分保持单位范数，允许姿态在单位球面
\begin_inset Formula $S^{3}\subset\mathbb{H}$
\end_inset

上传播。然而，在实践中，当
\begin_inset Formula $\left\Vert \boldsymbol{\omega}_{0}\right\Vert $
\end_inset

接近零时，这个定义在数值上变得不稳定。如Trawny和Roumeliotis(2005)[34]所述，将L'Hospital规则应用于iRN的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:22a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)表明
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\lim_{\left\Vert \boldsymbol{\omega}_{0}\right\Vert \rightarrow0}\mathbf{q}_{t+\Delta t}=\mathbf{q}_{t}+\Delta t\left(\dfrac{1}{2}\boldsymbol{\Omega}\left(\boldsymbol{\omega}_{0}\right)\mathbf{q}_{t}\right),\label{eq:23}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Omega}\left(\boldsymbol{\omega}\right)=\left[\begin{array}{cc}
-\left\lfloor \boldsymbol{\omega}\right\rfloor  & \boldsymbol{\omega}\\
-\boldsymbol{\omega}^{\top} & 0
\end{array}\right].\label{eq:24}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
比较方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:24"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:3b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，表明方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:23"
plural "false"
caps "false"
noprefix "false"

\end_inset

)可以写成
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}_{t+\Delta t}=\mathbf{q}_{t}+\Delta t\left(\dfrac{1}{2}\mathbf{q}_{t}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}_{0}\\
0
\end{array}\right]\right).
\]

\end_inset


\end_layout

\begin_layout Standard
对于bRN，类似的分析可应用于方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:22b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)以表明
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}_{t+\Delta t}\approx\mathbf{q}_{t}+\Delta t\left(\dfrac{1}{2}\left[\begin{array}{c}
-\boldsymbol{\omega}_{0}\\
0
\end{array}\right]\otimes\mathbf{q}_{t}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
注意，对于bRN，四元数乘法的顺序和
\begin_inset Formula $\boldsymbol{\omega}_{0}$
\end_inset

的符号都被颠倒了。
\end_layout

\begin_layout Standard
总之，当
\begin_inset Formula $\left\Vert \boldsymbol{\omega}_{0}\right\Vert $
\end_inset

足够大时，姿态四元数才根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:22"
plural "false"
caps "false"
noprefix "false"

\end_inset

)进行积分，以避免数值问题。当
\begin_inset Formula $\left\Vert \boldsymbol{\omega}_{0}\right\Vert $
\end_inset

为小值时，积分近似为
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:25"

\end_inset


\begin_inset Formula 
\begin{align}
\mathrm{iRN:}\ \mathbf{q}_{t+\Delta t} & =\mathbf{q}_{t}+\Delta t\left(\dfrac{1}{2}\mathbf{q}_{t}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}_{0}\\
0
\end{array}\right]\right),\label{eq:25a}\\
\mathrm{bRN:}\ \mathbf{q}_{t+\Delta t} & =\mathbf{q}_{t}+\Delta t\left(\dfrac{1}{2}\left[\begin{array}{c}
-\boldsymbol{\omega}_{0}\\
0
\end{array}\right]\otimes\mathbf{q}_{t}\right).\label{eq:25b}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:25"
plural "false"
caps "false"
noprefix "false"

\end_inset

)积分使得四元数离开单位球面
\begin_inset Formula $S^{3}$
\end_inset

；因此，当使用此方法时，跟有一个归一化的步骤。
\end_layout

\begin_layout Subsection
姿态运动学
\end_layout

\begin_layout Standard
刚体的姿态运动学由姿态四元数的时间导数描述。一些作者(Bloesch等人，2016[7]；Hertzberg等人，2013[14])通过将
\begin_inset Formula $\dot{\mathbf{q}}\in\mathbb{R}^{3}$
\end_inset

定义为相关李代数的成员来强调姿态动力学的流形结构，而其他作者(Markley，2003[25]；Trawny和Roumeliotis，2005[34])则假设一
阶近似，如
\begin_inset Formula $\dot{\mathbf{q}}\in\mathbb{R}^{4}$
\end_inset

。在本文中，当我们使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:22"
plural "false"
caps "false"
noprefix "false"

\end_inset

)沿流形
\begin_inset Formula $S^{3}$
\end_inset

传播时，我们使用四元数动力学在有限时间步长
\begin_inset Formula $\Delta t$
\end_inset

上的一阶近似，以计算扩展Kalman滤波器(extended Kalman filter, EKF)所需的一阶Jacobian矩阵。
\end_layout

\begin_layout Standard
方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:22"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的一阶泰勒级数近似，假设
\begin_inset Formula $\dfrac{1}{2}\left\Vert \boldsymbol{\omega}_{0}\right\Vert \Delta t$
\end_inset

很小
\begin_inset Foot
status open

\begin_layout Plain Layout
即使对于大的
\begin_inset Formula $\left\Vert \boldsymbol{\omega}\right\Vert =2\pi\ \mathrm{rad}/\mathrm{s}$
\end_inset

和中等的
\begin_inset Formula $\Delta t=0.01\ \mathrm{s}$
\end_inset

，通过线性化积分引入的误差也只有
\begin_inset Formula $10^{-6}\ \mathrm{rad}$
\end_inset

的数量级。
\end_layout

\end_inset

，得到的结果与方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:25"
plural "false"
caps "false"
noprefix "false"

\end_inset

)相同。使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:25a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，iRN的四元数时间导数计算为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{q}} & =\lim_{\Delta t\rightarrow0}\dfrac{1}{\Delta t}\left(\mathbf{q}_{t+\Delta t}-\mathbf{q}_{t}\right)\\
\dot{\mathbf{q}} & =\lim_{\Delta t\rightarrow0}\dfrac{1}{\Delta t}\left(\mathbf{q}_{t}+\Delta t\left(\dfrac{1}{2}\mathbf{q}_{t}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}_{0}\\
0
\end{array}\right]\right)-\mathbf{q}_{t}\right)\\
 & =\dfrac{1}{2}\mathbf{q}_{t}\otimes\left[\begin{array}{l}
\boldsymbol{\omega}\\
0
\end{array}\right].
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:25b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)对bRN进行类似的分析。总之，姿态四元数运动学由下式表示
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathrm{iRN:}\ \dot{\mathbf{q}} & =\dfrac{1}{2}\mathbf{q}\otimes\left[\begin{array}{l}
\boldsymbol{\omega}\\
0
\end{array}\right],\label{eq:26}\\
\mathrm{bRN:}\ \dot{\mathbf{q}} & =\dfrac{1}{2}\left[\begin{array}{c}
-\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\mathbf{q}.\label{eq:27}
\end{align}

\end_inset


\end_layout

\begin_layout Subsection
误差状态
\begin_inset CommandInset label
LatexCommand label
name "subsec:3.6"

\end_inset


\end_layout

\begin_layout Standard
因为单位四元数不构成向量空间，所以四元数误差不能用向量减法计算。相反，真实的四元数状态
\begin_inset Formula $\mathbf{q}$
\end_inset

表示为估计的四元数
\begin_inset Formula $\hat{\mathbf{q}}$
\end_inset

和四元数姿态误差
\begin_inset Formula $\delta\mathbf{q}$
\end_inset

的四元数乘法。通过改变四元数乘法的顺序和方向，有四种可能的方法来定义姿态误差：
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
\mathrm{Method1:}\ \mathbf{q} & \triangleq\hat{\mathbf{q}}\otimes\delta\mathbf{q},\label{eq:28a}\\
\mathrm{Method2:}\ \mathbf{q} & \triangleq\delta\mathbf{q}\otimes\hat{\mathbf{q}},\label{eq:28b}\\
\mathrm{Method3:}\ \mathbf{q} & \triangleq\hat{\mathbf{q}}\otimes\delta\mathbf{q}^{-1},\nonumber \\
\mathrm{Method4:}\ \mathbf{q} & \triangleq\delta\mathbf{q}^{-1}\otimes\hat{\mathbf{q}}.\nonumber 
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
在本文中，我们使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:28a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)表示第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:6"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中描述的iRN，使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:28b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)表示第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:7"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中描述的bRN：
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:29"

\end_inset


\begin_inset Formula 
\begin{align}
\mathrm{iRN:}\ \mathbf{q} & \triangleq\hat{\mathbf{q}}\otimes\delta\mathbf{q},\label{eq:29a}\\
\mathrm{bRN:}\ \mathbf{q} & \triangleq\delta\mathbf{q}\otimes\hat{\mathbf{q}}.\label{eq:29b}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
虽然使用不同的定义在推导滤波器时需要额外的小心，但最终这可以使iRN和bRN的动力学、测量模型和关键帧重置步骤之间的差异最小。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:03"
plural "false"
caps "false"
noprefix "false"

\end_inset

 说明了误差状态定义的选择，并显示了这种选择如何使两种方法保持相同的中间标称机体坐标系
\begin_inset Formula $\hat{b}$
\end_inset

。重新排列方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，四元数的误差状态定义为
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:30"

\end_inset


\begin_inset Formula 
\begin{align}
\mathrm{iRN:}\ \delta\mathbf{q} & =\hat{\mathbf{q}}^{-1}\otimes\mathbf{q},\label{eq:30a}\\
\mathrm{bRN:}\ \delta\mathbf{q} & =\mathbf{q}\otimes\hat{\mathbf{q}}^{-1}.\label{eq:30b}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig03.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:03"

\end_inset

iRN和bRN的误差状态定义。为了保持相同的中间标称机体坐标系，并因此具有类似的误差动力学，对误差状态定义进行了不同的定义。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:12"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们可以将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29"
plural "false"
caps "false"
noprefix "false"

\end_inset

)表示为
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
\mathrm{iRN:}\mathbf{R}\left(\mathbf{q}\right) & =\mathbf{R}\left(\delta\mathbf{q}\right)\mathbf{R}\left(\hat{\mathbf{q}}\right),\label{eq:31a}\\
\mathrm{bRN:}\mathbf{R}\left(\mathbf{q}\right) & =\mathbf{R}\left(\hat{\mathbf{q}}\right)\mathbf{R}\left(\delta\mathbf{q}\right).\label{eq:31b}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
当表示与四元数误差相关的姿态不确定性时，需要一个最小的表示。一个四元数用
\begin_inset Formula $4$
\end_inset

个数字参数化，但完全参数化方向只需要
\begin_inset Formula $3$
\end_inset

个数字，因为方向与单位四元数(三维群
\begin_inset Formula $S^{3}$
\end_inset

的元素)相关。因为群是三维的，所以幺元处的切空间，或者说李代数，将同构于
\begin_inset Formula $\mathbb{R}^{3}$
\end_inset

，并且误差协方差可以在这个三维向量空间中定义。因此，我们将
\begin_inset Formula $\delta\mathbf{q}$
\end_inset

中的不确定性表示为向量
\begin_inset Formula $\delta\boldsymbol{\theta}\in\mathbb{R}^{3}$
\end_inset

的协方差。方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:18"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:19"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的
\begin_inset Formula $^{\wedge}$
\end_inset

以及
\begin_inset Formula $^{\vee}$
\end_inset

算子将误差四元数
\begin_inset Formula $\delta\mathbf{q}$
\end_inset

与其最小表示
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

之间的映射定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\boldsymbol{\theta}=\delta\mathbf{q}^{\vee} & \approx2\mathrm{sign}\left(q_{0}\right)\bar{\mathbf{q}},\nonumber \\
\delta\mathbf{q}=\delta\boldsymbol{\theta}^{\wedge} & \approx\left[\begin{array}{c}
\dfrac{1}{2}\delta\boldsymbol{\theta}\\
1
\end{array}\right].\label{eq:32}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
通过将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:32"
plural "false"
caps "false"
noprefix "false"

\end_inset

)代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:9"
plural "false"
caps "false"
noprefix "false"

\end_inset

)并忽略二阶项，可以得出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{R}\left(\delta\mathbf{q}\right)\approx\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}\right\rfloor \label{eq:33}
\end{equation}

\end_inset

并且
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{R}\left(\delta\mathbf{q}^{-1}\right)=\mathbf{R}^{\top}\left(\delta\mathbf{q}\right)\approx\mathbf{I}+\left\lfloor \delta\boldsymbol{\theta}\right\rfloor .\label{eq:34}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
欧拉角分解
\end_layout

\begin_layout Standard
飞机姿态通常用三个角来表示：横滚角
\begin_inset Formula $\phi$
\end_inset

、俯仰角
\begin_inset Formula $\theta$
\end_inset

和偏航角
\begin_inset Formula $\psi$
\end_inset

。偏航角表示绕惯性
\begin_inset Formula $z$
\end_inset

轴(向下)的旋转。俯仰角表示围绕生成的
\begin_inset Formula $y$
\end_inset

轴旋转。横滚角表示在俯仰和偏航后形成的绕
\begin_inset Formula $x$
\end_inset

轴的旋转。这一系列旋转称为
\begin_inset Formula $3–2–1$
\end_inset

欧拉角，将车辆的机体坐标系与惯性坐标系联系起来，可以表示为三个旋转矩阵的乘积
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{R}\left(\mathbf{q}\right)=\mathbf{R}_{\phi}\mathbf{R}_{\theta}\mathbf{R}_{\psi},\label{eq:35}
\end{equation}

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{R}_{\phi} & \triangleq\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & \cos\phi & \sin\phi\\
0 & -\sin\phi & \cos\phi
\end{array}\right],\\
\mathbf{R}_{\theta} & \triangleq\left[\begin{array}{ccc}
\cos\theta & 0 & -\sin\theta\\
0 & 1 & 0\\
\sin\theta & 0 & \cos\theta
\end{array}\right],\\
\mathbf{R}_{\psi} & \triangleq\left[\begin{array}{ccc}
\cos\psi & \sin\psi & 0\\
-\sin\psi & \cos\psi & 0\\
0 & 0 & 1
\end{array}\right].
\end{aligned}
\label{eq:36}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
因为四元数通常不太直观，所以它们通常被映射到横滚角、俯仰角和偏航角，以便进行绘图、分析和控制。用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:9"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:35"
plural "false"
caps "false"
noprefix "false"

\end_inset

)并进行项的比较，我们得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\phi & =\mathrm{atan}\left(\dfrac{2q_{0}q_{x}+2q_{y}q_{z}}{q_{z}^{2}-q_{x}^{2}-q_{y}^{2}+q_{0}^{2}}\right),\\
\theta & =\mathrm{asin}\left(2q_{0}q_{y}-2q_{x}q_{z}\right),\\
\psi & =\mathrm{atan}\left(\dfrac{2q_{0}q_{z}+2q_{x}q_{y}}{q_{x}^{2}-q_{y}^{2}-q_{z}^{2}+q_{0}^{2}}\right).
\end{aligned}
\label{eq:37}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
为了将欧拉角映射到四元数中，我们使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:11"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中得出的顺序，将横滚角、俯仰角和偏航角分量组合成姿态四元数，以便
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}=\mathbf{q}_{\psi}\otimes\mathbf{q}_{\theta}\otimes\mathbf{q}_{\phi}.\label{eq:38}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
注意：组合顺序与方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:12"
plural "false"
caps "false"
noprefix "false"

\end_inset

)所描述的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:35"
plural "false"
caps "false"
noprefix "false"

\end_inset

)相反。从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:14"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}_{\phi}\triangleq\left[\begin{array}{c}
\sin\dfrac{\phi}{2}\\
0\\
0\\
\cos\dfrac{\phi}{2}
\end{array}\right],\mathbf{q}_{\theta}\triangleq\left[\begin{array}{c}
0\\
\sin\dfrac{\theta}{2}\\
0\\
\cos\dfrac{\theta}{2}
\end{array}\right],\mathbf{q}_{\psi}\triangleq\left[\begin{array}{c}
0\\
0\\
\sin\dfrac{\psi}{2}\\
\cos\dfrac{\psi}{2}
\end{array}\right].\label{eq:39}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
为了用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:39"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的定义证明方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:38"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:35"
plural "false"
caps "false"
noprefix "false"

\end_inset

)是一致的，我们只需要将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:9"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和三角函数倍角恒等式应用于方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:39"
plural "false"
caps "false"
noprefix "false"

\end_inset

)。例如，设
\begin_inset Formula $\mathbf{k}\triangleq\left[\begin{array}{lll}
0 & 0 & 1\end{array}\right]^{\top}$
\end_inset

，我们发现
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{R}\left(\mathbf{q}_{\psi}\right)= & \left(2\cos^{2}\left(\dfrac{\psi}{2}\right)-1\right)\mathbf{I}-2\cos\left(\dfrac{\psi}{2}\right)\sin\left(\dfrac{\psi}{2}\right)\left\lfloor \mathbf{k}\right\rfloor \\
 & +2\sin^{2}\left(\dfrac{\psi}{2}\right)\mathbf{k}\mathbf{k}^{\top}\\
= & \cos\psi\mathbf{I}-\sin\psi\left\lfloor \mathbf{k}\right\rfloor +\left(1-\cos\psi\right)\mathbf{k}\mathbf{k}^{\top}\\
= & \mathbf{R}_{\psi}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
通过将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:39"
plural "false"
caps "false"
noprefix "false"

\end_inset

)代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:38"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，一个单位四元数可以根据横滚角、俯仰角和偏航角构造为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}q_{x} & =\cos\dfrac{\psi}{2}\cos\dfrac{\theta}{2}\sin\dfrac{\phi}{2}-\sin\dfrac{\psi}{2}\sin\dfrac{\theta}{2}\cos\dfrac{\phi}{2},\\
q_{y} & =\cos\dfrac{\psi}{2}\sin\dfrac{\theta}{2}\cos\dfrac{\phi}{2}+\sin\dfrac{\psi}{2}\cos\dfrac{\theta}{2}\sin\dfrac{\phi}{2},\\
q_{z} & =\sin\dfrac{\psi}{2}\cos\dfrac{\theta}{2}\cos\dfrac{\phi}{2}-\cos\dfrac{\psi}{2}\sin\dfrac{\theta}{2}\sin\dfrac{\phi}{2},\\
q_{0} & =\cos\dfrac{\psi}{2}\cos\dfrac{\theta}{2}\cos\dfrac{\phi}{2}+\sin\dfrac{\psi}{2}\sin\dfrac{\theta}{2}\sin\dfrac{\phi}{2}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:A"
plural "false"
caps "false"
noprefix "false"

\end_inset

 给出了Jacobian矩阵的推导，该Jacobian矩阵将欧拉角分解中的误差与姿态误差状态相关联。定义
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{\Delta}\triangleq\left[\begin{array}{c}
\phi-\hat{\phi}\\
\theta-\hat{\theta}\\
\psi-\hat{\psi}
\end{array}\right]
\]

\end_inset

该
\begin_inset Formula $\boldsymbol{\Delta}$
\end_inset

的协方差与
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

的协方差的关系为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E\left[\boldsymbol{\Delta}\boldsymbol{\Delta}^{\top}\right]=\mathbf{N}_{\boldsymbol{\Delta}}E\left[\delta\boldsymbol{\theta}\delta\boldsymbol{\theta}^{\top}\right]\mathbf{N}_{\boldsymbol{\Delta}}^{\top},
\]

\end_inset

其中对于iRN的情况，由附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:A"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:100"
plural "false"
caps "false"
noprefix "false"

\end_inset

)给出
\begin_inset Formula $\mathbf{N}_{\boldsymbol{\Delta}}=\partial\boldsymbol{\Delta}/\partial\delta\boldsymbol{\theta}$
\end_inset

。 
\end_layout

\begin_layout Subsection
误差四元数特性
\begin_inset CommandInset label
LatexCommand label
name "subsec:3.8"

\end_inset


\end_layout

\begin_layout Standard
本节介绍了误差四元数的几个特性，在推导Jacobian矩阵时需要这些特性，而该矩阵在RMEKF中被用到。这些特性中的第一个特性与两个误差四元数的乘积有关。使用方
程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:32"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:3a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，通过去掉二阶项，我们得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}_{c} & =\delta\mathbf{q}_{a}\otimes\delta\mathbf{q}_{b}\\
\left[\begin{array}{c}
\dfrac{1}{2}\delta\boldsymbol{\theta}_{c}\\
1
\end{array}\right] & =\left[\begin{array}{cc}
\mathbf{I}+\dfrac{1}{2}\left\lfloor \delta\boldsymbol{\theta}_{a}\right\rfloor  & \dfrac{1}{2}\delta\boldsymbol{\theta}_{a}\\
-\dfrac{1}{2}\delta\boldsymbol{\theta}_{a}^{\top} & 1
\end{array}\right]\left[\begin{array}{c}
\dfrac{1}{2}\delta\boldsymbol{\theta}_{b}\\
1
\end{array}\right]\\
 & =\left[\begin{array}{c}
\dfrac{1}{2}\delta\boldsymbol{\theta}_{a}+\dfrac{1}{4}\left\lfloor \delta\boldsymbol{\theta}_{a}\right\rfloor \delta\boldsymbol{\theta}_{b}+\dfrac{1}{2}\delta\boldsymbol{\theta}_{b}\\
-\dfrac{1}{4}\delta\boldsymbol{\theta}_{a}^{\top}\delta\boldsymbol{\theta}_{b}+1
\end{array}\right]\\
 & \approx\left[\begin{array}{c}
\dfrac{1}{2}\left(\delta\boldsymbol{\theta}_{a}+\delta\boldsymbol{\theta}_{b}\right)\\
1
\end{array}\right],
\end{aligned}
\]

\end_inset

由此我们可以得出结论，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\mathbf{q}_{c} & =\delta\mathbf{q}_{a}\otimes\delta\mathbf{q}_{b}\nonumber \\
\Longrightarrow\delta\boldsymbol{\theta}_{c} & \approx\delta\boldsymbol{\theta}_{a}+\delta\boldsymbol{\theta}_{b}.\label{eq:40}
\end{align}

\end_inset

同样可以证明
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}_{c}=\left(\delta\mathbf{q}_{a}\right)^{-1}\otimes\delta\mathbf{q}_{b} & \Longrightarrow\delta\boldsymbol{\theta}_{c}\approx-\delta\boldsymbol{\theta}_{a}+\delta\boldsymbol{\theta}_{b},\\
\delta\mathbf{q}_{c}=\delta\mathbf{q}_{a}\otimes\left(\delta\mathbf{q}_{b}\right)^{-1} & \Longrightarrow\delta\boldsymbol{\theta}_{c}\approx\delta\boldsymbol{\theta}_{a}-\delta\boldsymbol{\theta}_{b}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
对于下一个特性，我们回顾第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:3.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节，四元数共轭操作在任意四元数上旋转该四元数的向量部分的基。使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:13"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:32"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们可以发现
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\mathbf{q}_{b} & =\mathbf{q}^{-1}\otimes\delta\mathbf{q}_{a}\otimes\mathbf{q}\nonumber \\
\Longrightarrow\delta\boldsymbol{\theta}_{b} & \approx\mathbf{R}\left(\mathbf{q}\right)\delta\boldsymbol{\theta}_{a}.\label{eq:41}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
此外，方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:40"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:41"
plural "false"
caps "false"
noprefix "false"

\end_inset

)可组合以验证，例如，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\mathbf{q}_{c} & =\delta\mathbf{q}_{a}\otimes\mathbf{q}^{-1}\otimes\delta\mathbf{q}_{b}\otimes\mathbf{q}\nonumber \\
\Longrightarrow\delta\boldsymbol{\theta}_{c} & \approx\delta\boldsymbol{\theta}_{a}+\mathbf{R}\left(\mathbf{q}\right)\delta\boldsymbol{\theta}_{b}.\label{eq:42}
\end{align}

\end_inset


\end_layout

\begin_layout Section
MEKF
\begin_inset CommandInset label
LatexCommand label
name "sec:4"

\end_inset


\end_layout

\begin_layout Standard
有了四元数的符号和特性，我们准备概述所提出的估计框架：一个连续-离散的、间接的、乘性扩展Kalman滤波器(multiplicative extended
 Kalman filter, MEKF)。为了一般性，在本节中，我们推导MEKF，并不定义特定的状态、输入和测量变量。这一推导将在第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:6"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节和第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:7"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中更加具体化，在那里将给出具有特定变量定义的实际实现。本节主要是对文献中发现的技术的回顾，但引入了有助于澄清推导的符号。
\end_layout

\begin_layout Standard
Kalman滤波器为高斯噪声下的线性系统提供了最佳的最大似然状态估计。它使用当前状态估计
\begin_inset Formula $\hat{\mathbf{x}}=E\left[\mathbf{x}\right]$
\end_inset

、输入
\begin_inset Formula $\mathbf{u}$
\end_inset

和测量
\begin_inset Formula $\mathbf{z}$
\end_inset

的函数，递归地估计系统状态的演化。Kalman滤波器还保持状态不确定性的估计，由协方差矩阵
\begin_inset Formula $\mathbf{P}$
\end_inset

表示，通常定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{P}=E\left[\left(\mathbf{x}-E\left[\mathbf{x}\right]\right)\left(\mathbf{x}-E\left[\mathbf{x}\right]\right)^{\top}\right]\label{eq:43}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
EKF是Kalman滤波的扩展，适用于具有非线性动力学和/或非线性测量模型的系统。EKF将系统的当前最大似然状态估计线性化。与线性Kalman滤波器相比，EKF
的最优性和收敛性不再得到保证，但由于其鲁棒性和简单的实现，EKF在实践中得到了广泛的应用。然而，如果状态
\begin_inset Formula $\mathbf{x}$
\end_inset

包含一个四元数，那么方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:43"
plural "false"
caps "false"
noprefix "false"

\end_inset

)就有根本的缺陷。首先，四元数减法没有如第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:3.6"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节所描述的那样得到很好的定义，第二，方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:43"
plural "false"
caps "false"
noprefix "false"

\end_inset

)永远不是满秩，因为四元数不是旋转的最小表示。这些问题可以用Kalman滤波的误差状态或间接表述来解决。
\end_layout

\begin_layout Standard
间接Kalman滤波跟踪误差状态
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

及其不确定性。与状态
\begin_inset Formula $\mathbf{x}$
\end_inset

不同，误差状态通过使用最小姿态表示被定义为向量空间的一个元素。误差状态是真实状态
\begin_inset Formula $\mathbf{x}$
\end_inset

和标称状态
\begin_inset Formula $\mathbf{x}_{\mathrm{nom}}$
\end_inset

之间差异的度量，其中
\begin_inset Formula $\mathbf{x}_{\mathrm{nom}}$
\end_inset

可以用多种不同的方式定义，如Farrell(2008)[13]所述。当系统动力学被特别好地建模时，例如对于在轨航天器，
\begin_inset Formula $\mathbf{x}_{\mathrm{nom}}$
\end_inset

可以是一个预先确定的前馈状态估计。更常见的是，标称状态是最大似然状态估计
\begin_inset Formula $\mathbf{x}_{\mathrm{nom}}=E\left[\mathbf{x}\right]$
\end_inset

。在这种情况下，测量提供反馈以更新标称状态，迫使误差状态的期望值为零。一些间接Kalman滤波实现区分
\series bold
快速
\series default
和
\series bold
慢速
\series default
测量，并且只更新慢速测量的标称状态(Farrell，2008[13]；Maybeck，1979[27])。对于这样的系统，以较快速率工作时
\begin_inset Formula $\mathbf{x}_{\mathrm{nom}}\neq E\left[\mathbf{x}\right]$
\end_inset

，因此期望的误差状态是非零的，并且必须被传播。对于本文中的推导，每个测量的标称状态都是等价更新的，以确保在任何给定的时间里
\begin_inset Formula $\mathbf{x}_{\mathrm{nom}}=\hat{\mathbf{x}}=E\left[\mathbf{x}\right]$
\end_inset

。
\end_layout

\begin_layout Standard
设
\begin_inset Formula $\mathbf{x}_{\mathbf{v}}$
\end_inset

和
\begin_inset Formula $\mathbf{x}_{\mathbf{q}}$
\end_inset

表示状态
\begin_inset Formula $\mathbf{x}$
\end_inset

的向量和四元数部分，
\begin_inset Formula $\delta\mathbf{x}_{\mathbf{v}}$
\end_inset

和
\begin_inset Formula $\delta\mathbf{x}_{\boldsymbol{\theta}}$
\end_inset

是误差状态
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

的对应元素。我们将这些误差状态元素定义为
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:44"

\end_inset


\begin_inset Formula 
\begin{align}
\delta\mathbf{x}_{\mathbf{v}} & \triangleq\mathbf{x}_{\mathbf{v}}-\hat{\mathbf{x}}_{\mathbf{v}},\label{eq:44a}\\
\delta\mathbf{x}_{\boldsymbol{\theta}} & \triangleq\delta\mathbf{q}^{\vee},\label{eq:44b}
\end{align}

\end_inset


\end_layout

\end_inset

其中
\begin_inset Formula $\delta\mathbf{q}$
\end_inset

由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30"
plural "false"
caps "false"
noprefix "false"

\end_inset

)使用
\begin_inset Formula $\mathbf{x}_{\mathbf{q}}$
\end_inset

和
\begin_inset Formula $\hat{\mathbf{x}}_{\mathbf{q}}$
\end_inset

定义。该结果有一个特性
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
E\left[\delta\mathbf{x}\right]=\mathbf{0},\label{eq:45}
\end{equation}

\end_inset

其在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:B.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中推导。因为误差状态是向量空间的一部分，并且做为方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:45"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的结果，间接Kalman滤波器使用定义良好的协方差表示状态不确定性
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{P} & =E\left[\left(\delta\mathbf{x}-E\left[\delta\mathbf{x}\right]\right)\left(\delta\mathbf{x}-E\left[\delta\mathbf{x}\right]\right)^{\top}\right]\nonumber \\
 & =E\left[\delta\mathbf{x}\delta\mathbf{x}^{\top}\right].\label{eq:46}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
做为解释说明，在这个公式中，未知的真实状态被建模为以当前状态估计为中心的随机变量。更具体地说，真实状态的向量和四元数部分使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的逆值被建模为随机变量，写为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{x}_{\mathbf{v}} & =\hat{\mathbf{x}}_{\mathbf{v}}+\delta\mathbf{x}_{\mathbf{v}},\\
\mathrm{iRN:}\ \mathbf{x}_{\mathbf{q}} & =\hat{\mathbf{x}}_{\mathbf{q}}\otimes\left(\delta\mathbf{x}_{\boldsymbol{\theta}}\right)^{\wedge},\\
\mathrm{bRN:}\ \mathbf{x}_{\mathbf{q}} & =\left(\delta\mathbf{x}_{\boldsymbol{\theta}}\right)^{\wedge}\otimes\hat{\mathbf{x}}_{\mathbf{q}},
\end{aligned}
\]

\end_inset

其中
\begin_inset Formula $\delta\mathbf{x}_{\mathbf{v}}$
\end_inset

和
\begin_inset Formula $\delta\mathbf{x}_{\boldsymbol{\theta}}$
\end_inset

是高斯随机向量的元素
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\mathbf{x}\sim\mathcal{N}\left(\mathbf{0},\mathbf{P}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Kalman滤波器被分解为两个步骤：传播步骤和更新步骤，这分别在第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:4.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节和第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:4.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中描述。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:4.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节讨论了处理延迟或乱序测量的方法。一般来说，MEKF可以使用惯性坐标系或固体坐标系。然而，其中存在一些细微的差异，并被突出显示为特定于iRN或bRN。
\end_layout

\begin_layout Subsection
传播
\begin_inset CommandInset label
LatexCommand label
name "subsec:4.1"

\end_inset


\end_layout

\begin_layout Standard
考虑连续时间系统
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{x}}=\mathbf{f}\left(\mathbf{x},\mathbf{u}+\boldsymbol{\nu}\right)+\boldsymbol{\eta},\label{eq:47}
\end{equation}

\end_inset

其中
\begin_inset Formula $\boldsymbol{\nu}\sim\mathcal{N}\left(\mathbf{0},\mathbf{Q}_{\mathbf{u}}\right)$
\end_inset

和
\begin_inset Formula $\boldsymbol{\eta}\sim\mathcal{N}\left(\mathbf{0},\mathbf{Q}_{\mathbf{x}}\right)$
\end_inset

是零均值高斯随机变量。更具体地说，我们假设
\begin_inset Formula $\boldsymbol{\eta}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\nu}$
\end_inset

是不相关的，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
E\left[\boldsymbol{\eta}\boldsymbol{\nu}^{\top}\right]=\mathbf{0},\label{eq:48}
\end{equation}

\end_inset

并且输入和过程噪声在时间上不相关
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}E\left[\boldsymbol{\eta}\left(t\right)\boldsymbol{\eta}\left(\tau\right)^{\top}\right] & =\mathbf{Q}_{\mathbf{x}}\delta\left(t-\tau\right),\\
E\left[\boldsymbol{\nu}\left(t\right)\boldsymbol{\nu}\left(\tau\right)^{\top}\right] & =\mathbf{Q}_{\mathbf{u}}\delta\left(t-\tau\right),
\end{aligned}
\label{eq:49}
\end{equation}

\end_inset

其中
\begin_inset Formula $\delta\left(t\right)$
\end_inset

是狄拉克
\begin_inset Formula $\delta$
\end_inset

函数。
\end_layout

\begin_layout Standard
在传播步骤中，滤波器根据标称传播动力学向前传播状态估计，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{\hat{\mathbf{x}}}=\mathbf{f}\left(\hat{\mathbf{x}},\mathbf{u}\right).\label{eq:50}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
当
\begin_inset Formula $\mathbf{x}$
\end_inset

是向量空间的一部分时，传播协方差所需的Jacobian矩阵由误差状态动力学的一阶泰勒级数展开式中获得，即
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:51"

\end_inset


\begin_inset Formula 
\begin{align}
\delta\dot{\mathbf{x}} & =\mathbf{f}\left(\mathbf{x},\mathbf{u}+\boldsymbol{\nu}\right)+\boldsymbol{\eta}-\mathbf{f}\left(\hat{\mathbf{x}},\mathbf{u}\right)\label{eq:51a}\\
 & \approx\mathbf{f}\left(\hat{\mathbf{x}},\mathbf{u}\right)+\left.\dfrac{\partial\mathbf{f}}{\partial\mathbf{x}}\right|_{\hat{\mathbf{x}},\mathbf{u}}\delta\mathbf{x}+\left.\dfrac{\partial\mathbf{f}}{\partial\mathbf{u}}\right|_{\hat{\mathbf{x}},\mathbf{u}}\boldsymbol{\nu}+\boldsymbol{\eta}-\mathbf{f}\left(\hat{\mathbf{x}},\mathbf{u}\right)\nonumber \\
 & =\left.\dfrac{\partial\mathbf{f}}{\partial\mathbf{x}}\right|_{\hat{\mathbf{x}},\mathbf{u}}\delta\mathbf{x}+\left.\dfrac{\partial\mathbf{f}}{\partial\mathbf{u}}\right|_{\hat{\mathbf{x}},\mathbf{u}}\boldsymbol{\nu}+\boldsymbol{\eta}.\label{eq:51b}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
然而，当状态
\begin_inset Formula $\mathbf{x}$
\end_inset

包括四元数项时，误差状态动力学不能像方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:51a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)那样通过简单的减法形成。实际上，如第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:3.6"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节所述，误差状态
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

的维数小于
\begin_inset Formula $\mathbf{x}$
\end_inset

。注意，根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，
\begin_inset Formula $\mathbf{x}$
\end_inset

是
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

和
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

的函数，误差状态的动力学一般可以表示为单一函数
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\dot{\mathbf{x}}=\bar{\mathbf{f}}\left(\delta\mathbf{x},\boldsymbol{v},\hat{\mathbf{x}},\mathbf{u}\right)+\boldsymbol{\eta},\label{eq:52}
\end{equation}

\end_inset

其中只有
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

，
\begin_inset Formula $\boldsymbol{\nu}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\eta}$
\end_inset

是随机变量
\begin_inset Foot
status open

\begin_layout Plain Layout
注意我们对符号的轻微滥用，即方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:52"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的
\begin_inset Formula $\boldsymbol{\eta}$
\end_inset

与误差向量的维数相同，而方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:47"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的
\begin_inset Formula $\boldsymbol{\eta}$
\end_inset

与状态向量的维数相同。
\end_layout

\end_inset

。函数
\begin_inset Formula $\bar{\mathbf{f}}$
\end_inset

然后适当地处理状态的四元数部分。在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:B.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中，我们证明了
\begin_inset Formula $\bar{\mathbf{f}}\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}\right)=\mathbf{0}$
\end_inset

。对于协方差传播的Jacobian矩阵由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:52"
plural "false"
caps "false"
noprefix "false"

\end_inset

)关于
\begin_inset Formula $\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}\right)$
\end_inset

的一阶泰勒级数展开式计算，如下所示：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\dot{\mathbf{x}} & \approx\bar{\mathbf{f}}\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}\right)+\boldsymbol{\eta}\nonumber \\
 & \ +\mathbf{F}\left(\delta\mathbf{x}-E\left[\delta\mathbf{x}\right]\right)+\mathbf{G}\left(\boldsymbol{\nu}-E\left[\boldsymbol{\nu}\right]\right)\nonumber \\
 & =\mathbf{F}\delta\mathbf{x}+\mathbf{G}\boldsymbol{\nu}+\boldsymbol{\eta},\label{eq:53}
\end{align}

\end_inset

其中有
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{F}=\left.\dfrac{\partial\bar{\mathbf{f}}\left(\delta\mathbf{x},\boldsymbol{\nu},\hat{\mathbf{x}},\mathbf{u}\right)}{\partial\delta\mathbf{x}}\right|_{E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}}
\]

\end_inset

和
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{G}=\left.\dfrac{\partial\bar{\mathbf{f}}\left(\delta\mathbf{x},\boldsymbol{\nu},\hat{\mathbf{x}},\mathbf{u}\right)}{\partial\boldsymbol{\nu}}\right|_{E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}},
\]

\end_inset

并且
\begin_inset Formula $E\left[\delta\mathbf{x}\right]=E\left[\boldsymbol{\nu}\right]=\mathbf{0}$
\end_inset

。注意，方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:53"
plural "false"
caps "false"
noprefix "false"

\end_inset

)具有方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:51b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的形式，但是Jacobian矩阵项，是误差状态动力学相对于误差状态和输入噪声微分，而不是相对于状态和输入。
\end_layout

\begin_layout Standard
误差状态协方差传播是通过对方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:46"
plural "false"
caps "false"
noprefix "false"

\end_inset

)进行时间微分，并利用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:53"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的线性化误差动力学给出为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\dot{\mathbf{P}} & =E\left[\delta\dot{\mathbf{x}}\delta\mathbf{x}^{\top}+\delta\mathbf{x}\delta\dot{\mathbf{x}}^{\top}\right]\nonumber \\
 & =E\left[\mathbf{F}\delta\mathbf{x}\delta\mathbf{x}^{\top}+\mathbf{G}\boldsymbol{\nu}\delta\mathbf{x}^{\top}+\boldsymbol{\eta}\delta\mathbf{x}^{\top}\right]\nonumber \\
 & \ +E\left[\delta\mathbf{x}\delta\mathbf{x}^{\top}\mathbf{F}^{\top}+\delta\mathbf{x}\boldsymbol{\nu}^{\top}\mathbf{G}^{\top}+\delta\mathbf{x}\boldsymbol{\eta}^{\top}\right]\nonumber \\
 & =\mathbf{F}\mathbf{P}+\mathbf{PF}^{\top}+E\left[\mathbf{G}\boldsymbol{\nu}\delta\mathbf{x}^{\top}+\delta\mathbf{x}\boldsymbol{\nu}^{\top}\mathbf{G}^{\top}\right]\nonumber \\
 & \ +E\left[\boldsymbol{\eta}\delta\mathbf{x}^{\top}+\delta\mathbf{x}\boldsymbol{\eta}^{\top}\right].\label{eq:54}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
为简化各项，我们用初始条件
\begin_inset Formula $\delta\mathbf{x}_{0}$
\end_inset

解方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:53"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的微分方程得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\mathbf{x}\left(t\right)=e^{\mathbf{F}t}\delta\mathbf{x}_{0}+\int_{0}^{t}e^{\mathbf{F}\left(t-\tau\right)}\mathbf{G}\boldsymbol{\nu}\left(\tau\right)\mathrm{d}\tau+\int_{0}^{t}e^{\mathbf{F}\left(t-\tau\right)}\boldsymbol{\eta}\left(\tau\right)\mathrm{d}\tau.\label{eq:55}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
利用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:55"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和特性方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:48"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:49"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们看到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
E\left[\delta\mathbf{x}\boldsymbol{\nu}^{\top}\mathbf{G}^{\boldsymbol{\top}}\right]= & E\left[e^{\mathbf{F}t}\delta\mathbf{x}_{0}\boldsymbol{\nu}^{\top}\mathbf{G}^{\boldsymbol{\top}}\right]\nonumber \\
 & \ +E\left[\int_{0}^{t}e^{\mathbf{F}\left(t-\tau\right)}\mathbf{G}\boldsymbol{\nu}\left(\tau\right)\boldsymbol{\nu}^{\top}\left(t\right)\mathbf{G}^{\top}\mathrm{d}\tau\right]\nonumber \\
 & \ +E\left[\int_{0}^{t}e^{\mathbf{F}\left(t-\tau\right)}\boldsymbol{\eta}\left(\tau\right)\boldsymbol{\nu}^{\top}\left(t\right)\mathbf{G}^{\boldsymbol{\top}}\mathrm{d}\tau\right]\nonumber \\
= & E\left[\int_{0}^{t}e^{\mathbf{F}\left(t-\tau\right)}\mathbf{G}\mathbf{Q}_{\mathbf{u}}\delta\left(t-\tau\right)\mathbf{G}^{\top}\mathrm{d}\tau\right]\nonumber \\
= & \dfrac{1}{2}\mathbf{G}\mathbf{Q}_{\mathbf{u}}\mathbf{G}^{\top}\label{eq:56}
\end{align}

\end_inset

其中
\begin_inset Formula $\dfrac{1}{2}$
\end_inset

是因为积分的边界只使用
\begin_inset Formula $\delta$
\end_inset

函数内部面积的一半。同样地，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
E\left[\delta\mathbf{x}\boldsymbol{\eta}^{\top}\right]=\dfrac{1}{2}\mathbf{Q}_{\mathbf{x}}.\label{eq:57}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
因为
\begin_inset Formula $\mathbf{Q}_{\mathbf{u}}$
\end_inset

和
\begin_inset Formula $\mathbf{Q}_{\mathbf{x}}$
\end_inset

是对称的，组合方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:54"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:56"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:57"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们得到
\begin_inset Formula $\mathbf{P}$
\end_inset

在测量之间演变为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{P}}=\mathbf{F}\mathbf{P}+\mathbf{P}\mathbf{F}^{\top}+\mathbf{G}\mathbf{Q}_{\mathbf{u}}\mathbf{G}^{\top}+\mathbf{Q}_{\mathbf{x}}\label{eq:58}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
总之，在传播步骤期间，使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:50"
plural "false"
caps "false"
noprefix "false"

\end_inset

)向前传播
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

，并且使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:58"
plural "false"
caps "false"
noprefix "false"

\end_inset

)向前传播误差协方差。此外，由于
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

的演化由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:53"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和
\begin_inset Formula $E\left[\delta\mathbf{x}\right]\left(0\right)=\mathbf{0}$
\end_inset

给出，因此在传播窗口上
\begin_inset Formula $E\left[\delta\mathbf{x}\right]\left(t\right)=\mathbf{0}$
\end_inset

。
\end_layout

\begin_layout Subsection
测量更新
\begin_inset CommandInset label
LatexCommand label
name "subsec:4.2"

\end_inset


\end_layout

\begin_layout Standard
对于
\series bold
更新
\series default
(
\emph on
update
\emph default
)步骤，考虑测量
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{z}=\mathbf{h}\left(\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}}\right),\label{eq:59}
\end{equation}

\end_inset

其中
\begin_inset Formula $\boldsymbol{\eta}_{\mathbf{z}}\sim\mathcal{N}\left(\mathbf{0},\mathbf{R}\right)$
\end_inset

表示测量噪声。如果测量是向量量，则此测量噪声通常是加性的，但是如果测量量是四元数，则通过四元数乘法应用噪声。
\end_layout

\begin_layout Standard
残差
\begin_inset Formula $\mathbf{r}$
\end_inset

是真实测量值和预测测量值之间的差异
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\mathbf{z}}=\mathbf{h}\left(\hat{\mathbf{x}},\mathbf{0}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
传统上，假设在向量空间中测量，使得方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:59"
plural "false"
caps "false"
noprefix "false"

\end_inset

)简化为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{z}=\mathbf{h}\left(\mathbf{x}\right)+\boldsymbol{\eta}_{\mathbf{z}}.
\]

\end_inset


\end_layout

\begin_layout Standard
在这种情况下，通过减法找到残差，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}=\mathbf{z}-\mathbf{h}\left(\hat{\mathbf{x}}\right),
\]

\end_inset

并被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}=\mathbf{h}\left(\mathbf{x}\right)+\boldsymbol{\eta}_{\mathbf{z}}-\mathbf{h}\left(\hat{\mathbf{x}}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
然后使用一阶泰勒级数展开式计算Jacobian矩阵为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{r} & \approx\mathbf{h}\left(\hat{\mathbf{x}}\right)+\left.\dfrac{\partial\mathbf{h}\left(\mathbf{x}\right)}{\partial\mathbf{x}}\right|_{\hat{\mathbf{x}}}\delta\mathbf{x}+\boldsymbol{\eta}_{\mathbf{z}}-\mathbf{h}\left(\hat{\mathbf{x}}\right)\nonumber \\
 & =\left.\dfrac{\partial\mathbf{h}\left(\mathbf{x}\right)}{\partial\mathbf{x}}\right|_{\hat{\mathbf{x}}}\delta\mathbf{x}+\boldsymbol{\eta}_{\mathbf{z}}.\label{eq:60}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
这些测量和残差模型与在方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:51"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中提出的传统误差状态动力学具有相似的缺点，即它们不适用于四元数测量，并且方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:60"
plural "false"
caps "false"
noprefix "false"

\end_inset

)假设状态
\begin_inset Formula $\mathbf{x}$
\end_inset

与
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

具有相同的维数。
\end_layout

\begin_layout Standard
这些问题可以通过将残差模型表达为一个单一的函数来解决，与第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:4.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中传播步骤所采用的方法相类似。再次注意，
\begin_inset Formula $\mathbf{x}$
\end_inset

是
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

和
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

的函数，残差被建模为函数
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}=\bar{\mathbf{h}}\left(\delta\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}},\hat{\mathbf{x}}\right),
\]

\end_inset

其中只有前两个变量是随机的。对于向量值的测量
\begin_inset Formula $\mathbf{z}_{\mathbf{v}}$
\end_inset

，残差值通过减法计算为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{r}=\mathbf{z}_{\mathbf{v}}-\mathbf{h}\left(\hat{\mathbf{x}},\mathbf{0}\right),\label{eq:61}
\end{equation}

\end_inset

并被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{h}}\left(\delta\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}},\hat{\mathbf{x}}\right)=\mathbf{h}\left(\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}}\right)-\mathbf{h}\left(\hat{\mathbf{x}},\mathbf{0}\right),\label{eq:62}
\end{equation}

\end_inset

其中
\begin_inset Formula $\mathbf{x}$
\end_inset

可以根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29"
plural "false"
caps "false"
noprefix "false"

\end_inset

)并通过重新排列方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)以
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

和
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

的形式重写。对于四元数值的测量值
\begin_inset Formula $\mathbf{z}_{\mathbf{q}}$
\end_inset

，根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，残差值被计算为观测和预期四元数之间误差的
\begin_inset Formula $3$
\end_inset

参数向量最小表示，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathrm{iRN:}\ \mathbf{r} & =\left(\mathbf{h}\left(\hat{\mathbf{x}},\mathbf{0}\right)^{-1}\otimes\mathbf{z}_{\mathbf{q}}\right)^{\vee},\\
\mathrm{bRN:}\ \mathbf{r} & =\left(\mathbf{z}_{\mathbf{q}}\otimes\mathbf{h}\left(\hat{\mathbf{x}},\mathbf{0}\right)^{-1}\right)^{\vee},
\end{aligned}
\label{eq:63}
\end{equation}

\end_inset

并被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathrm{iRN:}\ \bar{\mathbf{h}}\left(\delta\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}},\hat{\mathbf{x}}\right) & =\left(\mathbf{h}\left(\hat{\mathbf{x}},\mathbf{0}\right)^{-1}\otimes\mathbf{h}\left(\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}}\right)\right)^{\vee},\\
\mathrm{bRN:}\ \bar{\mathbf{h}}\left(\delta\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}},\hat{\mathbf{x}}\right) & =\left(\mathbf{h}\left(\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}}\right)\otimes\mathbf{h}\left(\hat{\mathbf{x}},\mathbf{0}\right)^{-1}\right)^{\vee},
\end{aligned}
\label{eq:64}
\end{equation}

\end_inset

其中
\begin_inset Formula $\mathbf{x}$
\end_inset

又可以根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)用
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

和
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

来重写。
\end_layout

\begin_layout Standard
由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:62"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:64"
plural "false"
caps "false"
noprefix "false"

\end_inset

)可知，残差模型的特性为
\begin_inset Formula $\bar{\mathbf{h}}\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\eta}_{\mathbf{z}}\right],\hat{\mathbf{x}}\right)=\mathbf{0}$
\end_inset

。本文中的测量模型的选择使噪声在残差空间中是加性的，这意味着
\begin_inset Formula $\dfrac{\partial\mathbf{r}}{\partial\boldsymbol{\eta}_{\mathbf{z}}}=\mathbf{I}$
\end_inset

。测量Jacobian矩阵的计算使用
\begin_inset Formula $\bar{\mathbf{h}}$
\end_inset

关于
\begin_inset Formula $\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\eta}_{\mathbf{z}}\right],\hat{\mathbf{x}}\right)$
\end_inset

的一阶泰勒级数展开式
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}\approx & \bar{\mathbf{h}}\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\eta}_{\mathbf{z}}\right],\hat{\mathbf{x}}\right)+\mathbf{H}\left(\delta\mathbf{x}-E\left[\delta\mathbf{x}\right]\right)\\
 & \ +\mathbf{I}\left(\boldsymbol{\eta}_{\mathbf{z}}-E\left[\boldsymbol{\eta}_{\mathbf{z}}\right]\right)\\
= & \mathbf{H}\delta\mathbf{x}+\boldsymbol{\eta}_{\mathbf{z}},
\end{aligned}
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}=\left.\dfrac{\partial\bar{\mathbf{h}}\left(\delta\mathbf{x},\boldsymbol{\eta}_{\mathbf{z}},\hat{\mathbf{x}}\right)}{\partial\delta\mathbf{x}}\right|_{E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\eta}_{\mathbf{z}}\right],\hat{\mathbf{x}}}
\]

\end_inset

并且
\begin_inset Formula $E\left[\delta\mathbf{x}\right]=E\left[\boldsymbol{\eta}_{\mathbf{z}}\right]=\mathbf{0}$
\end_inset

。
\end_layout

\begin_layout Standard
假设测量噪声、误差状态和输入噪声不相关，则残差不确定度为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{S} & \triangleq E\left[\mathbf{r}\mathbf{r}^{\top}\right]\nonumber \\
 & =E\left[\mathbf{H}\delta\mathbf{x}\delta\mathbf{x}^{\top}\mathbf{H}^{\top}+\boldsymbol{\eta}_{\mathbf{z}}\boldsymbol{\eta}_{\mathbf{z}}^{\top}\right]\nonumber \\
 & =\mathbf{H}\mathbf{P}\mathbf{H}^{\top}+\mathbf{R}.\label{eq:65}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Kalman增益利用残差和状态不确定性来确定残差的可信程度和应用范围。利用残差协方差，Kalman增益为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{K}=\mathbf{P}\mathbf{H}^{\top}\mathbf{S}^{-1}.\label{eq:66}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
在融合由测量所提供的信息时，误差状态的
\series bold
后验
\series default
(
\emph on
posteriori
\emph default
)估计，用
\begin_inset Formula $^{+}$
\end_inset

表示，为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\mathbf{x}^{+}=\delta\mathbf{x}+\mathbf{Kr},
\]

\end_inset

这意味着
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E\left[\delta\mathbf{x}^{+}\right]=\mathbf{Kr}.
\]

\end_inset


\end_layout

\begin_layout Standard
有了测量更新提供的附加信息，误差状态不再是零均值，这违反了方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:45"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的特性。让
\begin_inset Formula $\mathbf{x}_{\mathbf{v}}$
\end_inset

和
\begin_inset Formula $\mathbf{x}_{\mathbf{q}}$
\end_inset

再次成为在
\begin_inset Formula $\mathbf{x}$
\end_inset

中的向量和四元数状态，并且让
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

和
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

成为Kalman更新
\begin_inset Formula $\mathbf{Kr}$
\end_inset

的对应部分。为了确保误差状态保持零均值，Kalman更新
\begin_inset Formula $\mathbf{Kr}$
\end_inset

被用来调整
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

为
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:67"

\end_inset


\begin_inset Formula 
\begin{align}
\hat{\mathbf{x}}_{\mathbf{v}}^{+} & =\hat{\mathbf{x}}_{\mathbf{v}}+\Delta\mathbf{v}\nonumber \\
\mathrm{iRN:}\ \hat{\mathbf{x}}_{\mathbf{q}}^{+} & =\hat{\mathbf{x}}_{\mathbf{q}}\otimes\Delta\boldsymbol{\theta}^{\wedge}\label{eq:67a}\\
\mathrm{bRN:}\ \hat{\mathbf{x}}_{\mathbf{q}}^{+} & =\Delta\boldsymbol{\theta}^{\wedge}\otimes\hat{\mathbf{x}}_{\mathbf{q}}.\label{eq:67b}
\end{align}

\end_inset


\end_layout

\end_inset

其中方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:67a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:67b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)特定于所使用的四元数误差状态定义。
\end_layout

\begin_layout Standard
最后，协方差按照惯例更新为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{P}^{+}=\left(\mathbf{I}-\mathbf{KH}\right)\mathbf{P}.
\]

\end_inset


\end_layout

\begin_layout Standard
在实践中，我们使用约瑟夫形式(Joseph-form)的Kalman更新，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{P}^{+}=\left(\mathbf{I}-\mathbf{KH}\right)\mathbf{P}\left(\mathbf{I}-\mathbf{KH}\right)^{\top}+\mathbf{KRK}^{\top},\label{eq:68}
\end{equation}

\end_inset

因为它提高了数值稳定性并确保协方差矩阵保持对称(Bar-Shalom等人，2002[3])。
\end_layout

\begin_layout Standard
总之，在更新步骤期间，测量残差方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:61"
plural "false"
caps "false"
noprefix "false"

\end_inset

)或(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:63"
plural "false"
caps "false"
noprefix "false"

\end_inset

)提供了额外的信息，导致
\begin_inset Formula $E\left[\delta\mathbf{x}\right]$
\end_inset

不为零。利用Kalman增益方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:66"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:67"
plural "false"
caps "false"
noprefix "false"

\end_inset

)更新
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

，以确保
\begin_inset Formula $E\left[\delta\mathbf{x}\right]$
\end_inset

保持零均值。根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:68"
plural "false"
caps "false"
noprefix "false"

\end_inset

)更新误差状态协方差。
\end_layout

\begin_layout Subsection
延迟的乱序测量
\begin_inset CommandInset label
LatexCommand label
name "subsec:4.3"

\end_inset


\end_layout

\begin_layout Standard
Kalman滤波器假设状态按照Markov过程演化。因此，状态对于以前所有时间步骤的估计都被边缘化了。这使得当延迟或乱序测量最终到达时，很难计算它们的残差。在实
践中，延迟测量是常见的。例如，视觉里程计算法可能需要数百毫秒来执行计算测量值所需的计算机视觉操作。理想情况下，此测量用于在拍摄图像时约束车辆的状态，而不是在测量
到达时约束车辆的状态。
\end_layout

\begin_layout Standard
为了解决延迟测量，我们使用优先级队列来保存按时间排序的最后
\begin_inset Formula $T$
\end_inset

秒的输入、测量、状态和误差状态协方差。如果延迟测量到达时的时间戳超过
\begin_inset Formula $T$
\end_inset

秒，我们就丢弃该测量。否则，我们就丢弃所有保存的时间戳晚于传入的延迟测量的时间戳的状态和误差状态协方差。在这一点上，在延迟测量应该到达的那一刻，我们只剩下状态和
协方差估计。我们通常应用测量，然后使用输入和测量队列将MEKF重新传播到当前时间实例。这种方法提供了相同的状态估计，就好像所有测量都在正确的时间到达一样。以这种
方式处理延迟消息可能不适用于所有处理器。Bopardikar等人(2013)[8]和Shen等人(2014)[30]也描述了类似的方法。
\end_layout

\begin_layout Section
相对导航
\begin_inset CommandInset label
LatexCommand label
name "sec:5"

\end_inset


\end_layout

\begin_layout Standard
第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节概述了间接MEKF。本节描述了MEKF如何适应相对导航框架。
\end_layout

\begin_layout Standard
传统的滤波方法直接估计车辆相对于一些惯性固定原点的全局状态，如GPS原点或车辆的起始位置；然而，当只有相对位置测量值可用时，例如通过视觉里程计或激光扫描匹配获得
，车辆的全局位置和航向是不可观测的(Jones等人，2007[15]；Martinelli，2012[26]；Weiss等人，2012[35])。随着时间的推移
，直接估计这些不可观测的状态会导致不一致和无界的状态不确定性，这会降低精度并导致滤波器中的不规则状态跳跃(Bailey和Durrant-Whyte，2006[2
]；Julier和Uhlmann，2001[16]；Kottas等人，2013[18])。有些人已经提出了缓解这些问题的方法(Bailey和Durrant-Wh
yte，2006[2]；Castellanos等人，2007[10]；Kottas等人，2013[18])，但不可观测状态的核心基础问题可以通过重新阐述相对状态
的问题来完全避免(Wheeler等人，2018[38])。
\end_layout

\begin_layout Standard
相对导航方法通过估计车辆相对于称为
\series bold
节点帧
\series default
(
\emph on
node frame
\emph default
)的局部坐标帧的位姿来保持滤波器状态的可观测性。该节点帧位于零高度，直接位于最新里程计关键帧的下方，但与重力对齐(即，当声明关键帧时，航向与车辆的航向对齐，但没
有俯仰或横滚)。做为结果，里程计提供了车辆相对于当前节点帧的位置和航向的几乎直接的测量，使得这些状态可以通过构造来观测到。
\end_layout

\begin_layout Standard
由于节点帧的定义方式，车辆姿态(
\begin_inset Formula $\phi$
\end_inset

，
\begin_inset Formula $\theta$
\end_inset

)的横滚和俯仰分量以及车辆高度
\begin_inset Formula $p_{z}$
\end_inset

的估计，就好像它们是相对于全局原点定义的一样。这些状态在从一个节点帧转换到另一个节点帧时不受影响，因此实际上独立于当前节点帧。另一方面，水平位置和航向状态(
\begin_inset Formula $p_{x}$
\end_inset

、
\begin_inset Formula $p_{y}$
\end_inset

和
\begin_inset Formula $\psi$
\end_inset

)定义了自最后一个节点帧以来车辆的移动方式，并被称为
\series bold
相对状态
\series default
(
\emph on
relative states
\emph default
)。每次声明一个新的关键帧时，也会声明一个新的节点帧，并将相对状态(
\begin_inset Formula $p_{x}$
\end_inset

、
\begin_inset Formula $p_{y}$
\end_inset

和
\begin_inset Formula $\psi$
\end_inset

)重置为零。与相对状态相关联的协方差也被重置为零，因为根据定义，车辆位于节点帧的位置，因此这些状态中没有不确定性。这如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:04"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。非相对状态(横滚、俯仰、高度、机体固连速度和机体固连惯性测量单元(IMU)偏差)及其协方差通过关键帧重置操作保持不变。注意，当姿态用四元数参数化时，重置
状态和协方差的航向分量是非平凡的。在重置之前，车辆当前的相对位姿估计和协方差被传递到后端的位姿图地图，该地图将相对位姿串联到车辆全局路径和当前全局位姿的估计中(
Wheeler等人，2018[38])。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig04.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:04"

\end_inset

从上面看的关键帧重置操作的图示。在重置之前(a)，估计的位姿(蓝色)和真实位姿(绿色)之间存在一些误差，估计的不确定性由蓝色协方差椭圆表示。重置发生时，根据定义
，车辆位于关键帧的位置。做为结果，在重置之后(b)，协方差矩阵的相对状态和相应元素被相同地设置为零并且没有误差。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
我们对关键帧重置操作的数学描述如下。让
\begin_inset Formula $\mathbf{n}\left(\mathbf{x}\right)$
\end_inset

定义关键帧重置操作。估计状态重置为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\mathbf{x}}^{+}=\mathbf{n}\left(\hat{\mathbf{x}}\right).\label{eq:69}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
重置后的误差状态
\begin_inset Formula $\delta\mathbf{x}^{+}$
\end_inset

，是
\begin_inset Formula $\mathbf{x}^{+}$
\end_inset

和
\begin_inset Formula $\hat{\mathbf{x}}^{+}$
\end_inset

之间的差值，如方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

)所定义。再次回顾一下，由于
\begin_inset Formula $\mathbf{x}$
\end_inset

是
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

和
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

的函数，我们可以将重置后的误差状态表示为一个单一函数
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\mathbf{x}^{+}=\bar{\mathbf{n}}\left(\delta\mathbf{x},\hat{\mathbf{x}}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
这允许协方差更新为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{P}^{+}=\mathbf{NPN}^{\top},\label{eq:70}
\end{equation}

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{N}=\left.\dfrac{\partial\bar{\mathbf{n}}\left(\delta\mathbf{x},\hat{\mathbf{x}}\right)}{\partial\delta\mathbf{x}}\right|_{E\left[\delta\mathbf{x}\right],\hat{\mathbf{x}}}.
\]

\end_inset


\end_layout

\begin_layout Standard
重置操作
\begin_inset Formula $\mathbf{n}\left(\mathbf{x}\right)$
\end_inset

和Jacobian矩阵
\begin_inset Formula $\mathbf{N}$
\end_inset

的详细信息在第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中针对iRN给出，并在第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:7.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中针对bRN给出。
\end_layout

\begin_layout Standard
这个公式在估计器性能方面提供了几个优点。这些优点之一是，当与相对状态相关的协方差重置为零时，不确定性本质上从滤波器中移除，并委托给后端地图，这有助于保持滤波器的
一致性(Barfoot和Furgale，2014[5])。做为结果，滤波器中的协方差也保持有界。此外，由于关键帧之间的距离相对较小，因此状态误差保持较小，从而避
免了可能导致全局估计器不一致的显著的线性化误差(Castellanos等人，2007[10])。
\end_layout

\begin_layout Standard
虽然重建全局位姿估计需要实现后端位姿图地图，但这种架构也被证明可以提高全局滤波方法的最终全局位姿估计的一致性和准确性，即使没有额外的位姿图地图约束，如回环闭合(
Wheeler等人，2018[38])。它还有一个优点是，当新的全局信息可用时，可以避免大的、潜在的破坏稳定的状态跳跃。实现这个位姿图地图的要求也不是一个特别繁
重的要求，因为一些全局滤波器方法已经使用后端批处理地图来为他们的全局滤波器提供更新(Shen等人，2014[31]；Weiss和Siegwart，2011[36
])。
\end_layout

\begin_layout Standard
算法 1 总结了实现RMEKF的各个步骤，以及对关键方程的引用。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:6"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节推导了iRN的具体实现方程，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:7"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节推导了机体固连的机器人中心相对导航的具体实现方程。
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename table2.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Section
惯性相对导航(iRN)
\begin_inset CommandInset label
LatexCommand label
name "sec:6"

\end_inset


\end_layout

\begin_layout Standard
惯性相对导航(Inertial Relative Navigation, iRN)估计车辆相对于当前节点帧的位置和姿态。当当前节点帧有规律地变化时，每个节点帧都
是重力对齐和惯性定义的。由于这个原因，GPS/INS文献中的典型无人机动力学是适用的。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节概述了系统的输入、状态和动力学，包括误差状态的动力学。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节定义了测量模型，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节概述了关键帧重置步骤。一般来说，本节中的推导改进了在先前工作中(Leishman和McLain，2014[22])推导的数学严谨性，并提供了一些更正。延伸这
项工作的新贡献在各自的章节中都有说明。
\end_layout

\begin_layout Subsection
状态动力学
\begin_inset CommandInset label
LatexCommand label
name "subsec:6.1"

\end_inset


\end_layout

\begin_layout Standard
本节导出滤波器中使用的状态传播模型。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.1.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节定义了状态向量。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.1.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节讨论了如何将来自IMU的测量纳入传播模型，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.1.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节定义了状态传播模型并推导了相关的Jacobian矩阵。
\end_layout

\begin_layout Subsubsection
状态向量
\begin_inset CommandInset label
LatexCommand label
name "subsec:6.1.1"

\end_inset


\end_layout

\begin_layout Standard
向量使用一个向前-向右-向下(forward–right–down)的坐标帧，坐标轴标记为
\begin_inset Formula $x$
\end_inset

、
\begin_inset Formula $y$
\end_inset

和
\begin_inset Formula $z$
\end_inset

。在本文中，位置向量
\begin_inset Formula $^{c}\mathbf{p}_{a}^{b}$
\end_inset

表示帧
\begin_inset Formula $b$
\end_inset

相对于帧
\begin_inset Formula $a$
\end_inset

的位置，用帧
\begin_inset Formula $c$
\end_inset

表示。除非另有说明，否则位置向量在起始帧中表示，即，帧
\begin_inset Formula $a$
\end_inset

和帧
\begin_inset Formula $c$
\end_inset

是相同的。在这种情况下，为了简洁起见，通常省略前标，因此
\begin_inset Formula $\mathbf{p}_{a}^{b}\triangleq{}^{a}\mathbf{p}_{a}^{b}$
\end_inset

。不过，为了清晰起见，有时也会包括前标。
\end_layout

\begin_layout Standard
iRN估计车辆的机体帧
\begin_inset Formula $b$
\end_inset

相对于当前节点帧
\begin_inset Formula $n$
\end_inset

的位置和姿态，并用位姿
\begin_inset Formula $\left(\mathbf{p}_{n}^{b},\mathbf{q}_{n}^{b}\right)$
\end_inset

表示。让帧
\begin_inset Formula $k$
\end_inset

表示车辆在拍摄当前关键帧图像时的机体帧。估计器跟踪
\begin_inset Formula $k$
\end_inset

相对于
\begin_inset Formula $n$
\end_inset

的位姿，并用
\begin_inset Formula $n$
\end_inset

表示，表示为
\begin_inset Formula $\left(\mathbf{p}_{n}^{k},\mathbf{q}_{n}^{k}\right)$
\end_inset

，这是对先前工作的扩展(Leishman和McLain，2014[22])。如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:02"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示，关键帧状态
\begin_inset Formula $\left(\mathbf{p}_{n}^{k},\mathbf{q}_{n}^{k}\right)$
\end_inset

包括声明关键帧时车辆的高度、横滚和俯仰。当车辆状态包含四元数元素时，它不是一个向量，因此我们将状态定义为元组
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{x}\triangleq\left(\mathbf{p}_{n}^{b},\mathbf{q}_{n}^{b},\mathbf{v},\boldsymbol{\beta}_{\boldsymbol{\omega}},\boldsymbol{\beta}_{\mathbf{a}},\mathbf{p}_{n}^{k},\mathbf{q}_{n}^{k},\mu\right)
\]

\end_inset

其中
\begin_inset Formula $\mathbf{x}\in\mathbb{R}^{3}\times\mathbb{H}\times\mathbb{R}^{3}\times\mathbb{R}^{3}\times\mathbb{R}^{3}\times\mathbb{R}^{3}\times\mathbb{H}\times\mathbb{R}$
\end_inset

，其中
\begin_inset Formula $\mathbf{v}\in\mathbb{R}^{3}$
\end_inset

是车辆在机体帧中表示的惯性速度(即
\begin_inset Formula $\mathbf{v}\triangleq{}^{b}\mathbf{v}_{\mathcal{I}}^{b}$
\end_inset

，其中
\begin_inset Formula $\mathcal{I}$
\end_inset

是一个惯性帧)，
\begin_inset Formula $\boldsymbol{\beta}_{\boldsymbol{\omega}}\in\mathbb{R}^{3}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\beta}_{\mathbf{a}}\in\mathbb{R}^{3}$
\end_inset

是陀螺仪和加速计的未知偏差，
\begin_inset Formula $\mu\in\mathbb{R}$
\end_inset

是横向阻力系数。误差状态向量
\begin_inset Formula $\delta\mathbf{x}\in\mathbb{R}^{22}$
\end_inset

被定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\mathbf{x}=\left[\begin{array}{cccccccc}
\delta\mathbf{p}_{n}^{b}{}^{\top} & \delta\boldsymbol{\theta}_{n}^{b}{}^{\boldsymbol{\top}} & \delta\mathbf{v}^{\boldsymbol{\top}} & \delta\boldsymbol{\beta}_{\boldsymbol{\omega}}{}^{\top} & \delta\boldsymbol{\beta}_{\mathbf{a}}{}^{\top} & \delta\mathbf{p}_{n}^{k}{}^{\top} & \delta\boldsymbol{\theta}_{n}^{k}{}^{\top} & \delta\mu\end{array}\right]^{\top}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
机械化
\begin_inset CommandInset label
LatexCommand label
name "subsec:6.1.2"

\end_inset


\end_layout

\begin_layout Standard
设
\begin_inset Formula $\boldsymbol{\omega}\triangleq{}^{b}\boldsymbol{\omega}_{\mathcal{I}}^{b}$
\end_inset

和
\begin_inset Formula $\mathbf{a}\triangleq{}^{b}\mathbf{a}_{\mathcal{I}}^{b}$
\end_inset

分别定义由理想IMU测量的真实机体固连角速度和加速度。为了简洁起见，我们省略了指定帧，并在整篇文章中使用
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

和
\begin_inset Formula $\mathbf{a}$
\end_inset

。
\end_layout

\begin_layout Standard
一个IMU提供的测量值
\begin_inset Formula $\tilde{\boldsymbol{\omega}}$
\end_inset

和
\begin_inset Formula $\tilde{\mathbf{a}}$
\end_inset

被未知的偏差
\begin_inset Formula $\boldsymbol{\beta}_{\boldsymbol{\omega}}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\beta}_{\mathbf{a}}$
\end_inset

以及零均值高斯噪声过程
\begin_inset Formula $\boldsymbol{\nu}_{\boldsymbol{\omega}}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\nu}_{\mathbf{a}}$
\end_inset

所破坏，因此测量值可以建模为
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
\tilde{\boldsymbol{\omega}} & =\boldsymbol{\omega}+\boldsymbol{\beta}_{\omega}+\boldsymbol{\nu}_{\boldsymbol{\omega}}\nonumber \\
\tilde{\mathbf{a}} & =\mathbf{a}+\boldsymbol{\beta}_{\mathbf{a}}+\boldsymbol{\nu}_{\mathbf{a}}.\label{eq:71a}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
认识到实际测量值
\begin_inset Formula $\tilde{\boldsymbol{\omega}}$
\end_inset

和
\begin_inset Formula $\tilde{\mathbf{a}}$
\end_inset

在给定的时间步长是固定的，并且噪声项在时间上被认为是不相关的，未知真值被建模为随机变量，如下所示：
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
\boldsymbol{\omega} & =\tilde{\boldsymbol{\omega}}-\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\nu}_{\boldsymbol{\omega}}\label{eq:72a}\\
\mathbf{a} & =\tilde{\mathbf{a}}-\boldsymbol{\beta}_{\mathbf{a}}-\boldsymbol{\nu}_{\mathbf{a}},\label{eq:72b}
\end{align}

\end_inset


\end_layout

\end_inset

其中，
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

、
\begin_inset Formula $\mathbf{a}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\beta}_{\boldsymbol{\omega}}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\beta}_{\mathbf{a}}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\nu}_{\boldsymbol{\omega}}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\nu}_{\mathbf{a}}$
\end_inset

为随机变量，
\begin_inset Formula $\tilde{\boldsymbol{\omega}}$
\end_inset

和
\begin_inset Formula $\tilde{\mathbf{a}}$
\end_inset

被认为是常数。用于传播的角速度的标称值就是真实角速度的期望值
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\hat{\boldsymbol{\omega}} & \triangleq E\left[\boldsymbol{\omega}\right]\nonumber \\
 & =E\left[\tilde{\boldsymbol{\omega}}-\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\nu}_{\boldsymbol{\omega}}\right]\nonumber \\
 & =\tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}},\label{eq:73}
\end{align}

\end_inset

并且用于传播的加速度的标称值就是真实加速度的期望值
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\hat{\mathbf{a}} & \triangleq E\left[\mathbf{a}\right]\nonumber \\
 & =E\left[\tilde{\mathbf{a}}-\boldsymbol{\beta}_{\mathbf{a}}-\boldsymbol{\nu}_{\mathbf{a}}\right]\nonumber \\
 & =\tilde{\mathbf{a}}-\hat{\boldsymbol{\beta}}_{\mathbf{a}}.\label{eq:74}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
IMU数据可以做为一个系统输入，也可以做为一个测量，这是基于IMU质量和模型精度的权衡。当一个可靠的车辆模型可用时，控制器的输出(例如，电机指令)可以做为观测器
的输入，从而向前传播状态。在这种情况下，IMU数据做为提供反馈的测量更新被纳入。这种方法利用的信息最多，但需要仔细描述车辆的动力学特性。另一种常见的方法称为
\series bold
机械化
\series default
(
\emph on
mechanization
\emph default
)，它将IMU测量值直接做为滤波器动力学的输入，用运动学方程代替车辆特定动力学。这简化了传播动力学并消除了对建模错误的敏感性，但没有使用关于车辆行为方式的任何信
息。
\end_layout

\begin_layout Standard
在本文的滤波器设计中，将速率陀螺
\begin_inset Formula $\tilde{\boldsymbol{\omega}}$
\end_inset

测得的角速度做为传播方程的输入。根据Leishman等人(2014a)的做法[21]，加速计测量的
\begin_inset Formula $z$
\end_inset

分量也被视为输入，而
\begin_inset Formula $x$
\end_inset

和
\begin_inset Formula $y$
\end_inset

分量被用作测量更新。以下段落解释了这种方法的推导和理由。
\end_layout

\begin_layout Standard
利用牛顿第二定律，可以将速度动力学建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{v}}=\left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}+\dfrac{1}{m}\sum{}^{\mathcal{B}}\mathbf{F},\label{eq:75}
\end{equation}

\end_inset

其中
\begin_inset Formula $m$
\end_inset

是车辆质量，
\begin_inset Formula $^{\mathcal{B}}\mathbf{F}$
\end_inset

是作用在车辆上的外力，以机体帧表示。如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:06"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示，作用在多旋翼飞行器上的主要外力为重力
\begin_inset Formula $^{\mathcal{B}}\mathbf{F}_{G}=m\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{g}$
\end_inset

、推力
\begin_inset Formula $^{\mathcal{B}}\mathbf{F}_{T}=T\mathbf{k}$
\end_inset

和简化阻力
\begin_inset Formula $^{\mathcal{B}}\mathbf{F}_{D}=-\mu_{0}\mathbf{v}$
\end_inset

，其中
\begin_inset Formula $\mathbf{k}\triangleq\left[\begin{array}{ccc}
0 & 0 & 1\end{array}\right]^{\mathrm{T}}$
\end_inset

，
\begin_inset Formula $T$
\end_inset

是旋翼总推力，
\begin_inset Formula $\mu_{0}$
\end_inset

是标称阻力系数，并且
\begin_inset Formula $\mathbf{g}=g\mathbf{k}$
\end_inset

，
\begin_inset Formula $g$
\end_inset

是重力引起的标准加速度。将这些力外代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:75"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\dot{\mathbf{v}} & =\left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}+\dfrac{1}{m}\left(^{\mathcal{B}}\mathbf{F}_{G}+{}^{\mathcal{B}}\mathbf{F}_{T}+{}^{\mathcal{B}}\mathbf{F}_{D}\right)\nonumber \\
 & =\left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}+\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{g}+\dfrac{T}{m}\mathbf{k}-\dfrac{\mu_{0}}{m}\mathbf{v}.\label{eq:76}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig05.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:05"

\end_inset

从侧面看关键帧重置操作的图示：(a)当声明关键帧时，
\begin_inset Formula $\mathbf{p}_{n}^{k}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{n}^{k}$
\end_inset

对车辆的横滚、俯仰和高度进行编码；(b)重置后，关键帧和机体状态相同。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig06.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:06"

\end_inset

描述作用在多旋翼上的外力的自由机体图。主要作用力为重力
\begin_inset Formula $\mathbf{F}_{G}$
\end_inset

、推力
\begin_inset Formula $\mathbf{F}_{T}$
\end_inset

和阻力
\begin_inset Formula $\mathbf{F}_{D}$
\end_inset

。向量
\begin_inset Formula $\mathbf{v}$
\end_inset

表示车辆的速度，
\begin_inset Formula $\mathbf{g}$
\end_inset

表示重力向量。重力作用于重力方向，推力作用于垂直于旋翼平面的方向，简化阻力作用于与速度向量相反的方向。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
虽然在技术上是正确的，但方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:76"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的动力学在实践中具有挑战性，因为推力
\begin_inset Formula $T$
\end_inset

很难建模，因此通常是未知的。这个困难是通过机械化来解决的，即直接利用传播模型中的加速计测量值。正如Leishman等人(2014a)[21]所解释的，加速计测量
是在机体帧中表达的比力(不包括重力)，因此
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{a} & =\dfrac{1}{m}\sum{}^{\mathcal{B}}\mathbf{F}-{}^{\mathcal{B}}\mathbf{F}_{G}\nonumber \\
 & =\dfrac{1}{m}\left(^{\mathcal{B}}\mathbf{F}_{T}+{}^{\mathcal{B}}\mathbf{F}_{D}\right)\nonumber \\
 & =\dfrac{T}{m}\mathbf{k}-\dfrac{\mu_{0}}{m}\mathbf{v}.\label{eq:77}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:77"
plural "false"
caps "false"
noprefix "false"

\end_inset

)代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:76"
plural "false"
caps "false"
noprefix "false"

\end_inset

)得到常见的机械化动力学
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{v}}=\left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}+\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{g}+\mathbf{a}.\label{eq:78}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:78"
plural "false"
caps "false"
noprefix "false"

\end_inset

)消除了对复杂的车辆动力学建模的需要，但忽略了动力学信息，该信息可能通过在协方差矩阵
\begin_inset Formula $\mathbf{P}$
\end_inset

中建立互相关项来提高估计器性能。
\end_layout

\begin_layout Standard
在实践中，我们发现使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:76"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:78"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的组合最为成功。注意到方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:76"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的未知推力项只出现在
\begin_inset Formula $z$
\end_inset

分量中，通过将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:77"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的
\begin_inset Formula $z$
\end_inset

分量代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:76"
plural "false"
caps "false"
noprefix "false"

\end_inset

)以获得混合传播模型
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{v}}=\left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}+\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{g}+a_{z}\mathbf{k}-\mu\boldsymbol{\Pi}_{\mathbf{k}}\mathbf{v},\label{eq:79}
\end{equation}

\end_inset

其中
\begin_inset Formula $a_{z}=\mathbf{k}^{\top}\mathbf{a}$
\end_inset

，
\begin_inset Formula $\mu\triangleq\mu_{0}/m$
\end_inset

是比阻力系数，并且
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{\Pi}_{\mathbf{k}}\triangleq\mathbf{I}-\mathbf{k}\mathbf{k}^{\top}
\]

\end_inset

是一个投影矩阵，投射到
\begin_inset Formula $\mathbf{k}$
\end_inset

轴法线的平面上。
\end_layout

\begin_layout Standard
做为这种混合方法的结果，我们考虑将陀螺仪和
\begin_inset Formula $z$
\end_inset

轴加速计测量做为系统输入，同时使用水平加速计测量做为更新步骤中的反馈。因此，系统输入和输入噪声定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{u}=\left[\begin{array}{c}
\tilde{\boldsymbol{\omega}}\\
\tilde{a}_{z}
\end{array}\right],\quad\boldsymbol{\nu}=\left[\begin{array}{l}
\boldsymbol{\nu}_{\boldsymbol{\omega}}\\
\nu_{\mathbf{a}_{z}}
\end{array}\right],
\]

\end_inset

其中
\begin_inset Formula $\tilde{a}_{z}=\mathbf{k}^{\top}\tilde{\mathbf{a}}$
\end_inset

和
\begin_inset Formula $\nu_{\mathbf{a}_{z}}=\mathbf{k}^{\top}\boldsymbol{\nu}_{\mathbf{a}}$
\end_inset

。
\end_layout

\begin_layout Subsubsection
传播模型
\begin_inset CommandInset label
LatexCommand label
name "subsec:6.1.3"

\end_inset


\end_layout

\begin_layout Standard
系统动力学建模为
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:80"

\end_inset


\begin_inset Formula 
\begin{align}
\dot{\mathbf{p}}_{n}^{b} & =\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{b}\right)\mathbf{v}\label{eq:80a}\\
\dot{\mathbf{q}}_{n}^{b} & =\dfrac{1}{2}\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\label{eq:80b}\\
\dot{\mathbf{v}} & =\left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}+\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{g}+a_{z}\mathbf{k}-\mu\boldsymbol{\Pi}_{\mathbf{k}}\mathbf{v}+\boldsymbol{\eta}_{\mathbf{v}}\label{eq:80c}\\
\dot{\boldsymbol{\beta}}_{\boldsymbol{\omega}} & =\boldsymbol{\eta}_{\boldsymbol{\beta}_{\boldsymbol{\omega}}}\nonumber \\
\dot{\boldsymbol{\beta}}_{\mathbf{a}} & =\boldsymbol{\eta}_{\boldsymbol{\beta}_{\mathbf{a}}}\nonumber \\
\dot{\mathbf{p}}_{n}^{k} & =\mathbf{0}\nonumber \\
\dot{\mathbf{q}}_{n}^{k} & =\mathbf{0}\nonumber \\
\dot{\mu} & =0,\nonumber 
\end{align}

\end_inset


\end_layout

\end_inset

其中
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:72a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)给出，
\begin_inset Formula $a_{z}$
\end_inset

由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:72b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的
\begin_inset Formula $z$
\end_inset

分量给出，
\begin_inset Formula $\boldsymbol{\eta}_{\mathbf{v}}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\eta}_{\boldsymbol{\beta}_{\boldsymbol{\omega}}}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\eta}_{\boldsymbol{\beta}_{\mathbf{a}}}$
\end_inset

是对应状态的零均值高斯噪声过程。状态
\begin_inset Formula $\mathbf{p}_{n}^{b}$
\end_inset

根据标准运动学模型传播，
\begin_inset Formula $\mathbf{q}_{n}^{b}$
\end_inset

根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:3.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节的讨论传播，
\begin_inset Formula $\mathbf{v}$
\end_inset

根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:79"
plural "false"
caps "false"
noprefix "false"

\end_inset

)传播。偏差状态
\begin_inset Formula $\boldsymbol{\beta}_{\boldsymbol{\omega}}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\beta}_{\mathbf{a}}$
\end_inset

的动力学模型为随机游走，而关键帧状态
\begin_inset Formula $\mathbf{p}_{n}^{k}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{n}^{k}$
\end_inset

表示静态坐标帧的相对位姿，因此不发生变化。阻力项
\begin_inset Formula $\mu$
\end_inset

是常数，因此具有零动态性，但这种状态下的不确定性通过赋予其非零初始协方差来考虑。
\end_layout

\begin_layout Standard
状态估计通过将状态、输入和过程噪声项的期望值代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:80"
plural "false"
caps "false"
noprefix "false"

\end_inset

)来传播，为
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:81"

\end_inset


\begin_inset Formula 
\begin{align}
\dot{\mathbf{p}}_{n}^{b} & =\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\hat{\mathbf{v}}\nonumber \\
\dot{\hat{\mathbf{q}}}_{n}^{b} & =\dfrac{1}{2}\hat{\mathbf{q}}_{n}^{b}\otimes\left[\begin{array}{c}
\hat{\boldsymbol{\omega}}\\
0
\end{array}\right]\label{eq:81a}\\
\dot{\hat{\mathbf{v}}} & =\left\lfloor \hat{\mathbf{v}}\right\rfloor \hat{\boldsymbol{\omega}}+\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}+\hat{a}_{z}\mathbf{k}-\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\nonumber \\
\dot{\hat{\boldsymbol{\beta}}}_{\boldsymbol{\omega}} & =\mathbf{0}\nonumber \\
\dot{\hat{\boldsymbol{\beta}}}_{\mathbf{a}} & =\mathbf{0}\nonumber \\
\dot{\hat{\mathbf{p}}}_{n}^{k} & =\mathbf{0}\nonumber \\
\dot{\hat{\mathbf{q}}}_{n}^{k} & =\mathbf{0}\nonumber \\
\dot{\hat{\mu}} & =0,\nonumber 
\end{align}

\end_inset


\end_layout

\end_inset

其中
\begin_inset Formula $\hat{\boldsymbol{\omega}}$
\end_inset

由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:73"
plural "false"
caps "false"
noprefix "false"

\end_inset

)给出，
\begin_inset Formula $\hat{a}_{z}$
\end_inset

由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:74"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的
\begin_inset Formula $z$
\end_inset

分量给出。
\end_layout

\begin_layout Standard
通过使用误差状态定义方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44"
plural "false"
caps "false"
noprefix "false"

\end_inset

)将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:80"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:81"
plural "false"
caps "false"
noprefix "false"

\end_inset

)联系起来找到误差状态动力学。误差状态动力学的一阶近似值为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{p}}_{n}^{b} & \approx-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\delta\mathbf{v}\\
\delta\dot{\boldsymbol{\theta}}_{n}^{b} & \approx-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}-\delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\nu}_{\boldsymbol{\omega}}\\
\delta\dot{\mathbf{v}} & \approx\left\lfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}+\left(-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor -\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\right)\delta\mathbf{v}\\
 & \quad-\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\mathbf{k}\mathbf{k}^{\top}\delta\boldsymbol{\beta}_{\mathbf{a}}-\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\delta\mu\\
 & \quad-\left\lfloor \hat{\mathbf{v}}\right\rfloor \boldsymbol{\nu}_{\boldsymbol{\omega}}-\mathbf{k}\eta_{\mathbf{a}_{z}}+\boldsymbol{\eta}_{\mathbf{v}}\\
\delta\dot{\boldsymbol{\beta}}_{\boldsymbol{\omega}} & =\boldsymbol{\eta}_{\boldsymbol{\beta}_{\boldsymbol{\omega}}}\\
\delta\dot{\boldsymbol{\boldsymbol{\beta}}}_{\mathbf{a}} & =\boldsymbol{\eta}_{\boldsymbol{\beta}_{\mathbf{a}}}\\
\delta\dot{\mathbf{p}}_{n}^{k} & =\mathbf{0}\\
\delta\dot{\boldsymbol{\theta}}_{n}^{k} & =\mathbf{0}\\
\delta\dot{\mu} & =0
\end{aligned}
\]

\end_inset

并在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:C"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中推导。将误差状态动力学相对于误差状态和输入噪声微分，得到以下传播Jacobian矩阵：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{F}=\left[\begin{array}{cccccccc}
\mathbf{0} & -\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \hat{\mathbf{v}}\right\rfloor  & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right) & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & -\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor  & \mathbf{0} & -\mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \left\lfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}\right\rfloor  & -\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor -\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}} & -\left\lfloor \hat{\mathbf{v}}\right\rfloor  & -\mathbf{k}\mathbf{k}^{\top} & \mathbf{0} & \mathbf{0} & -\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & 0
\end{array}\right]
\]

\end_inset

并且
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{G}=\left[\begin{array}{cc}
\mathbf{0} & \mathbf{0}\\
\multicolumn{1}{c}{-\mathbf{I}} & \mathbf{0}\\
\multicolumn{1}{c}{-\left\lfloor \hat{\mathbf{v}}\right\rfloor } & -\mathbf{k}\\
\multicolumn{1}{c}{\mathbf{0}} & \mathbf{0}\\
\multicolumn{1}{c}{\mathbf{0}} & \mathbf{0}\\
\multicolumn{1}{c}{\mathbf{0}} & \mathbf{0}\\
\multicolumn{1}{c}{\mathbf{0}} & \mathbf{0}\\
\multicolumn{1}{c}{\mathbf{0}} & 0
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Subsection
测量模型
\begin_inset CommandInset label
LatexCommand label
name "subsec:6.2"

\end_inset


\end_layout

\begin_layout Standard
加速计、高度计和视觉里程计或激光扫描匹配算法提供测量值以约束状态估计。对于每个传感器，定义了测量模型、残差模型和残差Jacobian矩阵。
\end_layout

\begin_layout Subsubsection
加速计
\begin_inset CommandInset label
LatexCommand label
name "subsec:6.2.1"

\end_inset


\end_layout

\begin_layout Standard
因为加速计测量的
\begin_inset Formula $z$
\end_inset

部分被用作传播的输入，所以更新步骤仅使用
\begin_inset Formula $\tilde{\mathbf{a}}$
\end_inset

的
\begin_inset Formula $x$
\end_inset

和
\begin_inset Formula $y$
\end_inset

分量，因此
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{z}_{\mathrm{acc}}=\mathbf{I}_{2\times3}\tilde{\mathbf{a}}.
\]

\end_inset


\end_layout

\begin_layout Standard
加速计测量模型可由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:71a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:77"
plural "false"
caps "false"
noprefix "false"

\end_inset

)导出，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{h}_{\mathrm{acc}}\left(\mathbf{x},\mathbf{u}+\boldsymbol{\nu}\right) & =\mathbf{I}_{2\times3}\left(\mathbf{a}+\boldsymbol{\beta}_{\mathbf{a}}+\boldsymbol{\nu}_{\mathbf{a}}\right)\nonumber \\
 & =\mathbf{I}_{2\times3}\left(\dfrac{T}{m}\mathbf{k}-\dfrac{\mu_{0}}{m}\mathbf{v}+\boldsymbol{\beta}_{\mathbf{a}}+\boldsymbol{\nu}_{\mathbf{a}}\right)\nonumber \\
 & =\mathbf{I}_{2\times3}\left(-\mu\mathbf{v}+\boldsymbol{\beta}_{\mathbf{a}}+\boldsymbol{\nu}_{\mathbf{a}}\right),\label{eq:82}
\end{align}

\end_inset

其中推力项
\begin_inset Formula $\dfrac{T}{m}\mathbf{k}$
\end_inset

因
\begin_inset Formula $\mathbf{I}_{2\times3}\dfrac{T}{m}\mathbf{k}=0$
\end_inset

而消掉，我们可以根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44"
plural "false"
caps "false"
noprefix "false"

\end_inset

)用
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

和
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

展开该模型，并消掉二阶项
\begin_inset Foot
status open

\begin_layout Plain Layout
因为Jacobian矩阵是在
\begin_inset Formula $\delta\mathbf{x}=\boldsymbol{\nu}=\mathbf{0}$
\end_inset

时评估的，所以这些变量中的任何二阶项都将消失。我们利用这一事实来简化推导，在前面消掉这些二阶项。
\end_layout

\end_inset

，得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{acc}}\left(\mathbf{x},\mathbf{u}+\boldsymbol{\nu}\right) & =\mathbf{I}_{2\times3}\left(-\left(\hat{\mu}+\delta\mu\right)\left(\hat{\mathbf{v}}+\delta\mathbf{v}\right)+\hat{\boldsymbol{\beta}}_{\mathbf{a}}+\delta\boldsymbol{\beta}_{\mathbf{a}}+\boldsymbol{\nu}_{\mathbf{a}}\right)\\
 & \approx\mathbf{I}_{2\times3}\left(-\hat{\mu}\hat{\mathbf{v}}-\hat{\mu}\delta\mathbf{v}-\delta\mu\hat{\mathbf{v}}+\hat{\boldsymbol{\beta}}_{\mathbf{a}}+\delta\boldsymbol{\beta}_{\mathbf{a}}+\boldsymbol{\nu}_{\mathbf{a}}\right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:82"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，估计测量值为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{h}_{\mathrm{acc}}\left(\hat{\mathbf{x}},\mathbf{u}\right)=\mathbf{I}_{2\times3}\left(-\hat{\mu}\hat{\mathbf{v}}+\hat{\boldsymbol{\beta}}_{\mathbf{a}}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
对于给定的加速度测量值
\begin_inset Formula $\mathbf{z}_{\mathrm{acc}}$
\end_inset

，残差为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}_{\mathrm{acc}}=\mathbf{z}_{\mathrm{acc}}-\mathbf{h}_{\mathrm{acc}}\left(\hat{\mathbf{x}},\mathbf{u}\right),
\]

\end_inset

并被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{\mathrm{acc}} & =\mathbf{h}_{\mathrm{acc}}\left(\mathbf{x},\mathbf{u}+\boldsymbol{\nu}\right)-\mathbf{h}_{\mathrm{acc}}\left(\hat{\mathbf{x}},\mathbf{u}\right)\\
 & =\mathbf{I}_{2\times3}\left(-\hat{\mu}\delta\mathbf{v}-\hat{\mathbf{v}}\delta\mu+\delta\boldsymbol{\beta}_{\mathbf{a}}+\boldsymbol{\nu}_{\mathbf{a}}\right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
因此，测量Jacobian矩阵为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{acc}}=\mathbf{I}_{2\times3}\left[\begin{array}{cccccccc}
\mathbf{0} & \mathbf{0} & -\hat{\mu}\mathbf{I} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & -\hat{\mathbf{v}}\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
测量噪声是加速计噪声的
\begin_inset Formula $x$
\end_inset

和
\begin_inset Formula $y$
\end_inset

分量，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{R}_{\mathrm{acc}}=\mathbf{I}_{2\times3}E\left[\boldsymbol{\nu}_{\mathbf{a}}\boldsymbol{\nu}_{\mathbf{a}}^{\mathrm{T}}\right]\mathbf{I}_{2\times3}^{\top}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
高度计
\begin_inset CommandInset label
LatexCommand label
name "subsec:6.2.2"

\end_inset


\end_layout

\begin_layout Standard
高度计模型适用于超声波测距仪，它报告的是其圆锥视场中最近的回波。因此，只要横滚角和俯仰角适中，无论车辆当前的姿态如何，传感器都会报告距地高度。测量模型和它的估计
是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}h_{\mathrm{alt}}\left(\mathbf{x}\right) & =-\mathbf{k}^{\top}\mathbf{p}_{n}^{b}+\eta_{\mathrm{alt}}\\
h_{\mathrm{alt}}\left(\hat{\mathbf{x}}\right) & =-\mathbf{k}^{\top}\hat{\mathbf{p}}_{n}^{b}.
\end{aligned}
\label{eq:83}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
对于给定的高度计测量值
\begin_inset Formula $z_{\mathrm{alt}}$
\end_inset

，残差为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
r_{\mathrm{alt}}=z_{\mathrm{alt}}-h_{\mathrm{alt}}\left(\hat{\mathbf{x}}\right),
\]

\end_inset

其被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}r_{\mathrm{alt}} & =h_{\mathrm{alt}}\left(\mathbf{x}\right)-h_{\mathrm{alt}}\left(\hat{\mathbf{x}}\right)\\
 & =-\mathbf{k}^{\top}\mathbf{p}_{n}^{b}+\eta_{\mathrm{alt}}+\mathbf{k}^{\top}\hat{\mathbf{p}}_{n}^{b}\\
 & =-\mathbf{k}^{\top}\delta\mathbf{p}_{n}^{b}+\eta_{\mathrm{alt}}
\end{aligned}
\]

\end_inset

导致测量Jacobian矩阵为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{alt}}=\left[\begin{array}{cccccccc}
-\mathbf{k}^{\top} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Subsubsection
视觉里程计变换
\end_layout

\begin_layout Standard
与以前的测量模型相比，纳入视觉里程算法的测量要复杂得多。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:07"
plural "false"
caps "false"
noprefix "false"

\end_inset

 概述了视觉里程计输出和状态之间的关系。视觉里程计输出
\begin_inset Formula $\left(\mathbf{p}_{kc}^{c},\mathbf{q}_{kc}^{c}\right)$
\end_inset

将当前相机帧与关键帧的相机帧相关联。变换
\begin_inset Formula $\left(\mathbf{p}_{b}^{c},\mathbf{q}_{b}^{c}\right)$
\end_inset

表示相机帧相对于车辆质心的位姿。通常，视觉里程算法中使用的相机帧是从图像平面导出的，这样相机帧的
\begin_inset Formula $z$
\end_inset

轴参考向前运动(深度)。在这种情况下，
\begin_inset Formula $\mathbf{q}_{b}^{c}$
\end_inset

对从机体帧的向前-向右-向下(forward–right–down)坐标帧到相机使用的坐标帧的映射进行编码。如Leishman和McLain(2014)[22]
所述，变换
\begin_inset Formula $\left(\mathbf{p}_{b}^{c},\mathbf{q}_{b}^{c}\right)$
\end_inset

可以通过离线校准或在线校准找到。在本文中，我们假设相机是刚性地安装在机体上，并且
\begin_inset Formula $\left(\mathbf{p}_{b}^{c},\mathbf{q}_{b}^{c}\right)$
\end_inset

是静态的和已知的。另外，因为
\begin_inset Formula $\left(\mathbf{p}_{k}^{kc},\mathbf{q}_{k}^{kc}\right)$
\end_inset

也表示机体和相机之间的变换，但是在关键帧时刻，
\begin_inset Formula $\mathbf{p}_{k}^{kc}=\mathbf{p}_{b}^{c}$
\end_inset

并且
\begin_inset Formula $\mathbf{q}_{k}^{kc}=\mathbf{q}_{b}^{c}$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig07.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:07"

\end_inset

与iRN视觉里程测量模型相关的变换。变换
\begin_inset Formula $\left(\mathbf{p}_{kc}^{c},\mathbf{q}_{kc}^{c}\right)$
\end_inset

是视觉里程算法的输出。变换
\begin_inset Formula $\left(\mathbf{p}_{b}^{c},\mathbf{q}_{b}^{c}\right)$
\end_inset

定义了相机帧相对于车辆质心的位姿，并假定是固定的和已知的。帧
\begin_inset Formula $k$
\end_inset

表示关键帧时刻机体的位姿，帧
\begin_inset Formula $kc$
\end_inset

表示相机当时的位姿。因此，
\begin_inset Formula $\mathbf{p}_{k}^{kc}=\mathbf{p}_{b}^{c}$
\end_inset

并且
\begin_inset Formula $\mathbf{q}_{k}^{kc}=\mathbf{q}_{b}^{c}$
\end_inset

。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:07"
plural "false"
caps "false"
noprefix "false"

\end_inset

 可以用来非正式地理解定义相对状态如何提高可观测性。位姿
\begin_inset Formula $\left(\mathbf{p}_{n}^{k},\mathbf{q}_{n}^{k}\right)$
\end_inset

编码关键帧声明时车辆的横滚、俯仰和高度，所有这些都可以通过高度计和IMU观测到。这一事实，与假设
\begin_inset Formula $\left(\mathbf{p}_{b}^{c},\mathbf{q}_{b}^{c}\right)$
\end_inset

是已知的相关，确保了测量
\begin_inset Formula $\left(\mathbf{p}_{kc}^{c},\mathbf{q}_{kc}^{c}\right)$
\end_inset

约束车辆的当前位姿
\begin_inset Formula $\left(\mathbf{p}_{n}^{b},\mathbf{q}_{n}^{b}\right)$
\end_inset

。
\end_layout

\begin_layout Standard
使用图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:07"
plural "false"
caps "false"
noprefix "false"

\end_inset

，相对变换测量被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right) & =\,{}^{kc}\mathbf{p}_{kc}^{c}+\boldsymbol{\eta}_{\mathrm{vot}}\\
 & =-\,{}^{kc}\mathbf{p}_{k}^{kc}-{}^{kc}\mathbf{p}_{n}^{k}+{}^{kc}\mathbf{p}_{n}^{b}+{}^{kc}\mathbf{p}_{b}^{c}+\boldsymbol{\eta}_{\mathrm{vot}}\\
 & =-\mathbf{R}\left(\mathbf{q}_{k}^{kc}\right)\,{}^{k}\mathbf{p}_{k}^{kc}\\
 & \ -\mathbf{R}\left(\mathbf{q}_{k}^{kc}\right)\mathbf{R}\left(\mathbf{q}_{n}^{k}\right)\,{}^{n}\mathbf{p}_{n}^{k}+\mathbf{R}\left(\mathbf{q}_{k}^{kc}\right)\mathbf{R}\left(\mathbf{q}_{n}^{k}\right)\,{}^{n}\mathbf{p}_{n}^{b}\\
 & \ +\mathbf{R}\left(\mathbf{q}_{k}^{kc}\right)\mathbf{R}\left(\mathbf{q}_{n}^{k}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{b}\right)\,{}^{b}\mathbf{p}_{b}^{c}+\boldsymbol{\eta}_{\mathrm{vot}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
抛开标号，回顾一下
\begin_inset Formula $\mathbf{p}_{k}^{kc}=\mathbf{p}_{b}^{c}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{k}^{kc}=\mathbf{q}_{b}^{c}$
\end_inset

，这就变成了
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)= & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{p}_{b}^{c}\nonumber \\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\mathbf{q}_{n}^{k}\right)\left(\mathbf{p}_{n}^{b}-\mathbf{p}_{n}^{k}\right)\nonumber \\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\mathbf{q}_{n}^{k}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{b}\right)\mathbf{p}_{b}^{c}+\boldsymbol{\eta}_{\mathrm{vot}}.\label{eq:84}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
我们根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开这个模型，然后用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:33"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:34"
plural "false"
caps "false"
noprefix "false"

\end_inset

)获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)= & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{p}_{b}^{c}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\delta\mathbf{q}_{n}^{k}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\hat{\mathbf{p}}_{n}^{b}+\delta\mathbf{p}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}-\delta\mathbf{p}_{n}^{k}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\delta\mathbf{q}_{n}^{k}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{R}^{\top}\left(\delta\mathbf{q}_{n}^{b}\right)\mathbf{p}_{b}^{c}+\boldsymbol{\eta}_{\mathrm{vot}}\\
\approx & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{p}_{b}^{c}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{n}^{k}\right\rfloor \right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\hat{\mathbf{p}}_{n}^{b}+\delta\mathbf{p}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}-\delta\mathbf{p}_{n}^{k}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{n}^{k}\right\rfloor \right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left(\mathbf{I}+\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \right)\mathbf{p}_{b}^{c}\\
 & +\boldsymbol{\eta}_{\mathrm{vot}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
展开并删除二阶项，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)\approx & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{p}_{b}^{c}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\hat{\mathbf{p}}_{n}^{b}+\delta\mathbf{p}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}-\delta\mathbf{p}_{n}^{k}\right)\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{k}\right\rfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\hat{\mathbf{p}}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{p}_{b}^{c}\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{k}\right\rfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{p}_{b}^{c}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \mathbf{p}_{b}^{c}+\boldsymbol{\eta}_{\mathrm{vot}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
估计的测量模型是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vot}}\left(\hat{\mathbf{x}}\right)= & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{p}_{b}^{c}+\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\hat{\mathbf{p}}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{p}_{b}^{c}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
对于给定的相对位置测量
\begin_inset Formula $\mathbf{z}_{\mathrm{vot}}$
\end_inset

，残差为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}_{\mathrm{vot}}=\mathbf{z}_{\mathrm{vot}}-\mathbf{h}_{\mathrm{vot}}\left(\hat{\mathbf{x}}\right),
\]

\end_inset

其被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{\mathrm{vot}}= & \mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)-\mathbf{h}_{\mathrm{vot}}\left(\hat{\mathbf{x}}\right)\\
= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\delta\mathbf{p}_{n}^{b}-\delta\mathbf{p}_{n}^{k}\right)\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{k}\right\rfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\hat{\mathbf{p}}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}\right)\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{k}\right\rfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{p}_{b}^{c}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \mathbf{p}_{b}^{c}+\boldsymbol{\eta}_{\mathrm{vot}}\\
= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\delta\mathbf{p}_{n}^{b}-\delta\mathbf{p}_{n}^{k}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\hat{\mathbf{p}}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}\right)\right\rfloor \delta\boldsymbol{\theta}_{n}^{k}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{p}_{b}^{c}\right\rfloor \delta\boldsymbol{\theta}_{n}^{k}\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \mathbf{p}_{b}^{c}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}+\boldsymbol{\eta}_{\mathrm{vot}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
通过微分，我们获得了残差Jacobian矩阵
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{vot}}=\left[\begin{array}{cccccccc}
\mathbf{H}_{1} & \mathbf{H}_{2} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{H}_{3} & \mathbf{H}_{4} & \mathbf{0}\end{array}\right],
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{H}_{1} & =\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right),\\
\mathbf{H}_{2} & =-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \mathbf{p}_{b}^{c}\right\rfloor ,\\
\mathbf{H}_{3} & =-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right),\\
\mathbf{H}_{4} & =\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\hat{\mathbf{p}}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{p}_{b}^{c}\right)\right\rfloor .
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
视觉里程表旋转
\end_layout

\begin_layout Standard
相对旋转测量模型也由图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:07"
plural "false"
caps "false"
noprefix "false"

\end_inset

 得出。具体来说，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{h}_{\mathrm{vor}}\left(\mathbf{x}\right) & =\mathbf{q}_{kc}^{c}\nonumber \\
 & =\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\mathbf{q}_{n}^{k}\right)^{-1}\otimes\mathbf{q}_{n}^{b}\otimes\mathbf{q}_{b}^{c}\otimes\left(\boldsymbol{\eta}_{\mathrm{vor}}\right)^{\wedge}.\label{eq:85}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
我们根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)将其扩展为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vor}}\left(\mathbf{x}\right) & =\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\otimes\delta\mathbf{q}_{n}^{k}\right)^{-1}\otimes\hat{\mathbf{q}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}\otimes\mathbf{q}_{b}^{c}\otimes\left(\boldsymbol{\eta}_{\mathrm{vor}}\right)^{\wedge}\\
 & =\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\delta\mathbf{q}_{n}^{k}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\right)^{-1}\otimes\hat{\mathbf{q}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}\otimes\mathbf{q}_{b}^{c}\otimes\left(\boldsymbol{\eta}_{\mathrm{vor}}\right)^{\wedge}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
估计的测量模型是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{h}_{\mathrm{vor}}\left(\hat{\mathbf{x}}\right)=\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\right)^{-1}\otimes\hat{\mathbf{q}}_{n}^{b}\otimes\mathbf{q}_{b}^{c}.
\]

\end_inset


\end_layout

\begin_layout Standard
对于
\begin_inset Formula $\mathbf{z}_{\mathrm{vor}}$
\end_inset

，从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:64"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，残差被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}_{\mathrm{vor}}=\left(\mathbf{h}_{\mathrm{vor}}\left(\hat{\mathbf{x}}\right)^{-1}\otimes\mathbf{z}_{\mathrm{vor}}\right)^{\vee},
\]

\end_inset

其已被建模，然后用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:41"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:42"
plural "false"
caps "false"
noprefix "false"

\end_inset

)简化为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{\mathrm{vor}}= & \left(\mathbf{h}_{\mathrm{vor}}\left(\hat{\mathbf{x}}\right)^{-1}\otimes\mathbf{h}_{\mathrm{vor}}\left(\mathbf{x}\right)\right)^{\vee}\\
= & \left(\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\hat{\mathbf{q}}_{n}^{k}\otimes\mathbf{q}_{b}^{c}\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\delta\mathbf{q}_{n}^{k}\right)^{-1}\otimes\right.\\
 & \left.\otimes\left(\hat{\mathbf{q}}_{n}^{k}\right)^{-1}\otimes\hat{\mathbf{q}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}\otimes\mathbf{q}_{b}^{c}\otimes\left(\boldsymbol{\eta}_{\mathrm{vor}}\right)^{\wedge}\right)^{\vee}\\
= & \left(\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\otimes\left(\delta\mathbf{q}_{n}^{k}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\right)^{-1}\right)\otimes\right.\right.\\
 & \left.\left.\otimes\hat{\mathbf{q}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}\right)\otimes\mathbf{q}_{b}^{c}\right)^{\vee}+\boldsymbol{\eta}_{\mathrm{vor}}\\
= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(-\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{k}\right)\delta\boldsymbol{\theta}_{n}^{k}+\delta\boldsymbol{\theta}_{n}^{b}\right)+\boldsymbol{\eta}_{\mathrm{vor}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
测量Jacobian矩阵是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{vor}}=\left[\mathbf{0},\mathbf{R}\left(\mathbf{q}_{b}^{c}\right),\mathbf{0},\mathbf{0},\mathbf{0},\mathbf{0},-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{k}\right),\mathbf{0}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
与以前的工作相比(Leishman和McLain，2014[22])，这个Jacobian矩阵的推导是一个新的贡献。
\end_layout

\begin_layout Subsubsection
激光扫描匹配器
\end_layout

\begin_layout Standard
激光扫描匹配器测量模型是这项工作的一个新贡献。激光扫描匹配算法，如迭代最近点(iterative closest point, ICP)算法(Censi，200
8[11])，计算激光扫描仪在关键帧和当前扫描之间的平面平移和航向变化。由于无人机的平面外运动(横滚和俯仰)引入了扫描匹配算法无法模拟的畸变，因此在实践中，激光
扫描通常在传递给扫描匹配器之前进行倾斜补偿(Shen等人，2011[30]；Tomic等人，2012[33])。倾斜补偿通过将激光扫描投影到一层水平面上来矫正激
光扫描，使用2.5D世界假设，即所有扫描表面垂直均匀。在这个过程中，地板或天花板的扫描返回也经常被删除。2.5D假设在现实世界中通常被违反，但在城市环境中，这种方法
已被证明提供了可接受的性能(Shen等人，2011[30])。
\end_layout

\begin_layout Standard
为了对激光扫描进行倾斜补偿，我们首先计算四元数
\begin_inset Formula $\mathbf{q}_{c}^{o}$
\end_inset

，它将已横滚的和已俯仰的激光帧
\begin_inset Formula $c$
\end_inset

(包括机体到传感器变换中的任何横滚或俯仰)中表示的点旋转到正射校正帧
\begin_inset Formula $o$
\end_inset

，为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}_{c}^{o}=\left(\mathbf{q}_{b}^{c}\right)^{-1}\left(\mathbf{q}_{\theta_{n}^{b}}\otimes\mathbf{q}_{\phi_{n}^{b}}\right)^{-1},
\]

\end_inset

其中
\begin_inset Formula $\mathbf{q}_{\theta_{n}^{b}}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{\phi_{n}^{b}}$
\end_inset

是用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:37"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:39"
plural "false"
caps "false"
noprefix "false"

\end_inset

)从
\begin_inset Formula $\mathbf{q}_{n}^{b}$
\end_inset

计算出来的。然后，对于一个激光扫描
\begin_inset Formula $\mathcal{S}=\left\{ \left(r,\theta\right)\right\} $
\end_inset

表示为一组距离(range)/方位(bearing)元组
\begin_inset Formula $\left(r,\theta\right)$
\end_inset

，倾斜补偿扫描
\begin_inset Formula $\mathcal{S}^{\prime}$
\end_inset

被计算为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathcal{S}^{\prime}=\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid\mathbf{x}=\mathbf{I}_{2\times3}\mathbf{R}\left(\mathbf{q}_{c}^{o}\right)\left[\begin{array}{c}
r\cos\theta\\
r\sin\theta\\
0
\end{array}\right]\forall\left(r,\theta\right)\in\mathcal{S}\right\} .
\]

\end_inset


\end_layout

\begin_layout Standard
对于关键帧扫描的正射校正，我们注意到因为
\begin_inset Formula $\mathbf{q}_{n}^{k}=\mathbf{q}_{\theta_{n}^{b}}\otimes\mathbf{q}_{\phi_{n}^{b}}$
\end_inset

(如第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节所示)和
\begin_inset Formula $\mathbf{q}_{k}^{kc}=\mathbf{q}_{b}^{c}$
\end_inset


\begin_inset Formula $\mathbf{q}_{c}^{o}$
\end_inset

，旋转
\begin_inset Formula $\mathbf{q}_{c}^{o}$
\end_inset

等于
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}_{c}^{o}=\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\mathbf{q}_{n}^{k}\right)^{-1}.
\]

\end_inset


\end_layout

\begin_layout Standard
相关旋转矩阵由下式给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{R}\left(\mathbf{q}_{c}^{o}\right) & =\mathbf{R}\left(\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\mathbf{q}_{n}^{k}\right)^{-1}\right)\\
 & =\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{k}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{c}\right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
在下面的讨论中，我们独立地推导测量模型的平移和航向部分，但是它们可以通过叠加两个测量模型向量和Jacobian矩阵组合成一个更新。
\end_layout

\begin_layout Standard
通过在与关键帧相关联的正射校正帧中表达方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:84"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的视觉里程测量模型，然后提取
\begin_inset Formula $x$
\end_inset

和
\begin_inset Formula $y$
\end_inset

分量来构造平移测量模型：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{lt}}\left(\mathbf{x}\right)= & \mathbf{I}_{2\times3}\mathbf{R}\left(\mathbf{q}_{c}^{o}\right)\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)+\boldsymbol{\eta}_{\mathrm{lt}}\\
= & \mathbf{I}_{2\times3}\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{k}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{c}\right)\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)+\boldsymbol{\eta}_{\mathrm{lt}}\\
= & \mathbf{I}_{2\times3}\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{k}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{c}\right)\left(-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{p}_{b}^{c}\right.\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\mathbf{q}_{n}^{k}\right)\left(\mathbf{p}_{n}^{b}-\mathbf{p}_{n}^{k}\right)\\
 & \left.+\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}\left(\mathbf{q}_{n}^{k}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{b}\right)\mathbf{p}_{b}^{c}\right)+\boldsymbol{\eta}_{\mathrm{lt}}\\
= & \mathbf{I}_{2\times3}\left(-\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{k}\right)\mathbf{p}_{b}^{c}\right.\\
 & \left.+\mathbf{p}_{n}^{b}-\mathbf{p}_{n}^{k}+\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{b}\right)\mathbf{p}_{b}^{c}\right)+\boldsymbol{\eta}_{\mathrm{lt}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
我们用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:34"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开，然后去掉二阶项，得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{lt}}\left(\mathbf{x}\right)=\mathbf{I}_{2\times3} & \left(-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{R}^{\top}\left(\delta\mathbf{q}_{n}^{k}\right)\mathbf{p}_{b}^{c}+\hat{\mathbf{p}}_{n}^{b}+\delta\mathbf{p}_{n}^{b}\right.\\
 & \left.-\hat{\mathbf{p}}_{n}^{k}-\delta\mathbf{p}_{n}^{b}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{b}\right)\mathbf{p}_{b}^{c}\right)+\boldsymbol{\eta}_{\mathrm{lt}}\\
\approx\mathbf{I}_{2\times3} & \left(-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\mathbf{I}+\left\lfloor \delta\boldsymbol{\theta}_{n}^{k}\right\rfloor \right)\mathbf{p}_{b}^{c}+\hat{\mathbf{p}}_{n}^{b}+\delta\mathbf{p}_{n}^{b}\right.\\
 & \left.-\hat{\mathbf{p}}_{n}^{k}-\delta\mathbf{p}_{n}^{b}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left(I+\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \right)\mathbf{p}_{b}^{c}\right)+\boldsymbol{\eta}_{\mathrm{lt}}\\
=\mathbf{I}_{2\times3} & \left(-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{p}_{b}^{c}+\hat{\mathbf{p}}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{p}_{b}^{c}\right)\\
 & +\mathbf{I}_{2\times3}\left(\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left\lfloor \mathbf{p}_{b}^{c}\right\rfloor \delta\boldsymbol{\theta}_{n}^{k}+\delta\mathbf{p}_{n}^{b}-\delta\mathbf{p}_{n}^{k}\right.\\
 & \left.-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \mathbf{p}_{b}^{c}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}\right)+\boldsymbol{\eta}_{\mathrm{lt}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
估计的测量模型是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{h}_{\mathrm{lt}}\left(\hat{\mathbf{x}}\right)=\mathbf{I}_{2\times3}\left(-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right)\mathbf{p}_{b}^{c}+\hat{\mathbf{p}}_{n}^{b}-\hat{\mathbf{p}}_{n}^{k}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{p}_{b}^{c}\right),
\]

\end_inset

并且残差为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}_{\mathrm{lt}}=\mathbf{z}_{\mathrm{lt}}-\mathbf{h}_{\mathrm{lt}}\left(\hat{\mathbf{x}}\right),
\]

\end_inset

其被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{\mathrm{lt}}= & \mathbf{h}_{\mathrm{lt}}\left(\mathbf{x}\right)-\mathbf{h}_{\mathrm{lt}}\left(\hat{\mathbf{x}}\right)\\
= & \mathbf{I}_{2\times3}\left(\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left\lfloor \mathbf{p}_{b}^{c}\right\rfloor \delta\boldsymbol{\theta}_{n}^{k}+\delta\mathbf{p}_{n}^{b}-\delta\mathbf{p}_{n}^{k}\right.\\
 & \left.-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \mathbf{p}_{b}^{c}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}\right)+\boldsymbol{\eta}_{\mathrm{lt}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
测量Jacobian矩阵是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{lt}}=\mathbf{I}_{2\times3}\left[\mathbf{I},-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \mathbf{p}_{b}^{c}\right\rfloor ,\mathbf{0},\mathbf{0},\mathbf{0},-\mathbf{I},\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left\lfloor \mathbf{p}_{b}^{c}\right\rfloor ,\mathbf{0}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
测量模型的航向部分的推导遵循类似的策略。回顾第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:3.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节，四元数共轭操作可用于表达在另一坐标系中四元数的向量部分，我们首先将视觉里程计旋转模型从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:98"
plural "false"
caps "false"
noprefix "false"

\end_inset

)旋转到正射校正帧中，从而构建航向测量模型：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{\mathrm{lr}}= & \left(\mathbf{q}_{c}^{o}\right)^{-1}\otimes\mathbf{h}_{\mathrm{vor}}\left(\mathbf{x}\right)\otimes\mathbf{q}_{c}^{o}\\
= & \mathbf{q}_{n}^{k}\otimes\mathbf{q}_{b}^{c}\otimes\mathbf{h}_{\mathrm{vor}}\left(\mathbf{x}\right)\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\mathbf{q}_{n}^{k}\right)^{-1}\\
= & \mathbf{q}_{n}^{k}\otimes\mathbf{q}_{b}^{c}\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\mathbf{q}_{n}^{k}\right)^{-1}\\
 & \ \otimes\mathbf{q}_{n}^{b}\otimes\mathbf{q}_{b}^{c}\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\mathbf{q}_{n}^{k}\right)^{-1}\\
= & \mathbf{q}_{n}^{b}\otimes\left(\mathbf{q}_{n}^{k}\right)^{-1}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
然后，航向测量模型是
\begin_inset Formula $\mathbf{q}_{\mathrm{lr}}$
\end_inset

的偏航分量：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}h_{\mathrm{lr}}\left(\mathbf{x}\right) & =\psi\left(\mathbf{q}_{\mathrm{lr}}\right)+\eta_{\mathrm{lr}}\\
 & \triangleq\psi_{\mathrm{lr}}+\eta_{\mathrm{lr}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
估计的测量模型是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}h_{\mathrm{lr}}\left(\hat{\mathbf{x}}\right) & =\psi\left(\hat{\mathbf{q}}_{\mathrm{lr}}\right)\\
 & \triangleq\hat{\psi}_{\mathrm{lr}},
\end{aligned}
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\mathbf{q}}_{\mathrm{lr}}=\hat{\mathbf{q}}_{n}^{b}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\right)^{-1}.
\]

\end_inset


\end_layout

\begin_layout Standard
残差由下式给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
r_{\mathrm{lr}}=z_{\mathrm{lr}}-h_{\mathrm{lr}}\left(\hat{\mathbf{x}}\right),
\]

\end_inset

其被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}r_{\mathrm{lr}} & =h_{\mathrm{lr}}\left(\mathbf{x}\right)-h_{\mathrm{lr}}\left(\hat{\mathbf{x}}\right)\\
 & =\psi_{\mathrm{lr}}+\eta_{\mathrm{lr}}-\hat{\psi}_{\mathrm{lr}}\\
 & =\mathbf{k}^{\top}\boldsymbol{\Delta}_{\mathrm{lr}}+\eta_{\mathrm{lr}},
\end{aligned}
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{\Delta}_{\mathrm{lr}}=\left[\begin{array}{c}
\phi_{\mathrm{lr}}-\hat{\phi}_{\mathrm{lr}}\\
\theta_{\mathrm{lr}}-\hat{\theta}_{\mathrm{lr}}\\
\psi_{\mathrm{lr}}-\hat{\psi}_{\mathrm{lr}}
\end{array}\right]
\]

\end_inset

如附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:A"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。然后我们可以用链式法则计算残差的Jacobian矩阵，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{H}_{\mathrm{lr}} & =\dfrac{\partial r_{\mathrm{lr}}}{\partial\delta\mathbf{x}}\nonumber \\
 & =\dfrac{\partial r_{\mathrm{lr}}}{\partial\boldsymbol{\Delta}_{\mathrm{lr}}}\dfrac{\partial\boldsymbol{\Delta}_{\mathrm{lr}}}{\partial\delta\boldsymbol{\theta}_{\mathrm{lr}}}\dfrac{\partial\delta\boldsymbol{\theta}_{\mathrm{lr}}}{\partial\delta\mathbf{x}}\nonumber \\
 & =\mathbf{k}^{\top}\mathbf{N}_{\boldsymbol{\Delta}_{\mathrm{lr}}}\dfrac{\partial\delta\boldsymbol{\theta}_{\mathrm{lr}}}{\partial\delta\mathbf{x}},\label{eq:86}
\end{align}

\end_inset

其中
\begin_inset Formula $\mathbf{N}_{\boldsymbol{\Delta}_{\mathrm{lr}}}$
\end_inset

由附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:A"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:100"
plural "false"
caps "false"
noprefix "false"

\end_inset

)给出。我们使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:40"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:41"
plural "false"
caps "false"
noprefix "false"

\end_inset

)计算
\begin_inset Formula $\delta\boldsymbol{\theta}_{\mathrm{lr}}$
\end_inset

，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}_{\mathrm{lr}}= & \left(\hat{\mathbf{q}}_{\mathrm{lr}}\right)^{-1}\otimes\mathbf{q}_{\mathrm{lr}}\\
= & \left(\hat{\mathbf{q}}_{n}^{b}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\right)^{-1}\right)^{-1}\otimes\mathbf{q}_{n}^{b}\otimes\left(\mathbf{q}_{n}^{k}\right)^{-1}\\
= & \hat{\mathbf{q}}_{n}^{k}\otimes\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\\
 & \ \otimes\hat{\mathbf{q}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}\otimes\left(\delta\mathbf{q}_{n}^{k}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\right)^{-1}\\
= & \hat{\mathbf{q}}_{n}^{k}\otimes\delta\mathbf{q}_{n}^{b}\otimes\left(\delta\mathbf{q}_{n}^{k}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{n}^{k}\right)^{-1}\\
\Longrightarrow\delta\boldsymbol{\theta}_{\mathrm{lr}}= & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right)\left(\delta\boldsymbol{\theta}_{n}^{b}-\delta\boldsymbol{\theta}_{n}^{k}\right),
\end{aligned}
\]

\end_inset

我们取其偏导数并代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:86"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{lr}}=\mathbf{k}^{\top}\mathbf{N}_{\boldsymbol{\Delta}_{\mathrm{lr}}}\left[\mathbf{0},\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right),\mathbf{0},\mathbf{0},\mathbf{0},\mathbf{0},-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{k}\right),\mathbf{0}\right].
\]

\end_inset


\end_layout

\begin_layout Subsection
关键帧重置
\begin_inset CommandInset label
LatexCommand label
name "subsec:6.3"

\end_inset


\end_layout

\begin_layout Standard
当建立一个新的关键帧时，状态的相对部分被重置，如第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:5"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节所述。如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:05"
plural "false"
caps "false"
noprefix "false"

\end_inset

(b) 所示，新的节点帧被定位在车辆当前真实位置正下方的零高度，这样状态的位置部分被重置为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{p}_{n}^{b}{}^{+}=\mathbf{p}_{n}^{k}{}^{+}=\left[\begin{array}{c}
0\\
0\\
p_{nz}^{b}
\end{array}\right]
\]

\end_inset

并被估计为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\mathbf{p}}_{n}^{b}{}^{+}=\hat{\mathbf{p}}_{n}^{k}{}^{+}=\left[\begin{array}{c}
0\\
0\\
\hat{p}_{nz}^{b}
\end{array}\right].\label{eq:87}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
因此，误差状态重置为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\mathbf{p}_{n}^{b}{}^{+}=\delta\mathbf{p}_{n}^{k}{}^{+}=\left[\begin{array}{c}
0\\
0\\
\delta p_{nz}^{b}
\end{array}\right]
\]

\end_inset

并且
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\dfrac{\partial\delta\mathbf{p}_{n}^{b}{}^{+}}{\partial\delta\mathbf{p}_{n}^{b}}=\dfrac{\partial\delta\mathbf{p}_{n}^{k}{}^{+}}{\partial\delta\mathbf{p}_{n}^{b}}=\mathbf{k}\mathbf{k}^{\top}.
\]

\end_inset


\end_layout

\begin_layout Standard
状态的其它向量部分，包括
\begin_inset Formula $\mathbf{v}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\beta}_{\boldsymbol{\omega}}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\beta}_{\mathbf{a}}$
\end_inset

和
\begin_inset Formula $\mu$
\end_inset

，都不改变。
\end_layout

\begin_layout Standard
重置姿态状态的偏航部分稍微复杂一些。每一个新的节点帧的建立都要使车辆的偏航相等为零。在方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:39"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中设置
\begin_inset Formula $\psi=0$
\end_inset

，我们看到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\hat{\mathbf{q}}_{n}^{b}{}^{+}=\hat{\mathbf{q}}_{n}^{k}{}^{+} & =\mathbf{q}_{\hat{\theta}}\otimes\mathbf{q}_{\hat{\phi}}\label{eq:88}\\
 & =\left[\begin{array}{c}
\cos\dfrac{\hat{\theta}}{2}\sin\dfrac{\hat{\phi}}{2}\\
\sin\dfrac{\theta}{2}\cos\dfrac{\phi}{2}\\
-\sin\dfrac{\theta}{2}\sin\dfrac{\phi}{2}\\
\cos\dfrac{\theta}{2}\cos\dfrac{\phi}{2}
\end{array}\right],\label{eq:89}
\end{align}

\end_inset

其中
\begin_inset Formula $\hat{\phi}$
\end_inset

和
\begin_inset Formula $\hat{\theta}$
\end_inset

是用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:37"
plural "false"
caps "false"
noprefix "false"

\end_inset

)从
\begin_inset Formula $\hat{\mathbf{q}}_{n}^{b}$
\end_inset

计算出来的。姿态误差状态的协方差更新受制于
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{N}_{\boldsymbol{\theta}} & =\dfrac{\partial\delta\boldsymbol{\theta}_{n}^{b}{}^{+}}{\partial\delta\boldsymbol{\theta}_{n}^{b}}=\dfrac{\partial\delta\boldsymbol{\theta}_{n}^{k}{}^{+}}{\partial\delta\boldsymbol{\theta}_{n}^{b}}\\
 & =\left[\begin{array}{ccc}
1 & \sin\hat{\phi}\tan\hat{\theta} & \cos\hat{\phi}\tan\hat{\theta}\\
0 & \cos^{2}\hat{\phi} & -\cos\hat{\phi}\sin\hat{\phi}\\
0 & -\cos\hat{\phi}\sin\hat{\phi} & \sin^{2}\hat{\phi}
\end{array}\right],
\end{aligned}
\]

\end_inset

其在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:E"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中推导出来。当横滚和俯仰近似为零时，我们注意到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{N}_{\boldsymbol{\theta}}\approx\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 0
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
总之，关键帧重置需要根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:87"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:89"
plural "false"
caps "false"
noprefix "false"

\end_inset

)更新状态估计，并且根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:70"
plural "false"
caps "false"
noprefix "false"

\end_inset

)更新协方差，其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{N}=\left[\begin{array}{cccccccc}
\mathbf{k}\mathbf{k}^{\top} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{N}_{\boldsymbol{\theta}} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}\mathbf{k}^{\top} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{N}_{\boldsymbol{\theta}} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & 1
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Section
机体固连相对导航(bRN)
\begin_inset CommandInset label
LatexCommand label
name "sec:7"

\end_inset


\end_layout

\begin_layout Standard
虽然当定义车辆相对于惯性定义原点的位姿时，使用更传统的动力学方程，并导致更直观的状态估计，但越来越多的估计器使用机体固连或机器人中心的状态定义。在机体固连的情况
下，根据当前车辆的位姿估计惯性固定原点的位置和姿态。机体固连状态定义已被证明可以提高滤波器的一致性(Castellanos等人，2007[10])，并促进局部制
导和控制算法(Owen和Montano，2006[28]；Yu和Beard，2013[39])。例如，避障和视觉伺服问题要求车辆在估计对象相对于当前位姿的位姿后
做出导航决策。当需要状态的惯性表示时，机体固连状态及其协方差可以容易地变换为惯性系，如附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:G"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中所述。
\end_layout

\begin_layout Standard
相对导航体系结构中的相对估计器可以用一个机体固连的状态定义来表示。在这种情况下，机体固连相对导航(body-fixed Relative Navigation,
 bRN)估计节点帧相对于当前机体的状态。与之前一样，当声明新的关键帧时，水平位置和方向状态将重置。其主要区别在于采用了机体固连动力学，并且姿态误差的定义也不同
。
\end_layout

\begin_layout Standard
除非明确规定，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:6"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中的方程和定义也适用于bRN。本节遵循与第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:6"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节相同的大纲，首先在第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:7.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中描述系统的输入、状态和动力学，然后在第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:7.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节和第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:7.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中分别定义测量模型和关键帧重置。本节中的推导代表了先前工作中未包含的新贡献。
\end_layout

\begin_layout Subsection
状态动力学
\begin_inset CommandInset label
LatexCommand label
name "subsec:7.1"

\end_inset


\end_layout

\begin_layout Standard
bRN估计节点帧
\begin_inset Formula $n$
\end_inset

相对于并且是在当前机体帧
\begin_inset Formula $b$
\end_inset

中表达的位姿，表示为
\begin_inset Formula $\left(^{b}\mathbf{p}_{b}^{n},\mathbf{q}_{b}^{n}\right)$
\end_inset

。状态
\begin_inset Formula $^{b}\mathbf{p}_{b}^{n}$
\end_inset

和
\begin_inset Formula $^{n}\mathbf{p}_{n}^{b}$
\end_inset

表示相同的位移，但指向相反的方向，并在不同的帧中表达。具体地说，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
^{b}\mathbf{p}_{b}^{n}=-\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\,{}^{n}\mathbf{p}_{n}^{b}.\label{eq:90}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
状态
\begin_inset Formula $\mathbf{q}_{b}^{n}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{n}^{b}$
\end_inset

彼此互逆：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{n}=\left(\mathbf{q}_{n}^{b}\right)^{-1}.\label{eq:91}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
该估计器还跟踪第
\begin_inset Formula $n$
\end_inset

帧相对于第
\begin_inset Formula $k$
\end_inset

帧的位姿，表示为
\begin_inset Formula $\left(^{k}\mathbf{p}_{k}^{n},\mathbf{q}_{k}^{n}\right)$
\end_inset

，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:08"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。对于bRN，车辆的状态是元组
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{x}\triangleq\left(\mathbf{p}_{b}^{n},\mathbf{q}_{b}^{n},\mathbf{v},\boldsymbol{\beta}_{\boldsymbol{\omega}},\boldsymbol{\beta}_{\mathbf{a}},\mathbf{p}_{k}^{n},\mathbf{q}_{k}^{n},\mu\right),
\]

\end_inset

并且输入与第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节保持不变。状态动力学是
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
\dot{\mathbf{p}}_{b}^{n} & =-\left\lfloor \boldsymbol{\omega}\right\rfloor \mathbf{p}_{b}^{n}-\mathbf{v}\nonumber \\
\dot{\mathbf{q}}_{b}^{n} & =-\dfrac{1}{2}\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\mathbf{q}_{b}^{n}\label{eq:92a}\\
\dot{\mathbf{v}} & =\left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}+\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{g}+a_{z}\mathbf{k}-\mu\boldsymbol{\Pi}_{\mathbf{k}}\mathbf{v}+\boldsymbol{\eta}_{\mathbf{v}}\label{eq:92b}\\
\dot{\boldsymbol{\beta}}_{\boldsymbol{\omega}} & =\boldsymbol{\eta}_{\boldsymbol{\beta}_{\boldsymbol{\omega}}}\nonumber \\
\dot{\boldsymbol{\beta}}_{\mathbf{a}} & =\boldsymbol{\eta}_{\boldsymbol{\beta}_{\mathbf{a}}}\nonumber \\
\dot{\mathbf{p}}_{k}^{n} & =\mathbf{0}\nonumber \\
\dot{\mathbf{q}}_{k}^{n} & =\mathbf{0}\nonumber \\
\dot{\mu} & =0,\nonumber 
\end{align}

\end_inset


\end_layout

\end_inset

其中位置和姿态动力学的推导见附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:D"
plural "false"
caps "false"
noprefix "false"

\end_inset

，并且其中
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:72a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)给出，
\begin_inset Formula $a_{z}$
\end_inset

由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:72b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的
\begin_inset Formula $z$
\end_inset

分量给出。注意方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:92b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)与方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:80c"
plural "false"
caps "false"
noprefix "false"

\end_inset

)只有一个矩阵转置的区别。
\end_layout

\begin_layout Standard
对于bRN，误差状态向量
\begin_inset Formula $\delta\mathbf{x}\in\mathbb{R}^{22}$
\end_inset

定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\mathbf{x}=\left[\begin{array}{cccccccc}
\delta\mathbf{p}_{b}^{n}{}^{\boldsymbol{\top}} & \delta\boldsymbol{\theta}_{b}^{n}{}^{\boldsymbol{\top}} & \delta\mathbf{v}{}^{\top} & \delta\boldsymbol{\beta}_{\boldsymbol{\omega}}{}^{\top} & \delta\boldsymbol{\beta}_{\mathbf{a}}{}^{\boldsymbol{\top}} & \delta\mathbf{p}_{k}^{n}{}^{\boldsymbol{\top}} & \delta\boldsymbol{\theta}_{k}^{n}{}^{\boldsymbol{\top}} & \delta\mu\end{array}\right]^{\top}.
\]

\end_inset


\end_layout

\begin_layout Standard
误差状态动力学的一阶近似，也在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:D"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中推导，为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{p}}_{b}^{n}\approx & -\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\mathbf{p}_{b}^{n}-\delta\mathbf{v}-\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \boldsymbol{\nu}_{\boldsymbol{\omega}}\\
\delta\dot{\boldsymbol{\theta}}_{b}^{n}\approx & -\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}+\delta\boldsymbol{\beta}_{\boldsymbol{\omega}}+\boldsymbol{\nu}_{\boldsymbol{\omega}}\\
\delta\dot{\mathbf{v}}\approx & -\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}+\left(-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor -\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\right)\delta\mathbf{v}\\
 & -\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\mathbf{k}\mathbf{k}^{\top}\delta\boldsymbol{\beta}_{\mathbf{a}}-\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\delta\mu-\left\lfloor \hat{\mathbf{v}}\right\rfloor \boldsymbol{\nu}_{\boldsymbol{\omega}}\\
 & -\mathbf{k}\eta_{\mathbf{a}_{z}}+\boldsymbol{\eta}_{\mathbf{v}}\\
\delta\dot{\boldsymbol{\beta}}_{\boldsymbol{\omega}}= & \boldsymbol{\eta}_{\boldsymbol{\beta}_{\boldsymbol{\omega}}}\\
\delta\dot{\boldsymbol{\beta}}_{\mathbf{a}}= & \boldsymbol{\eta}_{\boldsymbol{\beta}_{\mathbf{a}}}\\
\delta\dot{\mathbf{p}}_{k}^{n}= & \mathbf{0}\\
\delta\dot{\boldsymbol{\theta}}_{k}^{n}= & \mathbf{0}\\
\delta\dot{\mu}= & 0.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
误差状态动力学相对于误差状态和输入噪声微分，得到以下传播Jacobian矩阵：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{F}=\left[\begin{array}{cccccccc}
-\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor  & \mathbf{0} & -\mathbf{I} & -\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor  & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & -\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor  & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & -\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}\right\rfloor  & -\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor -\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}} & -\left\lfloor \hat{\mathbf{v}}\right\rfloor  & -\mathbf{k}\mathbf{k}^{\top} & \mathbf{0} & \mathbf{0} & -\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & 0
\end{array}\right]
\]

\end_inset

并且
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{G}=\left[\begin{array}{cc}
-\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor  & \mathbf{0}\\
-\mathbf{I} & \mathbf{0}\\
-\left\lfloor \hat{\mathbf{v}}\right\rfloor  & -\mathbf{k}\\
\mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0}\\
\mathbf{0} & 0
\end{array}\right],
\]

\end_inset

其中
\begin_inset Formula $\hat{\boldsymbol{\omega}}$
\end_inset

定义于方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:73"
plural "false"
caps "false"
noprefix "false"

\end_inset

)。
\end_layout

\begin_layout Subsection
测量模型
\begin_inset CommandInset label
LatexCommand label
name "subsec:7.2"

\end_inset


\end_layout

\begin_layout Standard
当使用机体固连参数化时，测量模型有所不同，如下所述。
\end_layout

\begin_layout Subsubsection
加速计
\end_layout

\begin_layout Standard
由于加速计模型与姿态和位置无关，因此bRN模型保持不变。参见第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.2.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节。
\end_layout

\begin_layout Subsubsection
高度计
\end_layout

\begin_layout Standard
如第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.2.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节所述，声纳高度计测量距地高度。通过关联方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:90"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:83"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，车辆的高度为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
h_{\mathrm{alt}}\left(\mathbf{x}\right)=\mathbf{k}^{\top}\mathbf{R}\left(\mathbf{q}_{b}^{n}\right)\mathbf{p}_{b}^{n}+\eta_{\mathrm{alt}},
\]

\end_inset

其中旋转表示在惯性系中的高度。估计的测量模型是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
h_{\mathrm{alt}}\left(\hat{\mathbf{x}}\right)=\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\hat{\mathbf{p}}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
对于给定的高度计测量值
\begin_inset Formula $\mathbf{z}_{\mathrm{alt}}$
\end_inset

，残差为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
r_{\mathrm{alt}}=z_{\mathrm{alt}}-h_{\mathrm{alt}}\left(\hat{\mathbf{x}}\right)
\]

\end_inset

其使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:33"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

)近似表示为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}r_{\mathrm{alt}} & =h_{\mathrm{alt}}\left(\mathbf{x}\right)-h_{\mathrm{alt}}\left(\hat{\mathbf{x}}\right)\\
 & =\mathbf{k}^{\top}\mathbf{R}\left(\mathbf{q}_{b}^{n}\right)\mathbf{p}_{b}^{n}+\eta_{\mathrm{alt}}-\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\hat{\mathbf{p}}_{b}^{n}\\
 & =\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\delta\mathbf{q}_{b}^{n}\right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}\right)+\eta_{\mathrm{alt}}-\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\hat{\mathbf{p}}_{b}^{n}\\
 & \approx\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}\right)+\eta_{\mathrm{alt}}-\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\hat{\mathbf{p}}_{b}^{n}\\
 & \approx\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\delta\mathbf{p}_{b}^{n}-\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \hat{\mathbf{p}}_{b}^{n}+\eta_{\mathrm{alt}}\\
 & =\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\delta\mathbf{p}_{b}^{n}+\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}+\eta_{\mathrm{alt}},
\end{aligned}
\]

\end_inset

这导致测量Jacobian矩阵为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{alt}}=\left[\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right),\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor ,\mathbf{0},\mathbf{0},\mathbf{0},\mathbf{0},\mathbf{0},\mathbf{0}\right].
\]

\end_inset


\end_layout

\begin_layout Subsubsection
视觉里程表平移
\begin_inset CommandInset label
LatexCommand label
name "subsec:7.2.3"

\end_inset


\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:08"
plural "false"
caps "false"
noprefix "false"

\end_inset

 显示了bRN的相对位置和姿态测量模型。注意，
\begin_inset Formula $\left(\mathbf{p}_{b}^{n},\mathbf{q}_{b}^{n}\right)$
\end_inset

，
\begin_inset Formula $\left(\mathbf{p}_{k}^{n},\mathbf{q}_{k}^{n}\right)$
\end_inset

和
\begin_inset Formula $\left(\mathbf{p}_{kc}^{k},\mathbf{q}_{c}^{kc}\right)$
\end_inset

的方向与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:07"
plural "false"
caps "false"
noprefix "false"

\end_inset

 相反。相对测量通常可以在任一方向进行测量。将测量定义为指向与状态估计相同的方向，可以避免将航向估计不必要地耦合到平移测量模型中，这在实践中证明可以提高性能。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig08.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:08"

\end_inset

与bRN视觉里程测量模型相关的变换。注意，
\begin_inset Formula $\left(\mathbf{p}_{b}^{n},\mathbf{q}_{b}^{n}\right)$
\end_inset

，
\begin_inset Formula $\left(\mathbf{p}_{k}^{n},\mathbf{q}_{k}^{n}\right)$
\end_inset

和
\begin_inset Formula $\left(\mathbf{p}_{kc}^{k},\mathbf{q}_{c}^{kc}\right)$
\end_inset

与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:07"
plural "false"
caps "false"
noprefix "false"

\end_inset

 相反。同样的，
\begin_inset Formula $\mathbf{p}_{k}^{kc}=\mathbf{p}_{b}^{c}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{k}^{kc}=\mathbf{q}_{b}^{c}$
\end_inset

。
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
从图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:08"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中，相对位置更新为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vot}}(\mathbf{x})=\, & ^{c}\mathbf{p}_{c}^{kc}+\boldsymbol{\eta}_{\mathrm{vot}}\\
= & -\,{}^{c}\mathbf{p}_{b}^{c}+{}^{c}\mathbf{p}_{b}^{n}-{}^{c}\mathbf{p}_{k}^{n}+{}^{c}\mathbf{p}_{k}^{kc}+\boldsymbol{\eta}_{\mathrm{vot}}\\
= & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\,{}^{b}\mathbf{p}_{b}^{c}+\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\,{}^{b}\mathbf{p}_{b}^{n}\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right)\,{}^{k}\mathbf{p}_{k}^{n}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right)\,{}^{k}\mathbf{p}_{k}^{kc}+\boldsymbol{\eta}_{\mathrm{vot}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
抛开标号，回顾一下
\begin_inset Formula $\mathbf{p}_{k}^{kc}=\mathbf{p}_{b}^{c}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{k}^{kc}=\mathbf{q}_{b}^{c}$
\end_inset

，这就变成
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathbf{h}_{\mathrm{vot}}\left(\mathrm{x}\right)= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}\right)\\
 & \ +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\mathbf{p}_{k}^{n}\right)+\boldsymbol{\eta}_{\mathrm{vot}}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:33"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:34"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的展开给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\delta\mathbf{q}_{b}^{n}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\mathbf{R}\left(\delta\mathbf{q}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}-\delta\mathbf{p}_{k}^{n}\right)\\
 & +\boldsymbol{\eta}_{\mathrm{vot}}\\
= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\mathbf{I}+\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{k}^{n}\right\rfloor \right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}-\delta\mathbf{p}_{k}^{n}\right)\\
 & +\boldsymbol{\eta}_{\mathrm{vot}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
展开并删除高阶项，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)\approx & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}-\delta\mathbf{p}_{k}^{n}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \delta\boldsymbol{\theta}_{k}^{n}\right\rfloor \left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)+\boldsymbol{\eta}_{\mathrm{vot}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
估计的测量模型是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vot}}\left(\hat{\mathbf{x}}\right)= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\hat{\mathbf{p}}_{b}^{n}-\mathbf{p}_{b}^{c}\right)\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
我们然后根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:62"
plural "false"
caps "false"
noprefix "false"

\end_inset

)对残差进行建模，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{\mathrm{vot}}= & \mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)-\mathbf{h}_{\mathrm{vot}}\left(\hat{\mathbf{x}}\right)\\
= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\delta\mathbf{p}_{b}^{n}-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\mathrm{T}}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\delta\mathbf{p}_{k}^{n}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \delta\boldsymbol{\theta}_{k}^{n}\right\rfloor \left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)+\boldsymbol{\eta}_{\mathrm{vot}}\\
= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\delta\mathbf{p}_{b}^{n}-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}\\
 & -\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\delta\mathbf{p}_{k}^{n}\\
 & +\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right\rfloor \delta\boldsymbol{\theta}_{k}^{n}+\boldsymbol{\eta}_{\mathrm{vot}},
\end{aligned}
\]

\end_inset

这导致残差Jacobian矩阵
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{vot}}=\left[\begin{array}{cccccccc}
\mathbf{H}_{1} & \mathbf{H}_{2} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{H}_{3} & \mathbf{H}_{4} & \mathbf{0}\end{array}\right]
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{H}_{1} & =\mathbf{R}\left(\mathbf{q}_{b}^{c}\right),\\
\mathbf{H}_{2} & =-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor ,\\
\mathbf{H}_{3} & =-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right),\\
\mathbf{H}_{4} & =\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right\rfloor .
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
视觉里程表旋转
\end_layout

\begin_layout Standard
相对旋转测量模型也如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:08"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。具体来说，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{vor}}\left(\mathrm{x}\right)= & \mathbf{q}_{c}^{kc}\\
= & \left(\boldsymbol{\eta}_{\mathrm{vor}}\right)^{\vee}\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\mathbf{q}_{b}^{n}\otimes\left(\mathbf{q}_{k}^{n}\right)^{-1}\otimes\mathbf{q}_{b}^{c}\\
= & \left(\boldsymbol{\eta}_{\mathrm{vor}}\right)^{\vee}\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\delta\mathbf{q}_{b}^{n}\otimes\hat{\mathbf{q}}_{b}^{n}\otimes\\
 & \ \otimes\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\otimes\left(\delta\mathbf{q}_{k}^{n}\right)^{-1}\otimes\mathbf{q}_{b}^{c}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
估计的测量模型是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{h}_{\mathrm{vor}}\left(\hat{\mathbf{x}}\right)=\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\hat{\mathbf{q}}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\otimes\mathbf{q}_{b}^{c}.
\]

\end_inset


\end_layout

\begin_layout Standard
对于给定的相对姿态测量
\begin_inset Formula $\mathbf{z}_{\mathrm{vor}}$
\end_inset

，残差是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}_{\mathrm{vor}}=\left(\mathbf{z}_{\mathrm{vor}}\otimes\mathbf{h}_{\mathrm{vor}}\left(\hat{\mathbf{x}}\right)^{-1}\right)^{\vee},
\]

\end_inset

这样的模型，然后用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:41"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:42"
plural "false"
caps "false"
noprefix "false"

\end_inset

)简化为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{\mathrm{vor}}= & \left(\mathbf{h}_{\mathrm{vor}}\left(\mathrm{x}\right)\otimes\mathbf{h}_{\mathrm{vor}}\left(\hat{\mathbf{x}}\right)^{-1}\right)^{\vee}\\
= & \left(\left(\boldsymbol{\eta}_{\mathrm{vor}}\right)^{\vee}\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\delta\mathbf{q}_{b}^{n}\otimes\hat{\mathbf{q}}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\otimes\right.\\
 & \left.\otimes\left(\delta\mathbf{q}_{k}^{n}\right)^{-1}\otimes\mathbf{q}_{b}^{c}\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\hat{\mathbf{q}}_{k}^{n}\otimes\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\otimes\mathbf{q}_{b}^{c}\right)^{\vee}\\
= & \left(\left(\boldsymbol{\eta}_{\mathrm{vor}}\right)^{\vee}\otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\delta\mathbf{q}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{b}^{n}\otimes\right.\right.\\
 & \left.\left.\otimes\left(\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\otimes\left(\delta\mathbf{q}_{k}^{n}\right)^{-1}\otimes\hat{\mathbf{q}}_{k}^{n}\right)\otimes\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\right)\otimes\mathbf{q}_{b}^{c}\right)^{\vee}\\
= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\delta\boldsymbol{\theta}_{b}^{n}-\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right)\delta\boldsymbol{\theta}_{k}^{n}\right)+\boldsymbol{\eta}_{\mathrm{vor}}\\
= & \mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\delta\boldsymbol{\theta}_{b}^{n}-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right)\delta\boldsymbol{\theta}_{k}^{n}+\boldsymbol{\eta}_{\mathrm{vor}},
\end{aligned}
\]

\end_inset

导致测量Jacobian矩阵为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{vor}}=\left[\mathbf{0},\mathbf{R}\left(\mathbf{q}_{b}^{c}\right),\mathbf{0},\mathbf{0},\mathbf{0},\mathbf{0},-\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right),\mathbf{0}\right].
\]

\end_inset


\end_layout

\begin_layout Subsubsection
激光扫描匹配器
\begin_inset CommandInset label
LatexCommand label
name "subsec:7.2.5"

\end_inset


\end_layout

\begin_layout Standard
与iRN的情况一样，激光扫描在传递给扫描匹配器之前是正射校正的。描述从激光帧
\begin_inset Formula $c$
\end_inset

到正射校正帧
\begin_inset Formula $o$
\end_inset

的旋转的四元数
\begin_inset Formula $\mathbf{q}_{c}^{o}$
\end_inset

由下式给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{c}^{o} & =\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\left(\mathbf{q}_{\theta_{n}^{b}}\otimes\mathbf{q}_{\phi_{n}^{b}}\right)^{-1}\\
 & =\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\mathbf{q}_{b}^{o},
\end{aligned}
\]

\end_inset

其中
\begin_inset Formula $\mathbf{q}_{n}^{b}=\left(\mathbf{q}_{b}^{n}\right)^{-1}$
\end_inset

，
\begin_inset Formula $\mathbf{q}_{\theta_{n}^{b}}$
\end_inset

和
\begin_inset Formula $\mathbf{q}_{\phi_{n}^{b}}$
\end_inset

由
\begin_inset Formula $\mathbf{q}_{n}^{b}$
\end_inset

用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:37"
plural "false"
caps "false"
noprefix "false"

\end_inset

)计算得出，
\begin_inset Formula $\mathbf{q}_{b}^{o}$
\end_inset

定义为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}_{b}^{o}\triangleq\left(\mathbf{q}_{\theta_{n}^{b}}\otimes\mathbf{q}_{\phi_{n}^{b}}\right)^{-1}.
\]

\end_inset


\end_layout

\begin_layout Standard
然后从原始激光扫描
\begin_inset Formula $\mathcal{S}=\left\{ \left(r,\theta\right)\right\} $
\end_inset

中计算出正射校正激光扫描
\begin_inset Formula $\mathcal{S}^{\prime}$
\end_inset

，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathcal{S}^{\prime}=\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid\mathbf{x}=\mathbf{I}_{2\times3}\mathbf{R}\left(\mathbf{q}_{c}^{o}\right)\left[\begin{array}{c}
r\cos\theta\\
r\sin\theta\\
0
\end{array}\right]\forall\left(r,\theta\right)\in\mathcal{S}\right\} .
\]

\end_inset


\end_layout

\begin_layout Standard
我们注意到，与
\begin_inset Formula $\mathbf{q}_{c}^{o}$
\end_inset

相关的旋转矩阵可以写为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{R}\left(\mathbf{q}_{c}^{\circ}\right) & =\mathbf{R}\left(\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\mathbf{q}_{b}^{o}\right)\\
 & =\mathbf{R}\left(\mathbf{q}_{b}^{o}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{c}\right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
将测量的平移部分旋转到正射校正帧后，将其建模为第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:7.2.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中视觉里程计平移模型的
\begin_inset Formula $x$
\end_inset

和
\begin_inset Formula $y$
\end_inset

分量：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{h}_{\mathrm{lt}}\left(\mathbf{x}\right)= & \mathbf{I}_{2\times3}\mathbf{R}\left(\mathbf{q}_{c}^{o}\right)\mathbf{h}_{\mathrm{vot}}\left(\mathbf{x}\right)+\boldsymbol{\eta}_{\mathrm{lt}}\nonumber \\
= & \mathbf{I}_{2\times3}\mathbf{R}\left(\mathbf{q}_{b}^{o}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{c}\right)\left(\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\left(\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}\right)\right.\nonumber \\
 & \left.+\mathbf{R}\left(\mathbf{q}_{b}^{c}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\mathbf{p}_{k}^{n}\right)\right)+\boldsymbol{\eta}_{\mathrm{lt}}\nonumber \\
= & \mathbf{I}_{2\times3}\mathbf{R}\left(\mathbf{q}_{b}^{o}\right)\left(\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}\right.\nonumber \\
 & \left.+\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\mathbf{p}_{k}^{n}\right)\right)+\boldsymbol{\eta}_{\mathrm{lt}}.\label{eq:93}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
估计的测量模型是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{h}_{\mathrm{lt}}\left(\hat{\mathbf{x}}\right)= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left(\hat{\mathbf{p}}_{b}^{n}-\mathbf{p}_{b}^{c}\right.\\
 & \left.+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
残差Jacobian矩阵在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:F"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中推导，由下式给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{lt}}=\left[\begin{array}{cccccccc}
\mathbf{H}_{1} & \mathbf{H}_{2} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{H}_{3} & \mathbf{H}_{4} & \mathbf{0}\end{array}\right],
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{array}{rl}
\mathbf{H}_{1}= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right),\\
\mathbf{H}_{2}= & -\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \\
 & +\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}-\mathbf{p}_{b}^{c}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \\
 & \times\left[\begin{array}{ccc}
0 & 0 & 0\\
0 & \cos\hat{\phi}_{n}^{b} & 0\\
0 & -\sin\hat{\phi}_{n}^{b}0 & 0
\end{array}\right]\mathbf{N}_{\boldsymbol{\Delta}_{n}^{b}},\\
\mathbf{H}_{3}= & -\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right),\\
\mathbf{H}_{4}= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right\rfloor .
\end{array}
\]

\end_inset


\end_layout

\begin_layout Standard
对于测量模型的旋转部分，我们首先在正射校正帧中表示视觉里程计旋转模型：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{\mathrm{lr}}= & \left(\mathbf{q}_{c}^{o}\right)^{-1}\otimes\mathbf{h}_{\mathrm{vor}}\left(\mathbf{x}\right)\otimes\mathbf{q}_{c}^{o}\\
= & \left(\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\mathbf{q}_{b}^{o}\right)^{-1}\\
 & \ \otimes\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\mathbf{q}_{b}^{n}\otimes\left(\mathbf{q}_{k}^{n}\right)^{-1}\otimes\mathbf{q}_{b}^{c}\otimes\left(\left(\mathbf{q}_{b}^{c}\right)^{-1}\otimes\mathbf{q}_{b}^{o}\right)\\
= & \left(\mathbf{q}_{b}^{o}\right)^{-1}\otimes\mathbf{q}_{b}^{n}\otimes\left(\mathbf{q}_{k}^{n}\right)^{-1}\otimes\mathbf{q}_{b}^{o},
\end{aligned}
\]

\end_inset

其估计为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\mathbf{q}}_{\mathrm{lr}}=\left(\hat{\mathbf{q}}_{b}^{o}\right)^{-1}\otimes\hat{\mathbf{q}}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\otimes\hat{\mathbf{q}}_{b}^{o}.
\]

\end_inset


\end_layout

\begin_layout Standard
然后，测量模型是
\begin_inset Formula $\mathbf{q}_{\mathrm{lr}}$
\end_inset

的偏航部分，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{h}_{\mathrm{lr}}\left(\mathbf{x}\right)=\psi\left(\mathbf{q}_{\mathrm{lr}}\right)+\eta_{\mathrm{lr}},
\]

\end_inset

其估计为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{h}_{\mathrm{lr}}\left(\hat{\mathbf{x}}\right)=\psi\left(\hat{\mathbf{q}}_{\mathrm{lr}}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
残差Jacobian矩阵在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:F"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中推导，由下式给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{H}_{\mathrm{lr}}=\left[\begin{array}{cccccccc}
\mathbf{0} & \mathbf{H}_{1} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{H}_{2} & \mathbf{0}\end{array}\right],
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{H}_{1}= & \mathbf{k}^{\top}\mathbf{N}_{\boldsymbol{\Delta}_{\mathrm{lr}}}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\\
 & \times\left(\mathbf{I}+\left(\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)-\mathbf{I}\right)\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & \cos\hat{\phi}_{n}^{b} & 0\\
0 & \sin\phi_{n}^{b} & 0
\end{array}\right]\mathbf{N}_{\boldsymbol{\Delta}_{n}^{b}}\right),\\
\mathbf{H}_{2}= & -\mathbf{k}^{\top}\mathbf{N}_{\boldsymbol{\Delta}_{\mathrm{lr}}}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right).
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Subsection
关键帧重置
\begin_inset CommandInset label
LatexCommand label
name "subsec:7.3"

\end_inset


\end_layout

\begin_layout Standard
由于位置和方向状态以机体为中心表示，bRN的关键帧重置步骤有些不直观，但是可以通过遵循iRN重置步骤来推导。在方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:91"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:88"
plural "false"
caps "false"
noprefix "false"

\end_inset

)之后，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\hat{\mathbf{q}}_{b}^{n}{}^{+} & =\left(\hat{\mathbf{q}}_{n}^{b}{}^{+}\right)^{-1}\\
 & =\left(\hat{\mathbf{q}}_{\hat{\theta}}\otimes\hat{\mathbf{q}}_{\hat{\phi}}\right)^{-1}\\
 & =\left[\begin{array}{c}
-\cos\dfrac{\hat{\theta}}{2}\sin\dfrac{\hat{\phi}}{2}\\
-\sin\dfrac{\theta}{2}\cos\dfrac{\phi}{2}\\
\sin\dfrac{\hat{\theta}}{2}\sin\dfrac{\hat{\phi}}{2}\\
\cos\dfrac{\hat{\theta}}{2}\cos\dfrac{\hat{\phi}}{2}
\end{array}\right],
\end{aligned}
\]

\end_inset

其中，
\begin_inset Formula $\phi$
\end_inset

和
\begin_inset Formula $\theta$
\end_inset

使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:37"
plural "false"
caps "false"
noprefix "false"

\end_inset

)从
\begin_inset Formula $\hat{\mathbf{q}}_{n}^{b}=\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}$
\end_inset

计算出来。请注意，即使bRN在机体坐标系中表达的姿态，但角度
\begin_inset Formula $\phi$
\end_inset

、
\begin_inset Formula $\theta$
\end_inset

和
\begin_inset Formula $\psi$
\end_inset

仍然代表传统的横滚、俯仰和偏航欧拉角，表达了机体相对于惯性坐标系的方向。姿态重置的Jacobian矩阵在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:E"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中推导，恰好与iRN姿态重置的Jacobian矩阵相同：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\dfrac{\partial\delta\boldsymbol{\theta}_{b}^{n}{}^{+}}{\partial\delta\boldsymbol{\theta}_{b}^{n}}=\dfrac{\partial\delta\boldsymbol{\theta}_{n}^{b}{}^{+}}{\partial\delta\boldsymbol{\theta}_{n}^{b}}=\mathbf{N}_{\boldsymbol{\theta}}.
\]

\end_inset


\end_layout

\begin_layout Standard
位置重置的推导更为复杂，在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:E"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中给出。由此产生的重置操作是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\mathbf{p}}_{b}^{n}{}^{+}=\mathbf{N}_{\mathbf{p}}\hat{\mathbf{p}}_{b}^{n},
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{N}_{\mathbf{p}}=\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
因为重置发生时帧
\begin_inset Formula $b$
\end_inset

和帧
\begin_inset Formula $k$
\end_inset

在同一位置，所以我们还有
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\hat{\mathbf{p}}_{k}^{n}{}^{+} & =\hat{\mathbf{p}}_{b}^{n}{}^{+},\\
\hat{\mathbf{q}}_{k}^{n}{}^{+} & =\hat{\mathbf{q}}_{b}^{n}{}^{+}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
总的关键帧重置Jacobian矩阵，也在附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:E"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中推导，由下式给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{N}=\left[\begin{array}{cccccccc}
\mathbf{N}_{\mathbf{p}} & \left(-\left\lfloor \mathbf{N}_{\mathbf{p}}\mathbf{p}_{b}^{n}\right\rfloor +\mathbf{N}_{\mathbf{p}}\left\lfloor \mathbf{p}_{b}^{n}\right\rfloor \right)\mathbf{N}_{\boldsymbol{\theta}} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{N}_{\boldsymbol{\theta}} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{N}_{\mathbf{p}} & \left(-\left\lfloor \mathbf{N}_{\mathbf{p}}\mathbf{p}_{b}^{n}\right\rfloor +\mathbf{N}_{\mathbf{p}}\left\lfloor \mathbf{p}_{b}^{n}\right\rfloor \right)\mathbf{N}_{\boldsymbol{\theta}} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{N}_{\boldsymbol{\theta}} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & 1
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Section
结果
\begin_inset CommandInset label
LatexCommand label
name "sec:8"

\end_inset


\end_layout

\begin_layout Standard
RMKF是用ROS(Quigley等人，2009[29])框架在C++中实现的。以下各节给出了RMEKF在多旋翼飞行器上的性能的仿真和硬件结果。第
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:8.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中的仿真结果说明了在理想条件下估计器的性能，其中所有噪声都是具有已知协方差的高斯噪声，所有偏差都是已知的。第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:8.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中的硬件结果证明了估计器在实际条件下的性能，其中高斯噪声假设不一定满足，协方差和偏差未知。
\end_layout

\begin_layout Standard
本节中的结果说明了RMEKF产生的相对状态估计的典型精度。由于相对状态估计是一种独特的方法，除非本文中的估计器与一个简单的全局后端相结合，否则无法直接与文献中的
相关全局估计技术进行比较。对于这些比较，读者可以参考Wheeler等人(2018)[38]的相关工作。Wheeler等人(2020)[37]更广泛的飞行试验结果
进一步证明了RMEKF在多旋翼平台的几次扩展飞行中的实际性能，包括闭合估计值周围的控制回路。
\end_layout

\begin_layout Subsection
模拟结果
\begin_inset CommandInset label
LatexCommand label
name "subsec:8.1"

\end_inset


\end_layout

\begin_layout Standard
模拟提供了加速计、陀螺仪、高度计和视觉里程表测量数据，这些数据被正态分布的噪声所破坏。模拟的IMU数据中还加入了缓慢漂移的偏差。传感器噪声(
\begin_inset Formula $\boldsymbol{\nu}_{\boldsymbol{\omega}}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\nu}_{\mathbf{a}}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\eta}_{\mathrm{vot}}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\eta}_{\mathrm{vor}}$
\end_inset

和
\begin_inset Formula $\eta_{\mathrm{alt}}$
\end_inset

)从正态分布中取样，其标准偏差为低成本硬件传感器的典型值：
\begin_inset Formula $\sigma_{\boldsymbol{\omega}}=0.13\ \mathrm{rad}/\mathrm{s}$
\end_inset

，
\begin_inset Formula $\sigma_{\mathbf{a}}=1.15\mathrm{~m}/\mathrm{s}^{2}$
\end_inset

，
\begin_inset Formula $\sigma_{\mathrm{vot}}=0.02\mathrm{~m}$
\end_inset

，
\begin_inset Formula $\sigma_{\mathrm{vor}}=0.01\ \mathrm{rad}$
\end_inset

，
\begin_inset Formula $\sigma_{\mathrm{alt}}=0.01\mathrm{~m}$
\end_inset

。当车辆移动超过
\begin_inset Formula $0.2\mathrm{~m}$
\end_inset

或偏航超过
\begin_inset Formula $20^{\circ}$
\end_inset

时，建立了新的关键帧。估算器在从温和到激进的各种机动中进行了评估，在激进的机动中，车辆的速度超过
\begin_inset Formula $25\mathrm{~m}/\mathrm{s}$
\end_inset

，倾斜角超过
\begin_inset Formula $45^{\circ}$
\end_inset

。
\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:09"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:10"
plural "false"
caps "false"
noprefix "false"

\end_inset

 显示了iRN和bRN估计器在跟踪车辆位姿时的3秒钟的性能快照，其中选择了小时间窗口以使相对状态重置可见。在这3秒钟内，车辆以几乎恒定的速度向前移动，同时保持地
面上
\begin_inset Formula $1.25\mathrm{~m}$
\end_inset

的标称高度，同时逐渐减缓其顺时针偏航运动。垂直灰线表示声明新关键帧的时间。当使用四元数定义状态时，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:09"
plural "false"
caps "false"
noprefix "false"

\end_inset

(b) 使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:37"
plural "false"
caps "false"
noprefix "false"

\end_inset

)绘制横滚、俯仰和偏航角。
\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:09"
plural "false"
caps "false"
noprefix "false"

\end_inset

 突出显示了相对导航的几个有趣的实用性。正如第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:5"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节所讨论的，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:09"
plural "false"
caps "false"
noprefix "false"

\end_inset

 说明了如何在每个新声明的关键帧中将前向、右向和偏航状态重置为零，同时高度、横滚和俯仰状态保持连续。应该注意的是，虽然横滚和俯仰是连续的，但四个四元数状态中的每
一个都会出现不连续。因为相对状态的不连续性发生在已知的时间，它们很容易被解释，所以在实践中，不会引起控制稳定性的问题。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:09"
plural "false"
caps "false"
noprefix "false"

\end_inset

 还说明了关键帧不会以固定的间隔重置，而是根据车辆自上一个关键帧以来行驶的距离重置。某些传感器，例如具有长距离和宽视野的激光扫描仪，有助于延长关键帧之间的距离。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig09.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:09"

\end_inset

iRN的RMEKF估计性能仿真：(a)位置；(b)姿态。垂直灰线表示何时声明新的关键帧。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
RMEKF在使用第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:7"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中介绍的机体固连动力学时的性能非常相似。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:10"
plural "false"
caps "false"
noprefix "false"

\end_inset

 显示了bRN估计器在与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:09"
plural "false"
caps "false"
noprefix "false"

\end_inset

 相同的时间窗口内对于位置状态的性能。bRN(未显示)的姿态性能与iRN的姿态性能几乎相同，只是对于角度符号发生了变化。注意，在图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:10"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中，每个位置状态在关键帧重置时都会经历轻微的不连续性，并且位置估计值不会重置为零。这是因为关键帧重置步骤将从状态中删除所有水平平移，但会继续跟踪车辆的距地高度
。由于bRN位置状态是相对于已横滚的和已倾斜的机体坐标系表示的，因此一些距地高度被映射到前向和右向分量中。当使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:90"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:91"
plural "false"
caps "false"
noprefix "false"

\end_inset

)表达关于当前节点帧的bRN状态估计时，它们与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:09"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示的估计几乎相同。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig10.jpeg

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:10"

\end_inset

bRN的RMEKF位置估计性能仿真。bRN的姿态性能与iRN的姿态性能几乎相同，但符号相反。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
硬件结果
\begin_inset CommandInset label
LatexCommand label
name "subsec:8.2"

\end_inset


\end_layout

\begin_layout Standard
硬件结果所用的飞行器，Y6配置的六轴飞行器，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:11"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。姿态控制由运行ROSflight
\begin_inset Foot
status open

\begin_layout Plain Layout
参见
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://rosflight.org
\end_layout

\end_inset


\end_layout

\end_inset

 固件的Naze32自动驾驶仪执行。IMU数据从自动驾驶仪上的低成本MEMS IMU(InvenSense MPU-6050)以
\begin_inset Formula $500\mathrm{~Hz}$
\end_inset

的频率传输。高度计数据从MaxBotix LV-MaxSonar-EZ3超声波测距仪获得。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig11.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:11"

\end_inset

用于硬件结果飞行测试的飞行器。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
所有的估计都是在带英特尔i7处理器的板载计算机上实时执行的。视觉里程表也在车载计算机上以
\begin_inset Formula $15\mathrm{~Hz}$
\end_inset

的频率计算，它来自一个前向Asus Xtion Pro Live RGB-D相机，使用深度增强的单目里程表算法(Zhang等人，2014[40])，该算法被修改
为输出相对测量。当车辆移动超过
\begin_inset Formula $0.5\mathrm{~m}$
\end_inset

或偏航超过
\begin_inset Formula $20^{\circ}$
\end_inset

时，建立新的关键帧，尽管可以实现更复杂的关键帧选择算法。为视觉里程计测量协方差选择了一个恒定的典型值，但是未来的实现可以利用从帧到帧估计协方差的算法(例如，An
derson等人，2019[1])。
\end_layout

\begin_layout Standard
在本文中，运动捕捉系统提供了真值参考。运动捕捉系统的定位精度约为
\begin_inset Formula $0.5\mathrm{~cm}$
\end_inset

或更高，姿态精度约为
\begin_inset Formula $0.1^{\circ}$
\end_inset

。使用校准程序将四旋翼机体帧注册到运动捕捉帧。为了将相对状态估计与全局运动捕捉数据进行比较，每次视觉里程计关键帧重置发生时，通过对运动捕捉数据应用第
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节和第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:7.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中描述的相同位置和方向重置步骤，同步参考帧。虽然这种方法有很小的时间延迟和其它固有的误差源，但我们认为这种 "真实 "参考高度代表了真实运动，是系统评估的适
当参考源。
\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:12"
plural "false"
caps "false"
noprefix "false"

\end_inset

 显示了使用惯性动力学(iRN)的RMEKF的估计器性能。图中显示了一个典型的
\begin_inset Formula $10$
\end_inset

秒的飞行窗口，使得相对状态重置清晰可见。这些估计很好地追踪了真实情况。再次注意，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:12"
plural "false"
caps "false"
noprefix "false"

\end_inset

(a) 中的前向和右向位置估计随着每个新关键帧而重置，而向下位置估计是连续的。类似地，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:12"
plural "false"
caps "false"
noprefix "false"

\end_inset

(b) 中的偏航估计会随着每个关键帧而重置，但是横滚和俯仰是连续的。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:12"
plural "false"
caps "false"
noprefix "false"

\end_inset

(c) 中的速度估计是连续的。表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 总结了
\begin_inset Formula $90\ \mathrm{s}$
\end_inset

飞行期间每个状态估计值的均方根误差。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig12.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:12"

\end_inset

iRN的硬件RMEKF估计性能：(a)位置；(b)姿态；(c)速度。垂直灰线表示何时声明新的关键帧。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:1"

\end_inset

RMS error for the hardware results
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\begin{tabular}{clll}
\hline  State  &  Axis  & \multicolumn{2}{c}{ RMS error }\\
 \cline{ 3 - 4 }  &   &  iRN  &  bRN \\
\hline  forward  &  \ensuremath{0.0306\mathrm{~m}}  &  \ensuremath{0.0318\mathrm{~m}} \\
 Position  &  right  &  \ensuremath{0.0439\mathrm{~m}}  &  \ensuremath{0.0436\mathrm{~m}} \\
  &  down  &  \ensuremath{0.0648\mathrm{~m}}  &  \ensuremath{0.0414\mathrm{~m}} \\
\hline   &  roll  &  \ensuremath{0.7983} deg  &  \ensuremath{1.6259} deg \\
 Attitude  &  pitch  &  \ensuremath{0.3785} deg  &  \ensuremath{0.5714} deg \\
  &  yaw  &  \ensuremath{0.2933} deg  &  \ensuremath{0.3422} deg \\
\hline   &  forward  &  \ensuremath{0.1313\mathrm{~m}/\mathrm{s}}  &  \ensuremath{0.1481\mathrm{~m}/\mathrm{s}} \\
 Velocity  &  right  &  \ensuremath{0.1483\mathrm{~m}/\mathrm{s}}  &  \ensuremath{0.1784\mathrm{~m}/\mathrm{s}} \\
  &  down  &  \ensuremath{0.0702\mathrm{~m}/\mathrm{s}}  &  \ensuremath{0.0806\mathrm{~m}/\mathrm{s}} \\
\hline  
\end{tabular}
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
采用机体固连动力学(bRN)的估计器的性能与惯性动力学非常相似。图中未显示bRN结果，但表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 总结了可比飞行试验的RMS误差。
\end_layout

\begin_layout Standard
更仔细地看图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:12"
plural "false"
caps "false"
noprefix "false"

\end_inset

(a) 和 (b)，似乎相对状态并没有完全重置为零。其原因是视觉里程计处理的延迟，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:13"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。从捕获图像(图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:13"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中的垂直虚线)到发布视觉里程计信息(垂直实线)平均需要约
\begin_inset Formula $115\ \mathrm{ms}$
\end_inset

。然而，估计器在应用里程计测量时使用图像捕获时间戳，如第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:4.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节所述。当捕捉到新的关键帧图像时，在图像捕捉和里程计消息之间的时间窗口内，估计器继续相对于先前的关键帧操作。一旦新的关键帧里程计消息到达，估计器返回到图像捕获
的时间，将状态重置为零，然后重新传播在视觉里程计消息时间之前排队的IMU和高度计消息。结果，估计器发布的关于新关键帧的第一个消息包括IMU重传的
\begin_inset Formula $115\ \mathrm{ms}$
\end_inset

并且是非零的。然而，在图像捕获时，相对状态实际上被重置为零。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename fig13.jpeg
	scale 110

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:13"

\end_inset

关键帧重置与延迟视觉里程测量。由于处理第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:4.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中所述的延迟测量，相对状态可能不会一直重置为零。只有估计线的实心部分被发布。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
结论
\begin_inset CommandInset label
LatexCommand label
name "sec:9"

\end_inset


\end_layout

\begin_layout Standard
虽然在GPS缺失的环境中导航时，UAS的全局状态是不可观测的，但通过使用相对导航框架巧妙地重构问题，有可能保持可观测性。先前的模拟研究表明，相对导航框架具有强大
的理论动机，包括改进的一致性、有界协方差，以及改进的精度(Wheeler等人，2018[38])。此外，重要的硬件结果证明了在使用相对MEKF进行状态估计时，小
型无人机相对导航的有效性和实用性(Wheeler等人，2020[37])。本文严格推导了在Wheeler等人(2018)[38]和Wheeler等人(2020)
[37]的文章中使用的RMEKF，提出了将相对导航应用于UAS状态估计问题所要数学知识。它的教程性质和逐步推导使本文成为一个自包含的资源，可用于将该方法扩展到其
它应用。
\end_layout

\begin_layout Standard
通过定义相对于局部坐标系的状态，本文演示了如何利用视觉里程算法的相对测量来确保可观测状态。本文提出了新的视觉里程计和激光扫描匹配测量模型，并提出了一个独特的关键
帧重置步骤，以确保即使在全局信息不可用的情况下，滤波器状态也是完全可观测的。
\end_layout

\begin_layout Standard
在仿真和硬件上证明了RMEKF在惯性定义的和在机体固连的车辆动力学中都能有效地产生精确的有界的不确定性状态估计。虽然惯性和机体固连的定义产生了类似的结果，但本文
明确地概述了状态估计器中出现的差异，包括误差状态定义、测量模型、四元数积分过程和关键帧重置步骤的差异。本文的其它贡献包括间接MEKF的教程介绍、Hamilton
四元数的阐述以及部分更新四元数及其协方差所需的误差四元数的几个新特性的推导。
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{appendices}
\end_layout

\end_inset


\end_layout

\begin_layout Section
欧拉角分解的Jacobian矩阵
\begin_inset CommandInset label
LatexCommand label
name "sec:A"

\end_inset


\end_layout

\begin_layout Standard
在本附录中，我们探讨了四元数的欧拉角分解误差，(
\begin_inset Formula $\psi-\hat{\psi}$
\end_inset

、
\begin_inset Formula $\theta-\hat{\theta}$
\end_inset

和
\begin_inset Formula $\phi-\hat{\phi}$
\end_inset

)，与该四元数中误差的最小表示，
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

，它们之间的关系。具体来说，定义
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{\Delta}\triangleq\left[\begin{array}{c}
\phi-\hat{\phi}\\
\theta-\hat{\theta}\\
\psi-\hat{\psi}
\end{array}\right],
\]

\end_inset

我们希望推导出Jacobian矩阵的表达式
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{N}_{\boldsymbol{\Delta}}\triangleq\dfrac{\partial\boldsymbol{\Delta}}{\partial\delta\boldsymbol{\theta}}.
\]

\end_inset


\end_layout

\begin_layout Standard
下面的推导和表达式与Barfoot等人(2011)[4]给出的推导和表达式有些相似，但都是在误差状态公式的上下文中推导出来的。
\end_layout

\begin_layout Standard
我们首先推导方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:38"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:39"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的偏航、俯仰和横滚四元数的误差四元数表达式。例如，利用误差四元数的iRN定义，我们可以从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:39"
plural "false"
caps "false"
noprefix "false"

\end_inset

)计算
\begin_inset Formula $\delta\mathbf{q}_{\psi}$
\end_inset

，为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\mathbf{q}_{\psi} & =\hat{\mathbf{q}}_{\psi}^{-1}\otimes\mathbf{q}_{\psi}\nonumber \\
 & =\left[\begin{array}{c}
0\\
0\\
-\sin\left(\dfrac{1}{2}\hat{\psi}\right)\\
\cos\left(\dfrac{1}{2}\hat{\psi}\right)
\end{array}\right]\otimes\left[\begin{array}{c}
0\\
0\\
\sin\left(\dfrac{1}{2}\psi\right)\\
\cos\left(\dfrac{1}{2}\psi\right)
\end{array}\right]\nonumber \\
 & =\left[\begin{array}{c}
0\\
0\\
\sin\left(\dfrac{1}{2}\psi\right)\cos\left(\dfrac{1}{2}\hat{\psi}\right)-\cos\left(\dfrac{1}{2}\psi\right)\sin\left(\dfrac{1}{2}\hat{\psi}\right)\\
\cos\left(\dfrac{1}{2}\psi\right)\cos\left(\dfrac{1}{2}\hat{\psi}\right)+\sin\left(\dfrac{1}{2}\psi\right)\sin\left(\dfrac{1}{2}\hat{\psi}\right)
\end{array}\right]\nonumber \\
 & =\left[\begin{array}{c}
0\\
0\\
\sin\left(\dfrac{1}{2}(\psi-\hat{\psi})\right)\\
\cos\left(\dfrac{1}{2}(\psi-\hat{\psi})\right)
\end{array}\right],\label{eq:94}
\end{align}

\end_inset

其中最后一步使用标准角差三角恒等式。通过类似的分析，我们发现方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:94"
plural "false"
caps "false"
noprefix "false"

\end_inset

)在使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)时对bRN也成立。我们同样可以发现
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{q}_{\phi}=\left[\begin{array}{c}
\sin\left(\dfrac{1}{2}(\phi-\hat{\phi})\right)\\
0\\
0\\
\cos\left(\dfrac{1}{2}(\phi-\hat{\phi})\right)
\end{array}\right],\quad\delta\mathbf{q}_{\theta}=\left[\begin{array}{c}
0\\
\sin\left(\dfrac{1}{2}(\theta-\hat{\theta})\right)\\
0\\
\cos\left(\dfrac{1}{2}(\theta-\hat{\theta})\right)
\end{array}\right]\end{aligned}
\label{eq:95}
\end{equation}

\end_inset

对于iRN和bRN姿态误差定义都成立。因为这些误差都在欧拉旋转序列的不同中间帧中表示，一般来说，
\begin_inset Formula $\delta\mathbf{q}\neq\delta\mathbf{q}_{\psi}\otimes\delta\mathbf{q}_{\theta}\otimes\delta\mathbf{q}_{\phi}$
\end_inset

。
\end_layout

\begin_layout Standard
假设姿态误差很小，我们用一阶泰勒级数近似方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:94"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:95"
plural "false"
caps "false"
noprefix "false"

\end_inset

)为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\mathbf{q}_{\phi}\approx\left[\begin{array}{c}
\dfrac{\phi-\hat{\phi}}{2}\\
0\\
0\\
1
\end{array}\right],\quad\delta\mathbf{q}_{\theta}\approx\left[\begin{array}{c}
0\\
\dfrac{\theta-\hat{\theta}}{2}\\
0\\
1
\end{array}\right],\quad\delta\mathbf{q}_{\psi}\approx\left[\begin{array}{c}
0\\
0\\
\dfrac{\psi-\hat{\psi}}{2}\\
1
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
这些误差状态根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:19"
plural "false"
caps "false"
noprefix "false"

\end_inset

)最小化表示为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\theta}_{\phi}=\left[\begin{array}{c}
\phi-\hat{\phi}\\
0\\
0
\end{array}\right],\quad\delta\boldsymbol{\theta}_{\theta}=\left[\begin{array}{c}
0\\
\theta-\hat{\theta}\\
0
\end{array}\right],\quad\delta\boldsymbol{\theta}_{\psi}=\left[\begin{array}{c}
0\\
0\\
\psi-\hat{\psi}
\end{array}\right].\label{eq:96}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
然后我们定义
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\boldsymbol{\Delta} & \triangleq\delta\boldsymbol{\theta}_{\phi}+\delta\boldsymbol{\theta}_{\theta}+\delta\boldsymbol{\theta}_{\psi}\\
 & =\left[\begin{array}{c}
\phi-\hat{\phi}\\
\theta-\hat{\theta}\\
\psi-\hat{\psi}
\end{array}\right].
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
再一次需要注意的是，在一般情况下
\begin_inset Formula $\delta\boldsymbol{\theta}\neq\boldsymbol{\Delta}$
\end_inset

。
\end_layout

\begin_layout Standard
我们现在希望用
\begin_inset Formula $\delta\boldsymbol{\theta}_{\psi}$
\end_inset

、
\begin_inset Formula $\delta\boldsymbol{\theta}_{\theta}$
\end_inset

和
\begin_inset Formula $\delta\boldsymbol{\theta}_{\phi}$
\end_inset

来解
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

。对于iRN的情况，从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)开始，利用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:38"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们发现
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}= & \hat{\mathbf{q}}^{-1}\otimes\mathbf{q}\\
= & \hat{\mathbf{q}}_{\phi}^{-1}\otimes\hat{\mathbf{q}}_{\theta}^{-1}\otimes\hat{\mathbf{q}}_{\psi}^{-1}\otimes\\
 & \otimes\hat{\mathbf{q}}_{\psi}\otimes\delta\mathbf{q}_{\psi}\otimes\hat{\mathbf{q}}_{\theta}\otimes\delta\mathbf{q}_{\theta}\otimes\hat{\mathbf{q}}_{\phi}\otimes\delta\mathbf{q}_{\phi}\\
= & \left(\hat{\mathbf{q}}_{\phi}^{-1}\otimes\left(\hat{\mathbf{q}}_{\theta}^{-1}\otimes\delta\mathbf{q}_{\psi}\otimes\hat{\mathbf{q}}_{\theta}\right)\otimes\delta\mathbf{q}_{\theta}\otimes\hat{\mathbf{q}}_{\phi}\right)\otimes\delta\mathbf{q}_{\phi},
\end{aligned}
\]

\end_inset

从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:42"
plural "false"
caps "false"
noprefix "false"

\end_inset

)来看，这意味着
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\theta}=\mathbf{R}_{\hat{\phi}}\mathbf{R}_{\hat{\theta}}\delta\boldsymbol{\theta}_{\psi}+\mathbf{R}_{\hat{\phi}}\delta\boldsymbol{\theta}_{\theta}+\delta\boldsymbol{\theta}_{\phi}.\label{eq:97}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
我们可以用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:36"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:96"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:97"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，用
\begin_inset Formula $\boldsymbol{\Delta}$
\end_inset

的项表示
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\boldsymbol{\theta} & =\left[\begin{array}{c}
(\phi-\hat{\phi})-(\psi-\hat{\psi})\sin\hat{\theta}\\
(\theta-\hat{\theta})\cos\hat{\phi}+(\psi-\hat{\psi})\sin\hat{\phi}\cos\hat{\theta}\\
-(\theta-\hat{\theta})\sin\hat{\phi}+(\psi-\hat{\psi})\cos\hat{\phi}\cos\hat{\theta}
\end{array}\right]\nonumber \\
 & =\left[\begin{array}{ccc}
1 & 0 & -\sin\hat{\theta}\\
0 & \cos\hat{\phi} & \sin\hat{\phi}\cos\hat{\theta}\\
0 & -\sin\hat{\phi} & \cos\hat{\phi}\cos\hat{\theta}
\end{array}\right]\boldsymbol{\Delta}.\label{eq:98}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:98"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中矩阵的行列式等于
\begin_inset Formula $\cos\hat{\theta}$
\end_inset

。因此，假设
\begin_inset Formula $\hat{\theta}\neq\pm\dfrac{\pi}{2}$
\end_inset

，我们对
\begin_inset Formula $\boldsymbol{\Delta}$
\end_inset

求解方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:98"
plural "false"
caps "false"
noprefix "false"

\end_inset

)为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Delta}=\left[\begin{array}{ccc}
1 & \sin\hat{\phi}\tan\hat{\theta} & \cos\hat{\phi}\tan\hat{\theta}\\
0 & \cos\hat{\phi} & -\sin\hat{\phi}\\
0 & \sin\hat{\phi}\sec\hat{\theta} & \cos\hat{\phi}\sec\hat{\theta}
\end{array}\right]\delta\boldsymbol{\theta},\label{eq:99}
\end{equation}

\end_inset

我们从中获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{N}_{\boldsymbol{\Delta}}\triangleq\dfrac{\partial\boldsymbol{\Delta}}{\partial\delta\boldsymbol{\theta}}=\left[\begin{array}{ccc}
1 & \sin\hat{\phi}\tan\hat{\theta} & \cos\hat{\phi}\tan\hat{\theta}\\
0 & \cos\hat{\phi} & -\sin\hat{\phi}\\
0 & \sin\hat{\phi}\sec\hat{\theta} & \cos\hat{\phi}\sec\hat{\theta}
\end{array}\right].\label{eq:100}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
类似的程序可用于推导bRN情况下的Jacobian矩阵
\begin_inset Formula $\mathbf{N}_{\boldsymbol{\Delta}}$
\end_inset

。然而，对于bRN情况，横滚、俯仰和偏航的定义和解释不太明显，因此我们将省略
\begin_inset Formula $\mathbf{N}_{\boldsymbol{\Delta}}$
\end_inset

的推导，而是在文中推导相关表达式。
\end_layout

\begin_layout Section
零均值误差状态
\begin_inset CommandInset label
LatexCommand label
name "sec:B"

\end_inset


\end_layout

\begin_layout Standard
在本附录中，我们证明了期望的误差状态仍然是零均值。具体地说，我们证明了误差状态的期望值为零，如方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:45"
plural "false"
caps "false"
noprefix "false"

\end_inset

)所示，并且当估计误差和输入噪声都为零时，误差状态动力学是平凡的。
\end_layout

\begin_layout Subsection
误差状态期望值
\begin_inset CommandInset label
LatexCommand label
name "subsec:B.1"

\end_inset


\end_layout

\begin_layout Standard
特性方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:45"
plural "false"
caps "false"
noprefix "false"

\end_inset

)源于期望和四元数乘法、求逆和
\begin_inset Formula $^{\vee}$
\end_inset

操作。对于下面的推导，回想一下，
\begin_inset Formula $\mathbf{x}$
\end_inset

被建模为一个随机变量，而
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

是给定时间步长的一个常量值。给定方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和
\begin_inset Formula $\hat{\mathbf{x}}=E\left[\mathbf{x}\right]$
\end_inset

，对于状态的向量部分，我们有
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}E\left[\delta\mathbf{x}_{\mathbf{v}}\right] & =E\left[\mathbf{x}_{\mathbf{v}}-\hat{\mathbf{x}}_{\mathbf{v}}\right]\\
 & =E\left[\mathbf{x}_{\mathbf{v}}\right]-\hat{\mathbf{x}}_{\mathbf{v}}\\
 & =\mathbf{0}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)做为方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的姿态误差定义，对于状态的四元数部分，我们有
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}E\left[\delta\mathbf{x}_{\boldsymbol{\theta}}\right] & =E\left[\left(\hat{\mathbf{x}}_{\mathbf{q}}\otimes\mathbf{x}_{\mathbf{q}}{}^{-1}\right)^{\vee}\right]\\
 & =\left(\hat{\mathbf{x}}_{\mathbf{q}}\otimes E\left[\mathbf{x}_{\mathbf{q}}\right]^{-1}\right)^{\vee}\\
 & =\left(\hat{\mathbf{x}}_{\mathbf{q}}\otimes\hat{\mathbf{x}}_{\mathbf{q}}^{-1}\right)^{\vee}\\
 & =\left[\begin{array}{c}
\mathbf{0}\\
1
\end{array}\right]^{\vee}\\
 & =\mathbf{0}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
对于方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的姿态误差定义，也可以进行类似的推导。
\end_layout

\begin_layout Subsection
误差状态动力学
\begin_inset CommandInset label
LatexCommand label
name "subsec:B.2"

\end_inset


\end_layout

\begin_layout Standard
对于状态的向量部分，从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:47"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:50"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中，我们有
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{x}}_{\mathbf{v}} & =\dot{\mathbf{x}}_{\mathbf{v}}-\dot{\hat{\mathbf{x}}}_{\mathbf{v}}\\
 & =\mathbf{f}_{\mathbf{v}}\left(\mathbf{x},\mathbf{u}+\boldsymbol{\nu}\right)+\boldsymbol{\eta}_{\mathbf{v}}-\mathbf{f}_{\mathbf{v}}\left(\hat{\mathbf{x}},\mathbf{u}\right)\\
 & \triangleq\bar{\mathbf{f}}_{\mathbf{v}}\left(\delta\mathbf{x},\boldsymbol{\nu},\hat{\mathbf{x}},\mathbf{u}\right)+\boldsymbol{\eta}_{\mathbf{v}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
我们注意到，使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29"
plural "false"
caps "false"
noprefix "false"

\end_inset

)并重新排列方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，可以用
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

和
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

重写
\begin_inset Formula $\mathbf{x}$
\end_inset

，并且当
\begin_inset Formula $\delta\mathbf{x}=\mathbf{0}$
\end_inset

时，
\begin_inset Formula $\mathbf{x}=\hat{\mathbf{x}}$
\end_inset

。在
\begin_inset Formula $\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}\right)$
\end_inset

处评估
\begin_inset Formula $\bar{\mathbf{f}}_{\mathbf{v}}$
\end_inset

，其中
\begin_inset Formula $E\left[\delta\mathbf{x}\right]=E\left[\boldsymbol{\nu}\right]=\mathbf{0}$
\end_inset

，然后给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\bar{\mathbf{f}}_{\mathbf{v}}\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}\right) & =\mathbf{f}_{\mathbf{v}}\left(\hat{\mathbf{x}},\mathbf{u}\right)-\mathbf{f}_{\mathbf{v}}\left(\hat{\mathbf{x}},\mathbf{u}\right)\\
 & =\mathbf{0}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
对于状态的四元数部分，对于iRN，我们从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)开始：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{x}_{\mathbf{q}} & =\hat{\mathbf{x}}_{\mathbf{q}}\otimes\left(\delta\mathbf{x}_{\boldsymbol{\theta}}\right)^{\wedge}\\
\Longrightarrow\dot{\mathbf{x}}_{\mathbf{q}} & =\dot{\hat{\mathbf{x}}}_{\mathbf{q}}\otimes\left(\delta\mathbf{x}_{\boldsymbol{\theta}}\right)^{\wedge}+\hat{\mathbf{x}}_{\mathbf{q}}\otimes\left(\delta\dot{\mathbf{x}}_{\boldsymbol{\theta}}\right)^{\wedge}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
左乘
\begin_inset Formula $\left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}$
\end_inset

给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}\otimes\dot{\mathbf{x}}_{\mathbf{q}}= & \left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}\otimes\dot{\hat{\mathbf{x}}}_{\mathbf{q}}\otimes\left(\delta\mathbf{x}_{\boldsymbol{\theta}}\right)^{\wedge}+\left(\delta\dot{\mathbf{x}}_{\boldsymbol{\theta}}\right)^{\wedge}\\
\Longrightarrow\delta\dot{\mathbf{x}}_{\boldsymbol{\theta}}= & \left(\left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}\otimes\dot{\mathbf{x}}_{\mathbf{q}}-\left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}\otimes\dot{\hat{\mathbf{x}}}_{\mathbf{q}}\otimes\left(\delta\mathbf{x}_{\boldsymbol{\theta}}\right)^{\wedge}\right)^{\vee}\\
= & \left(\left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}\otimes\mathbf{f}_{\mathbf{q}}(\mathbf{x},\mathbf{u}+\boldsymbol{\nu})\right.\\
 & \left.-\left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}\otimes\mathbf{f}_{\mathbf{q}}(\hat{\mathbf{x}},\mathbf{u})\otimes\left(\delta\mathbf{x}_{\boldsymbol{\theta}}\right)^{\wedge}\right)^{\vee}\\
\triangleq & \bar{\mathbf{f}}_{\mathbf{q}}\left(\delta\mathbf{x},\boldsymbol{\nu},\hat{\mathbf{x}},\mathbf{u}\right),
\end{aligned}
\]

\end_inset

其中
\begin_inset Formula $\mathbf{x}$
\end_inset

又可以用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)重写为
\begin_inset Formula $\delta\mathbf{x}$
\end_inset

和
\begin_inset Formula $\hat{\mathbf{x}}$
\end_inset

。注意，我们省略了过程噪声
\begin_inset Formula $\boldsymbol{\eta}$
\end_inset

，因为本文中的四元数传播动力学是精确的运动学表达式。在
\begin_inset Formula $\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}\right)$
\end_inset

处评估
\begin_inset Formula $\bar{\mathbf{f}}_{\mathbf{q}}$
\end_inset

，给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\bar{\mathbf{f}}_{\mathbf{q}}\left(E\left[\delta\mathbf{x}\right],E\left[\boldsymbol{\nu}\right],\hat{\mathbf{x}},\mathbf{u}\right)= & \left(\left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}\otimes\mathbf{f}_{\mathbf{q}}\left(\hat{\mathbf{x}},\mathbf{u}\right)\right.\\
 & \left.-\left(\hat{\mathbf{x}}_{\mathbf{q}}\right)^{-1}\otimes\mathbf{f}_{\mathbf{q}}\left(\hat{\mathbf{x}},\mathbf{u}\right)\otimes\mathbf{0}^{\wedge}\right)^{\vee}\\
= & \mathbf{0}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
类似的分析可以用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中的bRN姿态误差定义进行。
\end_layout

\begin_layout Section
惯性动力学
\begin_inset CommandInset label
LatexCommand label
name "sec:C"

\end_inset


\end_layout

\begin_layout Standard
本附录推导了惯性定义状态的误差状态动力学。
\end_layout

\begin_layout Subsection
位置
\end_layout

\begin_layout Standard
我们从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)开始：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{p}}_{n}^{b} & =\dot{\mathbf{p}}_{n}^{b}-\dot{\hat{\mathbf{p}}}_{n}^{b}\\
 & =\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{b}\right)\mathbf{v}-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\hat{\mathbf{v}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
然后我们使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:34"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

)以获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{p}}_{n}^{b}= & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{R}^{\top}\left(\delta\mathbf{q}_{n}^{b}\right)\left(\hat{\mathbf{v}}+\delta\mathbf{v}\right)-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\hat{\mathbf{v}}\\
\approx & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left(\mathbf{I}+\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \right)\left(\hat{\mathbf{v}}+\delta\mathbf{v}\right)-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\hat{\mathbf{v}}\\
= & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\hat{\mathbf{v}}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \hat{\mathbf{v}}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\delta\mathbf{v}\\
 & \ +\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \delta\mathbf{v}-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\hat{\mathbf{v}}\\
= & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \hat{\mathbf{v}}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\delta\mathbf{v}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \delta\mathbf{v}\\
= & -\mathbf{R}^{\mathrm{T}}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}+\mathbf{R}^{\mathrm{T}}\left(\hat{\mathbf{q}}_{n}^{b}\right)\delta\mathbf{v}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \delta\mathbf{v}\\
\approx & -\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{n}^{b}\right)\delta\mathbf{v},
\end{aligned}
\]

\end_inset

其中二阶项已被删除。
\end_layout

\begin_layout Subsection
姿态
\end_layout

\begin_layout Standard
我们从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)开始，相对于时间进行微分：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{n}^{b} & =\hat{\mathbf{q}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}\\
\Longrightarrow\dot{\mathbf{q}}_{n}^{b} & =\dot{\mathbf{q}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}+\hat{\mathbf{q}}_{n}^{b}\otimes\delta\dot{\mathbf{q}}_{n}^{b}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
左乘
\begin_inset Formula $\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}$
\end_inset

给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\dot{\mathbf{q}}_{n}^{b} & =\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\dot{\hat{\mathbf{q}}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}+\delta\dot{\mathbf{q}}_{n}^{b}\\
\Longrightarrow\delta\dot{\mathbf{q}}_{n}^{b} & =\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\dot{\mathbf{q}}_{n}^{b}-\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\dot{\mathbf{q}}_{n}^{b}\otimes\delta\mathbf{q}_{n}^{b}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:80b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:81a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，并简化所得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\dot{\mathbf{q}}_{n}^{b} & =\dfrac{1}{2}\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]-\dfrac{1}{2}\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\hat{\mathbf{q}}_{n}^{b}\otimes\left[\begin{array}{c}
\hat{\boldsymbol{\omega}}\\
0
\end{array}\right]\otimes\delta\mathbf{q}_{n}^{b}\nonumber \\
 & =\dfrac{1}{2}\delta\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]-\dfrac{1}{2}\left[\begin{array}{c}
\hat{\boldsymbol{\omega}}\\
0
\end{array}\right]\otimes\delta\mathbf{q}_{n}^{b}.\label{eq:101}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:72a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:73"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，设
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
\delta\boldsymbol{\omega} & \triangleq\boldsymbol{\omega}-\hat{\boldsymbol{\omega}}\label{eq:102a}\\
 & =\left(\tilde{\boldsymbol{\omega}}-\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\nu}_{\boldsymbol{\omega}}\right)-\left(\tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right)\nonumber \\
 & =-\left(\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}+\delta\boldsymbol{\beta}_{\boldsymbol{\omega}}\right)-\boldsymbol{\nu}_{\boldsymbol{\omega}}+\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\nonumber \\
 & =-\delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\nu}_{\boldsymbol{\omega}}.\label{eq:102b}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:3"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:102a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)应用于方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:101"
plural "false"
caps "false"
noprefix "false"

\end_inset

)得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{q}}_{n}^{b} & =\dfrac{1}{2}\left[\begin{array}{cc}
-\left\lfloor \boldsymbol{\omega}\right\rfloor  & \boldsymbol{\omega}\\
-\boldsymbol{\omega}^{\top} & 0
\end{array}\right]\delta\mathbf{q}_{n}^{b}-\dfrac{1}{2}\left[\begin{array}{cc}
\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor  & \hat{\boldsymbol{\omega}}\\
-\hat{\boldsymbol{\omega}}^{\top} & 0
\end{array}\right]\delta\mathbf{q}_{n}^{b}\\
 & =\dfrac{1}{2}\left[\begin{array}{cc}
\left\lfloor -2\hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor  & \delta\boldsymbol{\omega}\\
-\delta\boldsymbol{\omega}^{\top} & 0
\end{array}\right]\delta\mathbf{q}_{n}^{b},
\end{aligned}
\]

\end_inset

这意味着
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left[\begin{array}{c}
\dfrac{1}{2}\delta\dot{\boldsymbol{\theta}}_{n}^{b}\\
1
\end{array}\right]=\dfrac{1}{2}\left[\begin{array}{cc}
\left\lfloor -2\hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor  & \delta\boldsymbol{\omega}\\
-\delta\boldsymbol{\omega}^{\top} & 0
\end{array}\right]\left[\begin{array}{c}
\dfrac{1}{2}\delta\boldsymbol{\theta}_{n}^{b}\\
1
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
抛弃标量方程和二阶项，得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\boldsymbol{\theta}}_{n}^{b} & =\dfrac{1}{2}\left\lfloor -2\hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}+\delta\boldsymbol{\omega}\\
 & \approx-\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}+\delta\boldsymbol{\omega}\\
 & \approx-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}-\delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\nu}_{\boldsymbol{\omega}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Subsection
速度
\end_layout

\begin_layout Standard
我们首先将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)应用于动力学：
\end_layout

\begin_layout Standard
\begin_inset Flex Subequations
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "eq:103"

\end_inset


\begin_inset Formula 
\begin{align}
\delta\dot{\mathbf{v}}= & \left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}+\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{g}+a_{z}\mathbf{k}-\mu\boldsymbol{\Pi}_{\mathbf{k}}\mathbf{v}+\boldsymbol{\eta}_{\mathbf{v}}\nonumber \\
 & -\left(\left\lfloor \hat{\mathbf{v}}\right\rfloor \hat{\boldsymbol{\omega}}+\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}+\hat{a}_{z}\mathbf{k}-\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\right)\nonumber \\
= & \left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}-\left\lfloor \hat{\mathbf{v}}\right\rfloor \hat{\boldsymbol{\omega}}\label{eq:103a}\\
 & +\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{g}-\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}\label{eq:103b}\\
 & -\mu\boldsymbol{\Pi}_{\mathbf{k}}\mathbf{v}+\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\label{eq:103c}\\
 & +a_{z}\mathbf{k}-\hat{a}_{z}\mathbf{k}\label{eq:103d}\\
 & +\boldsymbol{\eta}_{\mathbf{v}}.\nonumber 
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
我们逐项简化方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:103"
plural "false"
caps "false"
noprefix "false"

\end_inset

)。我们用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:102a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开方程项(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:103a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，去掉二阶项，然后用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:73"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:102b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\left\lfloor \mathbf{v}\right\rfloor \boldsymbol{\omega}-\left\lfloor \hat{\mathbf{v}}\right\rfloor \hat{\boldsymbol{\omega}} & \approx\left\lfloor \hat{\mathbf{v}}+\delta\mathbf{v}\right\rfloor \left(\hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right)-\left\lfloor \hat{\mathbf{v}}\right\rfloor \left(\hat{\boldsymbol{\omega}}\right)\\
 & =\left\lfloor \delta\mathbf{v}\right\rfloor \hat{\boldsymbol{\omega}}+\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\omega}\\
 & =-\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor \delta\mathbf{v}+\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\omega}\\
 & =-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\mathbf{v}+\left\lfloor \hat{\mathbf{v}}\right\rfloor \left(-\delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\nu}_{\boldsymbol{\omega}}\right)\\
 & =-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\mathbf{v}-\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\left\lfloor \hat{\mathbf{v}}\right\rfloor \boldsymbol{\nu}_{\boldsymbol{\omega}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
对于方程项(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:103b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:33"
plural "false"
caps "false"
noprefix "false"

\end_inset

)以获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{g}-\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g} & =\mathbf{R}\left(\delta\mathbf{q}_{n}^{b}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}-\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}\\
 & \approx\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \right)\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}-\mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}\\
 & =-\left\lfloor \delta\boldsymbol{\theta}_{n}^{b}\right\rfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}\\
 & =\left\lfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
我们使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)并去掉二阶项，将方程项(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:103c"
plural "false"
caps "false"
noprefix "false"

\end_inset

)简化为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}-\mu\boldsymbol{\Pi}_{\mathbf{k}}\mathbf{v}+\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}} & =-\left(\hat{\mu}+\delta\mu\right)\boldsymbol{\Pi}_{\mathbf{k}}\left(\hat{\mathbf{v}}+\delta\mathbf{v}\right)+\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\\
 & =-\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\delta\mathbf{v}-\delta\mu\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}-\delta\mu\boldsymbol{\Pi}_{\mathbf{k}}\delta\mathbf{v}\\
 & =-\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\delta\mathbf{v}-\delta\mu\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
最后，使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:72b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:74"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)将方程项(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:103d"
plural "false"
caps "false"
noprefix "false"

\end_inset

)简化为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}a_{z}\mathbf{k}-\hat{a}_{z}\mathbf{k} & =\left(\tilde{a}_{z}-\beta_{\mathbf{a}_{z}}-\eta_{\mathbf{a}_{z}}\right)\mathbf{k}-\left(\tilde{a}_{z}-\hat{\beta}_{\mathbf{a}_{z}}\right)\mathbf{k}\\
 & =\left(-\delta\beta_{\mathbf{a}_{z}}-\eta_{\mathbf{a}_{z}}\right)\mathbf{k}\\
 & =-\mathbf{k}\mathbf{k}^{\top}\delta\beta_{\mathbf{a}}-\mathbf{k}\eta_{\mathbf{a}_{z}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
将所有这些结果代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:103"
plural "false"
caps "false"
noprefix "false"

\end_inset

)并收集各项给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\delta\dot{\mathbf{v}}= & \left\lfloor \mathbf{R}\left(\hat{\mathbf{q}}_{n}^{b}\right)\mathbf{g}\right\rfloor \delta\boldsymbol{\theta}_{n}^{b}+\left(-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor -\hat{\mu}\boldsymbol{\Pi}_{\mathbf{k}}\right)\delta\mathbf{v}-\mathbf{k}\mathbf{k}^{\top}\delta\boldsymbol{\beta}_{\mathbf{a}}\\
 & -\left\lfloor \hat{\mathbf{v}}\right\rfloor \delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\Pi}_{\mathbf{k}}\hat{\mathbf{v}}\delta\mu-\left\lfloor \hat{\mathbf{v}}\right\rfloor \boldsymbol{\nu}_{\boldsymbol{\omega}}-\mathbf{k}\eta_{\mathbf{a}_{z}}+\boldsymbol{\eta}_{\mathbf{v}}.
\end{align*}

\end_inset


\end_layout

\begin_layout Section
机体固连动力学
\begin_inset CommandInset label
LatexCommand label
name "sec:D"

\end_inset


\end_layout

\begin_layout Standard
本附录从惯性对应物中推导出机体固连状态动力学，然后推导出机体固连误差状态动力学。
\end_layout

\begin_layout Subsection
位置
\end_layout

\begin_layout Standard
我们将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:90"
plural "false"
caps "false"
noprefix "false"

\end_inset

)表示为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left[\begin{array}{c}
\mathbf{p}_{b}^{n}\\
0
\end{array}\right]=-\left(\mathbf{q}_{n}^{b}\right)^{-1}\otimes\left[\begin{array}{c}
\mathbf{p}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}.
\]

\end_inset


\end_layout

\begin_layout Standard
左乘
\begin_inset Formula $\mathbf{q}_{n}^{b}$
\end_inset

，取时间导数，再左乘
\begin_inset Formula $\left(\mathbf{q}_{n}^{b}\right)^{-1}$
\end_inset

得出以下方程式序列：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\mathbf{p}_{b}^{n}\\
0
\end{array}\right]= & -\left[\begin{array}{c}
\mathbf{p}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}\\
\dot{\mathbf{q}}_{n}^{b}\otimes\left[\begin{array}{c}
\mathbf{p}_{b}^{n}\\
0
\end{array}\right]+\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\dot{\mathbf{p}}_{b}^{n}\\
0
\end{array}\right]= & -\left[\begin{array}{c}
\dot{\mathbf{p}}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}-\left[\begin{array}{c}
\mathbf{p}_{n}^{b}\\
0
\end{array}\right]\otimes\dot{\mathbf{q}}_{n}^{b}\\
\dfrac{1}{2}\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\left[\begin{array}{c}
\mathbf{p}_{b}^{n}\\
0
\end{array}\right]+\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\dot{\mathbf{p}}_{b}^{n}\\
0
\end{array}\right]= & -\left[\begin{array}{c}
\dot{\mathbf{p}}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}-\dfrac{1}{2}\left[\begin{array}{c}
\mathbf{p}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{l}
\boldsymbol{\omega}\\
0
\end{array}\right]\\
\dfrac{1}{2}\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\left[\begin{array}{c}
\mathbf{p}_{b}^{n}\\
0
\end{array}\right]+\left[\begin{array}{c}
\dot{\mathbf{p}}_{b}^{n}\\
0
\end{array}\right]= & -\left(\mathbf{q}_{n}^{b}\right)^{-1}\otimes\left[\begin{array}{c}
\dot{\mathbf{p}}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}\\
 & -\dfrac{1}{2}\left(\mathbf{q}_{n}^{b}\right)^{-1}\left[\begin{array}{c}
\mathbf{p}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{l}
\boldsymbol{\omega}\\
0
\end{array}\right].
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
重新排列并使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:90"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:7"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:80a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:3"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

)给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\left[\begin{array}{c}
\dot{\mathbf{p}}_{b}^{n}\\
0
\end{array}\right]= & -\left(\mathbf{q}_{n}^{b}\right)^{-1}\otimes\left[\begin{array}{c}
\dot{\mathbf{p}}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}-\dfrac{1}{2}\left(\mathbf{q}_{n}^{b}\right)^{-1}\left[\begin{array}{c}
\mathbf{p}_{n}^{b}\\
0
\end{array}\right]\otimes\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\\
 & -\dfrac{1}{2}\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\left[\begin{array}{c}
\mathbf{p}_{b}^{n}\\
0
\end{array}\right]\\
= & -\left[\begin{array}{c}
\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{p}_{n}^{b}\\
0
\end{array}\right]+\dfrac{1}{2}\left[\begin{array}{c}
\mathbf{p}_{b}^{n}\\
0
\end{array}\right]\otimes\left[\begin{array}{l}
\boldsymbol{\omega}\\
0
\end{array}\right]-\dfrac{1}{2}\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\left[\begin{array}{c}
\mathbf{p}_{b}^{n}\\
0
\end{array}\right]\\
= & -\left[\begin{array}{c}
\mathbf{v}\\
0
\end{array}\right]+\dfrac{1}{2}\left[\begin{array}{c}
\left\lfloor \mathbf{p}_{b}^{n}\right\rfloor \boldsymbol{\omega}\\
-\mathbf{p}_{b}^{n}{}^{\top}\boldsymbol{\omega}
\end{array}\right]-\dfrac{1}{2}\left[\begin{array}{l}
\left\lfloor \boldsymbol{\omega}\right\rfloor \mathbf{p}_{b}^{n}\\
-\boldsymbol{\omega}^{\top}\mathbf{p}_{b}^{n}
\end{array}\right]\\
= & -\left[\begin{array}{c}
\mathbf{v}\\
0
\end{array}\right]-\dfrac{1}{2}\left[\begin{array}{c}
\left\lfloor \boldsymbol{\omega}\right\rfloor \mathbf{p}_{b}^{n}\\
\mathbf{p}_{b}^{n}{}^{\top}\boldsymbol{\omega}
\end{array}\right]-\dfrac{1}{2}\left[\begin{array}{c}
\left\lfloor \boldsymbol{\omega}\right\rfloor \mathbf{p}_{b}^{n}\\
-\boldsymbol{\omega}^{\top}\mathbf{p}_{b}^{n}
\end{array}\right].
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
抛开标量方程，我们发现
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\dot{\mathbf{p}}_{b}^{n}=-\mathbf{v}-\left\lfloor \boldsymbol{\omega}\right\rfloor \mathbf{p}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
设
\begin_inset Formula $\delta\boldsymbol{\omega}=\boldsymbol{\omega}-\hat{\boldsymbol{\omega}}$
\end_inset

，当使用机体帧时的误差状态位置动力学为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{p}}_{b}^{n}= & \dot{\mathbf{p}}_{b}^{n}-\dot{\hat{\mathbf{p}}}_{b}^{n}\\
= & \left(-\mathbf{v}-\left\lfloor \boldsymbol{\omega}\right\rfloor \mathbf{p}_{b}^{n}\right)-\left(-\hat{\mathbf{v}}-\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor \hat{\mathbf{p}}_{b}^{n}\right)\\
= & -\hat{\mathbf{v}}-\delta\mathbf{v}-\left\lfloor \hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor \hat{\mathbf{p}}_{b}^{n}-\left\lfloor \hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor \delta\mathbf{p}_{b}^{n}\\
 & +\hat{\mathbf{v}}+\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor \hat{\mathbf{p}}_{b}^{n}\\
= & -\delta\mathbf{v}-\left\lfloor \delta\boldsymbol{\omega}\right\rfloor \hat{\mathbf{p}}_{b}^{n}-\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor \delta\mathbf{p}_{b}^{n}\\
= & -\delta\mathbf{v}+\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \delta\boldsymbol{\omega}-\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor \delta\mathbf{p}_{b}^{n}\\
= & -\delta\mathbf{v}+\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \left(-\delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\boldsymbol{\nu}_{\boldsymbol{\omega}}\right)-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\mathbf{p}_{b}^{n}\\
= & -\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\mathbf{p}_{b}^{n}-\delta\mathbf{v}-\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \delta\boldsymbol{\beta}_{\boldsymbol{\omega}}-\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \boldsymbol{\nu}_{\boldsymbol{\omega}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Subsection
姿态
\end_layout

\begin_layout Standard
机体固连姿态动力学由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:27"
plural "false"
caps "false"
noprefix "false"

\end_inset

)定义。它们可以交替地从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:91"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:26"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中推导出，如下所示
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{q}}_{b}^{n} & =\left(\dot{\mathbf{q}}_{n}^{b}\right)^{-1}\\
 & =\dfrac{1}{2}\left(\mathbf{q}_{n}^{b}\otimes\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\right)^{-1}\\
 & =\dfrac{1}{2}\left[\begin{array}{c}
-\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\left(\mathbf{q}_{n}^{b}\right)^{-1}\\
 & =-\dfrac{1}{2}\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\mathbf{q}_{b}^{n}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
利用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，将机体固连姿态分解为一个估计和一个误差状态，即
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}_{b}^{n}=\delta\mathbf{q}_{b}^{n}\otimes\hat{\mathbf{q}}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
相对于时间进行微分，给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\dot{\mathbf{q}}_{b}^{n}=\delta\dot{\mathbf{q}}_{b}^{n}\otimes\hat{\mathbf{q}}_{b}^{n}+\delta\mathbf{q}_{b}^{n}\otimes\dot{\hat{\mathbf{q}}}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
求解姿态误差动力学方程，并使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:92a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:3"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，结果为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{q}}_{b}^{n} & =\left(\dot{\mathbf{q}}_{b}^{n}-\delta\mathbf{q}_{b}^{n}\otimes\dot{\hat{\mathbf{q}}}_{b}^{n}\right)\otimes\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\\
 & =-\dfrac{1}{2}\left(\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\mathbf{q}_{b}^{n}-\delta\mathbf{q}_{b}^{n}\otimes\left[\begin{array}{c}
\hat{\boldsymbol{\omega}}\\
0
\end{array}\right]\otimes\hat{\mathbf{q}}_{b}^{n}\right)\otimes\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\\
 & =-\dfrac{1}{2}\left(\left[\begin{array}{c}
\boldsymbol{\omega}\\
0
\end{array}\right]\otimes\delta\mathbf{q}_{b}^{n}-\delta\mathbf{q}_{b}^{n}\otimes\left[\begin{array}{c}
\hat{\boldsymbol{\omega}}\\
0
\end{array}\right]\right)\\
 & =-\dfrac{1}{2}\left(\left[\begin{array}{cc}
\left\lfloor \boldsymbol{\omega}\right\rfloor  & \boldsymbol{\omega}\\
-\boldsymbol{\omega}^{\top} & 0
\end{array}\right]\delta\mathbf{q}_{b}^{n}-\left[\begin{array}{cc}
-\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor  & \hat{\boldsymbol{\omega}}\\
-\hat{\boldsymbol{\omega}}^{\top} & 0
\end{array}\right]\delta\mathbf{q}_{b}^{n}\right)\\
 & =-\dfrac{1}{2}\left[\begin{array}{cc}
\left\lfloor 2\hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor  & \delta\boldsymbol{\omega}\\
-\delta\boldsymbol{\omega}^{\top} & 0
\end{array}\right]\delta\mathbf{q}_{b}^{n},
\end{aligned}
\]

\end_inset

其中鉴于方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:32"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，这意味着
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left[\begin{array}{c}
\dfrac{1}{2}\dot{\boldsymbol{\theta}}_{b}^{n}\\
1
\end{array}\right]=-\dfrac{1}{2}\left[\begin{array}{cc}
\left\lfloor 2\hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor  & \delta\boldsymbol{\omega}\\
-\delta\boldsymbol{\omega}^{\top} & 0
\end{array}\right]\left[\begin{array}{c}
\dfrac{1}{2}\delta\boldsymbol{\theta}_{b}^{n}\\
1
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
将两边乘以
\begin_inset Formula $2$
\end_inset

，去掉标量项，忽略高阶项，得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\boldsymbol{\theta}}_{b}^{n} & =-\left[\begin{array}{cc}
\left\lfloor 2\hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor  & \delta\boldsymbol{\omega}\end{array}\right]\left[\begin{array}{c}
\dfrac{1}{2}\delta\boldsymbol{\theta}_{b}^{n}\\
1
\end{array}\right]\\
 & =-\dfrac{1}{2}\left\lfloor 2\hat{\boldsymbol{\omega}}+\delta\boldsymbol{\omega}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}-\delta\boldsymbol{\omega}\\
 & \approx-\left\lfloor \hat{\boldsymbol{\omega}}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}-\delta\boldsymbol{\omega}\\
 & =-\left\lfloor \tilde{\boldsymbol{\omega}}-\hat{\boldsymbol{\beta}}_{\boldsymbol{\omega}}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}+\delta\boldsymbol{\beta}_{\boldsymbol{\omega}}+\boldsymbol{\nu}_{\boldsymbol{\omega}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Subsection
速度
\end_layout

\begin_layout Standard
速度误差动力学中唯一的变化是重力项，所以
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\dot{\mathbf{v}} & =\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{g}-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}\\
 & =\mathbf{R}^{\top}\left(\delta\mathbf{q}_{b}^{n}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}\\
 & \approx\left(\mathbf{I}+\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}-\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}\\
 & =\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}\\
 & =-\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{g}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Section
关键帧重置推导
\begin_inset CommandInset label
LatexCommand label
name "sec:E"

\end_inset


\end_layout

\begin_layout Standard
在关键帧重置步骤期间，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:5"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节介绍，第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:6.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节和第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:7.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节详述，相对状态及其相关协方差重置为零。对于位置状态，仅保持车辆的高度，而对于姿态状态，与偏航相关的不确定性从滤波器中去除，而与横滚和俯仰相关的不确定性保持不
变。附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:E.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:E.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 表明
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{N}_{\boldsymbol{\theta}}\triangleq\dfrac{\partial\delta\boldsymbol{\theta}^{+}}{\partial\delta\boldsymbol{\theta}}=\left[\begin{array}{ccc}
1 & \sin\hat{\phi}\tan\hat{\theta} & \cos\hat{\phi}\tan\hat{\theta}\\
0 & \cos^{2}\hat{\phi} & -\cos\hat{\phi}\sin\hat{\phi}\\
0 & -\cos\hat{\phi}\sin\hat{\phi} & \sin^{2}\hat{\phi}
\end{array}\right]\label{eq:104}
\end{equation}

\end_inset

对于iRN和bRN姿态定义都成立。附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:E.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 推导了bRN的位置重置及其Jacobian矩阵。
\end_layout

\begin_layout Subsection
iRN姿态重置
\begin_inset CommandInset label
LatexCommand label
name "subsec:E.1"

\end_inset


\end_layout

\begin_layout Standard
回想一下附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:A"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:99"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，欧拉角误差
\begin_inset Formula $\boldsymbol{\Delta}$
\end_inset

与姿态误差状态
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

的关系为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Delta}_{n}^{b}=\left[\begin{array}{ccc}
1 & \sin\hat{\phi}\tan\hat{\theta} & \cos\hat{\phi}\tan\hat{\theta}\\
0 & \cos\hat{\phi} & -\sin\hat{\phi}\\
0 & \sin\hat{\phi}\sec\hat{\theta} & \cos\hat{\phi}\sec\hat{\theta}
\end{array}\right]\delta\boldsymbol{\theta}_{n}^{b}.\label{eq:105}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
关键帧重置步骤后真实的和估计的姿态状态包括重置前姿态的横滚和俯仰分量，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{n}^{b}{}^{+} & =\mathbf{q}_{\theta}\otimes\mathbf{q}_{\phi},\\
\hat{\mathbf{q}}_{n}^{b}{}^{+} & =\hat{\mathbf{q}}_{\theta}\otimes\hat{\mathbf{q}}_{\phi}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
由此产生的姿态误差由方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)得出，为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}_{n}^{b}{}^{+} & =\left(\hat{\mathbf{q}}_{n}^{b}{}^{+}\right)^{-1}\otimes\mathbf{q}_{n}^{b}{}^{+}\\
 & =\hat{\mathbf{q}}_{\phi}^{-1}\otimes\hat{\mathbf{q}}_{\theta}^{-1}\otimes\mathbf{q}_{\theta}\otimes\mathbf{q}_{\phi}\\
 & =\hat{\mathbf{q}}_{\phi}^{-1}\otimes\hat{\mathbf{q}}_{\theta}^{-1}\otimes\hat{\mathbf{q}}_{\theta}\otimes\delta\mathbf{q}_{\theta}\otimes\hat{\mathbf{q}}_{\phi}\otimes\delta\mathbf{q}_{\phi}\\
 & =\left(\hat{\mathbf{q}}_{\phi}^{-1}\otimes\delta\mathbf{q}_{\theta}\otimes\hat{\mathbf{q}}_{\phi}\right)\otimes\delta\mathbf{q}_{\phi},
\end{aligned}
\]

\end_inset

这与方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:42"
plural "false"
caps "false"
noprefix "false"

\end_inset

)相似，这意味着
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\boldsymbol{\theta}_{n}^{b}{}^{+}=\mathbf{R}_{\phi}\delta\boldsymbol{\theta}_{\theta}+\delta\boldsymbol{\theta}_{\phi}.
\]

\end_inset


\end_layout

\begin_layout Standard
展开并分解出欧拉角误差，这就变成
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\theta}_{n}^{b}{}^{+}=\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & \cos\hat{\phi} & 0\\
0 & -\sin\hat{\phi} & 0
\end{array}\right]\boldsymbol{\Delta}_{n}^{b},\label{eq:106}
\end{equation}

\end_inset

这与方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:98"
plural "false"
caps "false"
noprefix "false"

\end_inset

)的不同之处在于它消除了偏航及其不确定性。将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:105"
plural "false"
caps "false"
noprefix "false"

\end_inset

)代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:106"
plural "false"
caps "false"
noprefix "false"

\end_inset

)我们发现
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\theta}_{n}^{b}{}^{+}=\left[\begin{array}{ccc}
1 & \sin\hat{\phi}\tan\hat{\theta} & \cos\hat{\phi}\tan\hat{\theta}\\
0 & \cos^{2}\hat{\phi} & -\cos\hat{\phi}\sin\hat{\phi}\\
0 & -\cos\hat{\phi}\sin\hat{\phi} & \sin^{2}\hat{\phi}
\end{array}\right]\delta\boldsymbol{\theta}_{n}^{b},\label{eq:107}
\end{equation}

\end_inset

对于iRN验证了方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:104"
plural "false"
caps "false"
noprefix "false"

\end_inset

)。
\end_layout

\begin_layout Subsection
bRN姿态重置
\begin_inset CommandInset label
LatexCommand label
name "subsec:E.2"

\end_inset


\end_layout

\begin_layout Standard
延续第 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:7"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中给出的符号，我们用
\begin_inset Formula $\delta\mathbf{q}_{b}^{n}$
\end_inset

和
\begin_inset Formula $\delta\boldsymbol{\theta}_{b}^{n}$
\end_inset

来描述bRN的姿态误差。典型的
\begin_inset Formula $3–2–1$
\end_inset

欧拉角假设惯性姿态。要在保持直观的横滚、俯仰和偏航旋转的同时表示机体固连的姿态，必须将旋转序列的顺序和符号翻转为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{b}^{n} & =\left(\mathbf{q}_{n}^{b}\right)^{-1}\\
 & =\left(\mathbf{q}_{\psi}\otimes\mathbf{q}_{\theta}\otimes\mathbf{q}_{\phi}\right)^{-1}\\
 & =\mathbf{q}_{\phi}{}^{-1}\otimes\mathbf{q}_{\theta}{}^{-1}\otimes\mathbf{q}_{\psi}{}^{-1}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
使用误差状态定义方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)进行扩展，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{n}=\hat{\mathbf{q}}_{\phi}{}^{-1}\otimes\delta\mathbf{q}_{\phi}{}^{-1}\otimes\hat{\mathbf{q}}_{\theta}{}^{-1}\otimes\delta\mathbf{q}_{\theta}{}^{-1}\otimes\hat{\mathbf{q}}_{\psi}{}^{-1}\otimes\delta\mathbf{q}_{\psi}{}^{-1},\label{eq:108}
\end{equation}

\end_inset

其近似为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\mathbf{q}}_{b}^{n}=\hat{\mathbf{q}}_{\phi}{}^{-1}\otimes\hat{\mathbf{q}}_{\theta}{}^{-1}\otimes\hat{\mathbf{q}}_{\psi}{}^{-1}.\label{eq:109}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)组合方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:108"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:109"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}_{b}^{n}= & \mathbf{q}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\\
= & \hat{\mathbf{q}}_{\phi}{}^{-1}\otimes\delta\mathbf{q}_{\phi}{}^{-1}\otimes\hat{\mathbf{q}}_{\theta}{}^{-1}\otimes\delta\mathbf{q}_{\theta}{}^{-1}\otimes\\
 & \ \otimes\hat{\mathbf{q}}_{\psi}{}^{-1}\otimes\delta\mathbf{q}_{\psi}{}^{-1}\otimes\hat{\mathbf{q}}_{\psi}\otimes\hat{\mathbf{q}}_{\theta}\otimes\hat{\mathbf{q}}_{\phi}\\
= & \hat{\mathbf{q}}_{\phi}{}^{-1}\otimes\left(\delta\mathbf{q}_{\phi}{}^{-1}\otimes\hat{\mathbf{q}}_{\theta}{}^{-1}\otimes\left(\delta\mathbf{q}_{\theta}{}^{-1}\otimes\right.\right.\\
 & \ \left.\left.\otimes\hat{\mathbf{q}}_{\psi}{}^{-1}\otimes\delta\mathbf{q}_{\psi}{}^{-1}\otimes\hat{\mathbf{q}}_{\psi}\right)\otimes\hat{\mathbf{q}}_{\theta}\right)\otimes\hat{\mathbf{q}}_{\phi},
\end{aligned}
\]

\end_inset

这意味着
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\theta}_{b}^{n}=-\mathbf{R}_{\phi}\delta\boldsymbol{\theta}_{\phi}-\mathbf{R}_{\phi}\mathbf{R}_{\theta}\delta\boldsymbol{\theta}_{\theta}-\mathbf{R}_{\phi}\mathbf{R}_{\theta}\mathbf{R}_{\psi}\delta\boldsymbol{\theta}_{\psi}.\label{eq:110}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
注意这个
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{R}_{\phi}\delta\boldsymbol{\theta}_{\phi} & =\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & \cos\phi & \sin\phi\\
0 & -\sin\phi & \cos\phi
\end{array}\right]\left[\begin{array}{c}
\phi-\hat{\phi}\\
0\\
0
\end{array}\right]\\
 & =\delta\boldsymbol{\theta}_{\phi}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
类似地，
\begin_inset Formula $\mathbf{R}_{\theta}\delta\boldsymbol{\theta}_{\theta}=\delta\boldsymbol{\theta}_{\theta}$
\end_inset

和
\begin_inset Formula $\mathbf{R}_{\psi}\delta\boldsymbol{\theta}_{\psi}=\delta\boldsymbol{\theta}_{\psi}$
\end_inset

。利用这些结果简化方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:110"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，并将所得方程与iRN的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:97"
plural "false"
caps "false"
noprefix "false"

\end_inset

)进行比较，我们得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\boldsymbol{\theta}_{b}^{n} & =-\delta\boldsymbol{\theta}_{\phi}-\mathbf{R}_{\phi}\delta\boldsymbol{\theta}_{\theta}-\mathbf{R}_{\phi}\mathbf{R}_{\theta}\delta\boldsymbol{\theta}_{\psi}\nonumber \\
 & =-\delta\boldsymbol{\theta}_{n}^{b}.\label{eq:111}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
再一次，重置步骤只保留横滚和俯仰，给出
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta\boldsymbol{\theta}_{b}^{n}{}^{+} & =-\delta\boldsymbol{\theta}_{\phi}-\mathbf{R}_{\phi}\delta\boldsymbol{\theta}_{\theta}\nonumber \\
 & =-\delta\boldsymbol{\theta}_{n}^{b}{}^{+}.\label{eq:112}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
将方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:112"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:111"
plural "false"
caps "false"
noprefix "false"

\end_inset

)代入方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:107"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们发现
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\left(-\delta\boldsymbol{\theta}_{b}^{n}{}^{+}\right) & =\left[\begin{array}{ccc}
1 & \sin\hat{\phi}\tan\hat{\theta} & \cos\hat{\phi}\tan\hat{\theta}\\
0 & \cos^{2}\hat{\phi} & -\cos\hat{\phi}\sin\hat{\phi}\\
0 & -\cos\hat{\phi}\sin\hat{\phi} & \sin^{2}\hat{\phi}
\end{array}\right]\left(-\delta\boldsymbol{\theta}_{b}^{n}\right)\nonumber \\
\Longrightarrow\delta\boldsymbol{\theta}_{b}^{n}{}^{+} & =\mathbf{N}_{\boldsymbol{\theta}}\delta\boldsymbol{\theta}_{b}^{n},\label{eq:113}
\end{align}

\end_inset

这证实了bRN的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:104"
plural "false"
caps "false"
noprefix "false"

\end_inset

)。注意，用于评估
\begin_inset Formula $\mathbf{N}_{\boldsymbol{\theta}}$
\end_inset

的
\begin_inset Formula $\hat{\phi}$
\end_inset

和
\begin_inset Formula $\hat{\theta}$
\end_inset

的值由
\begin_inset Formula $\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}$
\end_inset

的欧拉分解得到。
\end_layout

\begin_layout Subsection
bRN位置重置
\begin_inset CommandInset label
LatexCommand label
name "subsec:E.3"

\end_inset


\end_layout

\begin_layout Standard
根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:90"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，我们可以写
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{p}_{b}^{n}{}^{+} & =-\mathbf{R}\left(\mathbf{q}_{n}^{b}\right)\mathbf{p}_{n}^{b}{}^{+}\\
 & =-\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}{}^{+}\right)\mathbf{p}_{n}^{b}{}^{+},
\end{aligned}
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{p}_{n}^{b}{}^{+} & =\mathbf{k}\mathbf{k}^{\top}\mathbf{p}_{n}^{b}\nonumber \\
 & =-\mathbf{k}\mathbf{k}^{\top}\mathbf{R}^{\top}\left(\mathbf{q}_{n}^{b}\right)\mathbf{p}_{b}^{n}\nonumber \\
 & =-\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\mathbf{q}_{b}^{n}\right)\mathbf{p}_{b}^{n}\label{eq:114}
\end{align}

\end_inset

由重新排列方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:90"
plural "false"
caps "false"
noprefix "false"

\end_inset

)得到。我们从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:91"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:38"
plural "false"
caps "false"
noprefix "false"

\end_inset

)中注意到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{b}^{n} & =\mathbf{q}_{\phi}^{-1}\otimes\mathbf{q}_{\theta}^{-1}\otimes\mathbf{q}_{\psi}^{-1}\\
\Longrightarrow\mathbf{R}\left(\mathbf{q}_{b}^{n}\right) & =\mathbf{R}^{\top}\left(\mathbf{q}_{\psi}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{\theta}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{\phi}\right),
\end{aligned}
\]

\end_inset

所以方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:114"
plural "false"
caps "false"
noprefix "false"

\end_inset

)变成
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{p}_{n}^{b}{}^{+}=-\mathbf{k}\mathbf{k}^{\top}\mathbf{R}^{\top}\left(\mathbf{q}_{\psi}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{\theta}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{\phi}\right)\mathbf{p}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
我们接下来观察到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{k}\mathbf{k}^{\top}\mathbf{R}^{\top}\left(\mathbf{q}_{\psi}\right) & =\left[\begin{array}{lll}
0 & 0 & 0\\
0 & 0 & 0\\
0 & 0 & 1
\end{array}\right]\left[\begin{array}{ccc}
\cos\psi & -\sin\psi & 0\\
\sin\psi & \cos\psi & 0\\
0 & 0 & 1
\end{array}\right]\\
 & =\mathbf{k}\mathbf{k}^{\top},
\end{aligned}
\]

\end_inset

以致于
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{p}_{n}^{b}{}^{+}=-\mathbf{k}\mathbf{k}^{\top}\mathbf{R}^{\top}\left(\mathbf{q}_{\theta}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{\phi}\right)\mathbf{p}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
注意到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{b}^{n}{}^{+} & =\mathbf{q}_{\phi}^{-1}\otimes\mathbf{q}_{\theta}{}^{-1}\\
\Longrightarrow\mathbf{R}\left(\mathbf{q}_{b}^{n}{}^{+}\right) & =\mathbf{R}^{\top}\left(\mathbf{q}_{\theta}\right)\mathbf{R}^{\top}\left(\mathbf{q}_{\phi}\right),
\end{aligned}
\]

\end_inset

我们有
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{p}_{n}^{b}{}^{+}=-\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\mathbf{q}_{b}^{n}{}^{+}\right)\mathbf{p}_{b}^{n}
\]

\end_inset

并因此
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{p}_{b}^{n}{}^{+}=\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\mathbf{q}_{b}^{n}{}^{+}\right)\mathbf{p}_{b}^{n}.\label{eq:115}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
然后我们根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:33"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:34"
plural "false"
caps "false"
noprefix "false"

\end_inset

)进行展开和简化，同时删除二阶项，得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathbf{p}_{b}^{n}{}^{+}= & \mathbf{R}^{\top}\left(\delta\mathbf{q}_{b}^{n}{}^{+}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{R}\left(\delta\mathbf{q}_{b}^{n}{}^{+}\right)\mathbf{p}_{b}^{n}\\
\approx & \left(\mathbf{I}+\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}{}^{+}\right\rfloor \right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}{}^{+}\right\rfloor \right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{n}^{b}\right)\\
\approx & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\hat{\mathbf{p}}_{b}^{n}\\
 & \ +\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\delta\mathbf{p}_{b}^{n}\\
 & \ +\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}{}^{+}\right\rfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\hat{\mathbf{p}}_{b}^{n}\\
 & \ -\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}{}^{+}\right\rfloor \hat{\mathbf{p}}_{b}^{n}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:115"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，估计重置为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\mathbf{p}}_{b}^{n}{}^{+}=\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\hat{\mathbf{p}}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:113"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，然后将误差状态重置为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{p}_{b}^{n}{}^{+}= & \mathbf{p}_{b}^{n}{}^{+}-\hat{\mathbf{p}}_{b}^{n}{}^{+}\\
= & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\delta\mathbf{p}_{b}^{n}\\
 & \ +\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}{}^{+}\right\rfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\hat{\mathbf{p}}_{b}^{n}\\
 & \ -\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}{}^{+}\right\rfloor \hat{\mathbf{p}}_{b}^{n}\\
= & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\delta\mathbf{p}_{b}^{n}\\
 & \ -\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\hat{\mathbf{p}}_{b}^{n}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}{}^{+}\\
 & \ +\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}{}^{+}\\
= & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\delta\mathbf{p}_{b}^{n}\\
 & \ -\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\hat{\mathbf{p}}_{b}^{n}\right\rfloor \mathbf{N}_{\boldsymbol{\theta}}\delta\boldsymbol{\theta}_{b}^{n}\\
 & \ +\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \mathbf{N}_{\boldsymbol{\theta}}\delta\boldsymbol{\theta}_{b}^{n},
\end{aligned}
\]

\end_inset

并且非零Jacobian项是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dfrac{\partial\delta\mathbf{p}_{b}^{n}{}^{+}}{\partial\delta\mathbf{p}_{b}^{n}}= & \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\\
\dfrac{\partial\delta\mathbf{p}_{b}^{n}{}^{+}}{\partial\delta\boldsymbol{\theta}_{b}^{n}}= & \left(-\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\hat{\mathbf{p}}_{b}^{n}\right\rfloor \right.\\
 & \left.+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\mathbf{k}\mathbf{k}^{\top}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}{}^{+}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \right)\mathbf{N}_{\boldsymbol{\theta}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Section
机体固连的激光扫描测量模型
\begin_inset CommandInset label
LatexCommand label
name "sec:F"

\end_inset


\end_layout

\begin_layout Standard
在本节中，我们推导了第 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:7.2.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

 节中提出的机体固连的激光扫描测量模型的残差Jacobian矩阵。对于测量模型的平移部分，我们首先根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:33"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:34"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:93"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，然后去掉二阶项并使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

)得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{array}{rl}
\mathbf{h}_{\mathrm{lt}}(\mathbf{x})= & \mathbf{I}_{2\times3}\mathbf{R}\left(\mathbf{q}_{b}^{o}\right)\left(\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}+\mathbf{R}^{\top}\left(\mathbf{q}_{b}^{n}\right)\mathbf{R}\left(\mathbf{q}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\mathbf{p}_{k}^{n}\right)\right)+\boldsymbol{\eta}_{\mathrm{lt}}\\
= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}\left(\delta\mathbf{q}_{b}^{o}\right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}\right.\\
 & \ +\mathbf{R}^{\top}\left(\delta\mathbf{q}_{b}^{n}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\mathbf{R}\left(\delta\mathbf{q}_{k}^{n}\right)\\
 & \ \left.\times\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}-\delta\mathbf{p}_{k}^{n}\right)\right)+\boldsymbol{\eta}_{\mathrm{lt}}\\
= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{b}^{o}\right\rfloor \right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}-\mathbf{p}_{b}^{c}\right.\\
 & \ +\left(\mathbf{I}+\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{k}^{n}\right\rfloor \right)\\
 & \ \left.\times\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}-\delta\mathbf{p}_{k}^{n}\right)\right)+\boldsymbol{\eta}_{\mathrm{lt}}\\
= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left(\hat{\mathbf{p}}_{b}^{n}-\mathbf{p}_{b}^{c}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right)\\
 & \ +\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\delta\mathbf{p}_{b}^{n}-\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\delta\mathbf{p}_{k}^{n}\\
 & \ -\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}\\
 & \ +\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right\rfloor \delta\boldsymbol{\theta}_{k}^{n}\\
 & \ +\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}-\mathbf{p}_{b}^{c}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \delta\boldsymbol{\theta}_{b}^{o}.
\end{array}
\]

\end_inset


\end_layout

\begin_layout Standard
回顾这个
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{h}_{\mathrm{lt}}(\hat{\mathbf{x}})=\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left(\hat{\mathbf{p}}_{b}^{n}-\mathbf{p}_{b}^{c}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right),
\]

\end_inset

残差由下式给出为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{h}_{\mathrm{lt}}=\mathbf{z}_{\mathrm{lt}}-\mathbf{h}_{\mathrm{lt}}(\hat{\mathbf{x}}),
\]

\end_inset

其被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{\mathrm{lt}}= & \mathbf{h}_{\mathrm{lt}}(\mathbf{x})-\mathbf{h}_{\mathrm{lt}}(\hat{\mathbf{x}})\\
= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\delta\mathbf{p}_{b}^{n}-\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\delta\mathbf{p}_{k}^{n}\\
 & \ -\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}\\
 & \ +\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right\rfloor \delta\boldsymbol{\theta}_{k}^{n}\\
 & \ +\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}-\mathbf{p}_{b}^{c}+\mathbf{R}^{\mathrm{T}}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \delta\boldsymbol{\theta}_{b}^{o}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
注意到
\begin_inset Formula $\mathbf{q}_{b}^{o}$
\end_inset

仅是
\begin_inset Formula $\mathbf{q}_{b}^{n}$
\end_inset

的函数，我们采用偏导数并应用链式规则来获得以下非零Jacobian项：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dfrac{\partial\mathbf{r}_{\mathrm{lt}}}{\partial\delta\mathbf{p}_{b}^{n}}= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right),\\
\dfrac{\partial\mathbf{r}_{\mathrm{lt}}}{\partial\delta\boldsymbol{\theta}_{b}^{n}}= & -\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left\lfloor \mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \\
 & +\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}-\mathbf{p}_{b}^{c}+\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(\mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right)\right\rfloor \dfrac{\partial\delta\boldsymbol{\theta}_{b}^{o}}{\partial\delta\boldsymbol{\theta}_{b}^{n}},\\
\dfrac{\partial\mathbf{r}_{\mathrm{lt}}}{\partial\delta\mathbf{p}_{k}^{n}}= & -\mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right),\\
\dfrac{\partial\mathbf{r}_{\mathrm{lt}}}{\partial\delta\boldsymbol{\theta}_{k}^{n}}= & \mathbf{I}_{2\times3}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \mathbf{p}_{b}^{c}-\hat{\mathbf{p}}_{k}^{n}\right\rfloor .
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
为推导出对于
\begin_inset Formula $\partial\delta\boldsymbol{\theta}_{b}^{o}/\partial\delta\boldsymbol{\theta}_{b}^{n}$
\end_inset

的表达式，我们遵循类似于附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:E.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:E.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中用于推导姿态重置的过程。我们根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)将
\begin_inset Formula $\mathbf{q}_{b}^{o}$
\end_inset

的定义扩展为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{b}^{o} & =\left(\mathbf{q}_{\theta_{n}^{b}}\otimes\mathbf{q}_{\phi_{n}^{b}}\right)^{-1}\\
 & =\left(\hat{\mathbf{q}}_{\phi_{n}^{b}}\right)^{-1}\otimes\left(\delta\mathbf{q}_{\phi_{n}^{b}}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{\theta_{n}^{b}}\right)^{-1}\otimes\left(\delta\mathbf{q}_{\theta_{n}^{b}}\right)^{-1}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
注意到
\begin_inset Formula $\hat{\mathbf{q}}_{b}^{o}=\left(\hat{\mathbf{q}}_{\theta_{n}^{b}}\otimes\hat{\mathbf{q}}_{\phi_{n}^{b}}\right)^{-1}$
\end_inset

，根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:36"
plural "false"
caps "false"
noprefix "false"

\end_inset

)计算误差四元数为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}_{b}^{o}= & \mathbf{q}_{b}^{o}\otimes\left(\hat{\mathbf{q}}_{b}^{o}\right)^{-1}\\
= & \left(\hat{\mathbf{q}}_{\phi_{n}^{b}}\right)^{-1}\otimes\left(\delta\mathbf{q}_{\phi_{n}^{b}}\right)^{-1}\\
 & \ \otimes\left(\hat{\mathbf{q}}_{\theta_{n}^{b}}\right)^{-1}\otimes\left(\delta\mathbf{q}_{\theta_{n}^{b}}\right)^{-1}\otimes\hat{\mathbf{q}}_{\theta_{n}^{b}}\otimes\hat{\mathbf{q}}_{\phi_{n}^{b}},
\end{aligned}
\]

\end_inset

由此，我们用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:42"
plural "false"
caps "false"
noprefix "false"

\end_inset

)以获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\boldsymbol{\theta}_{b}^{o}=\mathbf{R}\left(\hat{\mathbf{q}}_{\phi_{n}^{b}}\right)\left(-\delta\boldsymbol{\theta}_{\phi_{n}^{b}}-\mathbf{R}\left(\hat{\mathbf{q}}_{\theta_{n}^{b}}\right)\delta\boldsymbol{\theta}_{\theta_{n}^{b}}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
注意，如附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:E.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示，
\begin_inset Formula $\mathbf{R}\left(\hat{\mathbf{q}}_{\phi_{n}^{b}}\right)\delta\boldsymbol{\theta}_{\phi_{n}^{b}}=\delta\boldsymbol{\theta}_{\phi_{n}^{b}}$
\end_inset

并且
\begin_inset Formula $\mathbf{R}\left(\hat{\mathbf{q}}_{\theta_{n}^{b}}\right)\delta\boldsymbol{\theta}_{\theta_{n}^{b}}=\delta\boldsymbol{\theta}_{\theta_{n}^{b}}$
\end_inset

，这就变成
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\boldsymbol{\theta}_{b}^{o}=-\delta\boldsymbol{\theta}_{\phi_{n}^{b}}-\mathbf{R}\left(\hat{\mathbf{q}}_{\phi_{n}^{b}}\right)\delta\boldsymbol{\theta}_{\theta_{n}^{b}}.
\]

\end_inset


\end_layout

\begin_layout Standard
根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:36"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开
\begin_inset Formula $\ensuremath{\mathbf{R}\left(\hat{\mathbf{q}}_{\phi_{n}^{b}}\right)}$
\end_inset

并合并各项，这可写为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\boldsymbol{\theta}_{b}^{o}=\left[\begin{array}{ccc}
-1 & 0 & 0\\
0 & -\cos\hat{\phi}_{n}^{b} & 0\\
0 & \sin\hat{\phi}_{n}^{b} & 0
\end{array}\right]\boldsymbol{\Delta}_{n}^{b},
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{\Delta}=\left[\begin{array}{c}
\phi_{n}^{b}-\hat{\phi}_{n}^{b}\\
\theta_{n}^{b}-\hat{\theta}_{n}^{b}\\
\psi_{n}^{b}-\hat{\psi}_{n}^{b}
\end{array}\right]
\]

\end_inset

如附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:A"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。然后我们使用链式法则来获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dfrac{\partial\delta\boldsymbol{\theta}_{b}^{o}}{\partial\delta\boldsymbol{\theta}_{b}^{n}} & =\dfrac{\partial\delta\boldsymbol{\theta}_{b}^{o}}{\partial\boldsymbol{\Delta}_{b}^{n}}\dfrac{\partial\boldsymbol{\Delta}_{b}^{n}}{\partial\delta\boldsymbol{\theta}_{n}^{b}}\dfrac{\partial\delta\boldsymbol{\theta}_{n}^{b}}{\partial\delta\boldsymbol{\theta}_{b}^{n}}\\
 & =\left[\begin{array}{ccc}
-1 & 0 & 0\\
0 & -\cos\hat{\phi}_{n}^{b} & 0\\
0 & \sin\hat{\phi}_{n}^{b} & 0
\end{array}\right]\mathbf{N}_{\boldsymbol{\Delta}_{n}^{b}}\left(-\mathbf{I}\right)\\
 & =\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & \cos\hat{\phi}_{n}^{b} & 0\\
0 & -\sin\hat{\phi}_{n}^{b} & 0
\end{array}\right]\mathbf{N}_{\boldsymbol{\Delta}_{n}^{b}},
\end{aligned}
\]

\end_inset

其中
\begin_inset Formula $\mathbf{N}_{\boldsymbol{\Delta}_{n}^{b}}$
\end_inset

由附录 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:A"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中的方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:100"
plural "false"
caps "false"
noprefix "false"

\end_inset

)给出。然后我们将这一结果代入上面，得到对于
\begin_inset Formula $\partial\mathbf{r}_{\mathrm{lt}}/\partial\delta\boldsymbol{\theta}_{b}^{n}$
\end_inset

的完整表达。
\end_layout

\begin_layout Standard
对于测量模型的旋转部分，我们首先根据(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)将
\begin_inset Formula $\mathbf{q}_{\mathrm{lr}}$
\end_inset

的表达式展开为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{l\mathrm{r}}= & \left(\mathbf{q}_{b}^{o}\right)^{-1}\otimes\mathbf{q}_{b}^{n}\otimes\left(\mathbf{q}_{k}^{n}\right)^{-1}\otimes\mathbf{q}_{b}^{o}\\
= & \left(\hat{\mathbf{q}}_{b}^{o}\right)^{-1}\otimes\left(\delta\mathbf{q}_{b}^{o}\right)^{-1}\otimes\delta\mathbf{q}_{b}^{n}\\
 & \ \otimes\hat{\mathbf{q}}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\otimes\left(\delta\mathbf{q}_{k}^{n}\right)^{-1}\otimes\delta\mathbf{q}_{b}^{o}\otimes\hat{\mathbf{q}}_{b}^{o}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
回顾
\begin_inset Formula $\hat{\mathbf{q}}_{\mathrm{lr}}=\left(\hat{\mathbf{q}}_{b}^{o}\right)^{-1}\otimes\hat{\mathbf{q}}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\otimes\hat{\mathbf{q}}_{b}^{o}$
\end_inset

，根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)计算出误差四元数为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}_{\mathrm{lr}}= & \mathbf{q}_{\mathrm{lr}}\otimes\left(\hat{\mathbf{q}}_{\mathrm{lr}}\right)^{-1}\\
= & \left(\hat{\mathbf{q}}_{b}^{o}\right)^{-1}\otimes\left(\delta\mathbf{q}_{b}^{o}\right)^{-1}\otimes\delta\mathbf{q}_{b}^{n}\otimes\hat{\mathbf{q}}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\\
 & \ \otimes\left(\delta\mathbf{q}_{k}^{n}\right)^{-1}\otimes\delta\mathbf{q}_{b}^{o}\otimes\hat{\mathbf{q}}_{b}^{n}\otimes\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1}\otimes\hat{\mathbf{q}}_{b}^{o},
\end{aligned}
\]

\end_inset

从中我们使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:42"
plural "false"
caps "false"
noprefix "false"

\end_inset

)以获得
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\boldsymbol{\theta}_{\mathrm{lr}}= & \mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left(-\delta\boldsymbol{\theta}_{b}^{o}+\delta\boldsymbol{\theta}_{b}^{n}+\right.\\
 & \ \left.\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left(-\delta\boldsymbol{\theta}_{k}^{n}+\delta\boldsymbol{\theta}_{b}^{o}\right)\right)\\
= & \mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\delta\boldsymbol{\theta}_{b}^{n}-\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\delta\boldsymbol{\theta}_{k}^{n}\\
 & \ +\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\left(\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)-\mathbf{I}\right)\delta\boldsymbol{\theta}_{b}^{o}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
测量模型是
\begin_inset Formula $\mathbf{q}_{\mathrm{lr}}$
\end_inset

的偏航部分，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}h_{\mathrm{lr}}(\mathbf{x}) & =\psi\left(\mathbf{q}_{\mathrm{lr}}\right)+\eta_{\mathrm{lr}}\\
 & \triangleq\psi_{\mathrm{lr}}+\eta_{\mathrm{lr}},
\end{aligned}
\]

\end_inset

并且估计的测量结果是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}h_{\mathrm{lr}}(\hat{\mathbf{x}}) & =\psi\left(\mathbf{q}_{\mathrm{lr}}\right)\\
 & \triangleq\hat{\psi}_{\mathrm{lr}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
残差由下式给出为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
r_{\mathrm{lr}}=z_{\mathrm{lr}}-h_{\mathrm{lr}}(\hat{\mathbf{x}}),
\]

\end_inset

其被建模为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}r_{\mathrm{lr}} & =h_{\mathrm{lr}}(\mathbf{x})-h_{\mathrm{lr}}(\hat{\mathbf{x}})\\
 & =\psi_{\mathrm{lr}}-\hat{\psi}_{\mathrm{lr}}\\
 & =\mathbf{k}^{\top}\boldsymbol{\Delta}_{\mathrm{lr}}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
我们然后利用链式法则计算
\begin_inset Formula $r_{\mathrm{lr}}$
\end_inset

的Jacobian矩阵为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dfrac{\partial r_{\mathrm{lr}}}{\partial\delta\mathbf{x}} & =\dfrac{\partial r_{\mathrm{lr}}}{\partial\boldsymbol{\Delta}_{\mathrm{lr}}}\dfrac{\partial\boldsymbol{\Delta}_{\mathrm{lr}}}{\partial\delta\boldsymbol{\theta}_{\mathrm{lr}}}\dfrac{\partial\delta\boldsymbol{\theta}_{\mathrm{lr}}}{\partial\delta\mathbf{x}}\\
 & =\left(\mathbf{k}^{\top}\right)\left(\mathbf{N}_{\boldsymbol{\Delta}_{\mathrm{lr}}}\right)\dfrac{\partial\delta\boldsymbol{\theta}_{\mathrm{lr}}}{\partial\delta\mathbf{x}},
\end{aligned}
\]

\end_inset

其中有非零项
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dfrac{\partial r_{\mathrm{lr}}}{\partial\delta\boldsymbol{\theta}_{b}^{n}}= & \mathbf{k}^{\top}\mathbf{N}_{\boldsymbol{\Delta}_{\mathrm{lr}}}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\\
 & \ \times\left(\mathbf{I}+\left(\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)-\mathbf{I}\right)\dfrac{\partial\delta\boldsymbol{\theta}_{b}^{o}}{\partial\delta\boldsymbol{\theta}_{b}^{n}}\right),\\
\dfrac{\partial r_{\mathrm{lr}}}{\partial\delta\boldsymbol{\theta}_{k}^{n}}= & -\mathbf{k}^{\top}\mathbf{N}_{\boldsymbol{\Delta}_{\mathrm{lr}}}\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{o}\right)\mathbf{R}^{\top}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right),
\end{aligned}
\]

\end_inset

由我们代入在上面推导出的表达式
\begin_inset Formula $\partial\delta\boldsymbol{\theta}_{b}^{o}/\partial\delta\boldsymbol{\theta}_{b}^{n}$
\end_inset

获得。
\end_layout

\begin_layout Section
从bRN转换为iRN
\begin_inset CommandInset label
LatexCommand label
name "sec:G"

\end_inset


\end_layout

\begin_layout Standard
在机体坐标系(bRN)中进行估计时，将估计的状态转化为惯性坐标系(iRN)中往往是有用的，这便于可视化或路径规划与控制。本附录描述了如何完成这种变换，并推导出了
将bRN协方差转换为iRN帧的Jacobians矩阵。
\end_layout

\begin_layout Standard
iRN和bRN的速度和偏差状态(
\begin_inset Formula $\mathbf{v}$
\end_inset

、
\begin_inset Formula $\boldsymbol{\beta}_{\boldsymbol{\omega}}$
\end_inset

和
\begin_inset Formula $\boldsymbol{\beta}_{\mathbf{a}}$
\end_inset

)都在机体坐标系中表示，因此不需要变换。阻力系数项
\begin_inset Formula $\mu$
\end_inset

同样不需要变换，因为它是标量项。需要变换的状态是车辆的相对位姿
\begin_inset Formula $\left(\mathbf{p}_{b}^{n},\mathbf{q}_{b}^{n}\right)$
\end_inset

和关键帧位姿
\begin_inset Formula $\left(\mathbf{p}_{k}^{n},\mathbf{q}_{k}^{n}\right)$
\end_inset

。
\end_layout

\begin_layout Standard
车辆位置
\begin_inset Formula $\mathbf{p}_{b}^{n}$
\end_inset

使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:90"
plural "false"
caps "false"
noprefix "false"

\end_inset

)变换为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{p}_{n}^{b}=-\mathbf{R}\left(\mathbf{q}_{b}^{n}\right)\mathbf{p}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:31b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)、(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:44a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)和(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:33"
plural "false"
caps "false"
noprefix "false"

\end_inset

)展开，然后使用方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

)，这就变为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{p}_{n}^{b} & =\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\mathbf{R}\left(\delta\mathbf{q}_{b}^{n}\right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}\right)\\
 & \approx\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left(\mathbf{I}-\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \right)\left(\hat{\mathbf{p}}_{b}^{n}+\delta\mathbf{p}_{b}^{n}\right)\\
 & \approx\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\hat{\mathbf{p}}_{b}^{n}+\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\delta\mathbf{p}_{b}^{n}-\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left\lfloor \delta\boldsymbol{\theta}_{b}^{n}\right\rfloor \hat{\mathbf{p}}_{b}^{n}\\
 & =\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\hat{\mathbf{p}}_{b}^{n}+\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\delta\mathbf{p}_{b}^{n}+\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
估计状态变换为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\mathbf{p}}_{n}^{b}=-\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\hat{\mathbf{p}}_{b}^{n},
\]

\end_inset

并且产生的误差状态是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{p}_{n}^{b} & =\mathbf{p}_{n}^{b}-\hat{\mathbf{p}}_{n}^{b}\\
 & =\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\delta\mathbf{p}_{b}^{n}+\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor \delta\boldsymbol{\theta}_{b}^{n}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
然后得到的非零Jacobian项是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dfrac{\partial\delta\mathbf{p}_{n}^{b}}{\partial\delta\mathbf{p}_{b}^{n}} & =\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right),\\
\dfrac{\partial\delta\mathbf{p}_{n}^{b}}{\partial\delta\boldsymbol{\theta}_{b}^{n}} & =\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor .
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
将车辆姿态
\begin_inset Formula $\mathbf{q}_{b}^{n}$
\end_inset

变换为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{q}_{n}^{b}=\left(\mathbf{q}_{b}^{n}\right)^{-1},
\]

\end_inset

根据方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:29b"
plural "false"
caps "false"
noprefix "false"

\end_inset

)其被展开为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{q}_{n}^{b} & =\left(\delta\mathbf{q}_{b}^{n}\otimes\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\\
 & =\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\otimes\left(\delta\mathbf{q}_{b}^{n}\right)^{-1}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
估计姿态变换为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\mathbf{q}}_{n}^{b}=\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1},
\]

\end_inset

并且从方程(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:30a"
plural "false"
caps "false"
noprefix "false"

\end_inset

)得到的误差状态是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{q}_{n}^{b} & =\left(\hat{\mathbf{q}}_{n}^{b}\right)^{-1}\otimes\mathbf{q}_{n}^{b}\\
 & =\left(\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\right)^{-1}\otimes\left(\hat{\mathbf{q}}_{b}^{n}\right)^{-1}\otimes\left(\delta\mathbf{q}_{b}^{n}\right)^{-1}\\
 & =\left(\delta\mathbf{q}_{b}^{n}\right)^{-1},
\end{aligned}
\]

\end_inset

这意味着
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta\boldsymbol{\theta}_{n}^{b}=-\delta\boldsymbol{\theta}_{b}^{n}.
\]

\end_inset


\end_layout

\begin_layout Standard
非零Jacobian项是
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\dfrac{\partial\delta\boldsymbol{\theta}_{n}^{b}}{\partial\delta\boldsymbol{\theta}_{b}^{n}}=-\mathbf{I}.
\]

\end_inset


\end_layout

\begin_layout Standard
关键帧位姿
\begin_inset Formula $\left(\mathbf{p}_{k}^{n},\mathbf{q}_{k}^{n}\right)$
\end_inset

也会进行类似的变换，产生
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\hat{\mathbf{p}}_{n}^{k} & =-\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\hat{\mathbf{p}}_{k}^{n}\\
\hat{\mathbf{q}}_{n}^{k} & =\left(\hat{\mathbf{q}}_{k}^{n}\right)^{-1},
\end{aligned}
\]

\end_inset

并且
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\dfrac{\partial\delta\mathbf{p}_{n}^{k}}{\partial\delta\mathbf{p}_{k}^{n}} & =\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right),\\
\dfrac{\partial\delta\mathbf{p}_{n}^{k}}{\partial\delta\boldsymbol{\theta}_{k}^{n}} & =\mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\left\lfloor \hat{\mathbf{p}}_{k}^{n}\right\rfloor ,\\
\dfrac{\partial\delta\boldsymbol{\theta}_{n}^{k}}{\partial\delta\boldsymbol{\theta}_{k}^{n}} & =-\mathbf{I}.
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
协方差变换为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{P}_{\mathrm{iRN}}=\mathbf{J}\mathbf{P}_{\mathrm{bRN}}\mathbf{J}^{\top},
\]

\end_inset

其中
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}\mathbf{J} & =\dfrac{\partial\delta\mathbf{x}_{\mathrm{iRN}}}{\partial\delta\mathbf{x}_{\mathrm{bRN}}},\\
\mathbf{F} & =\left[\begin{array}{cccccccc}
\mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right) & \mathbf{R}\left(\hat{\mathbf{q}}_{b}^{n}\right)\left\lfloor \hat{\mathbf{p}}_{b}^{n}\right\rfloor  & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & -\mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right) & \mathbf{R}\left(\hat{\mathbf{q}}_{k}^{n}\right)\hat{\mathbf{p}}_{k}^{n} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{-I} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{0} & 1
\end{array}\right].
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{appendices}
\end_layout

\end_inset


\end_layout

\begin_layout Section*
References
\end_layout

\begin_layout Enumerate
Anderson, ML, Brink, KM, Willis, AR (2019) Real-time visual odometry covariance
 estimation for unmanned air vehicle navigation.
 Journal of Guidance, Control, and Dynamics 42(6): 1272–1288.
\end_layout

\begin_layout Enumerate
Bailey, T, Durrant-Whyte, H (2006) Simultaneous localization and mapping
 (SLAM): Part II.
 IEEE Robotics and Automation Magazine 13(3): 108–117.
 
\end_layout

\begin_layout Enumerate
Bar-Shalom, Y, Kirubarajan, T, Li, XR (2002) Estimation with Applications
 to Tracking and Navigation.
 New York: John Wiley & Sons, Inc.
 
\end_layout

\begin_layout Enumerate
Barfoot, T, Forbes, JR, Furgale, PT (2011) Pose estimation using linearized
 rotations and quaternion algebra.
 Acta Astronautica 68(1–2): 101–112.
 
\end_layout

\begin_layout Enumerate
Barfoot, TD, Furgale, PT (2014) Associating uncertainty with three-dimensional
 poses for use in estimation problems.
 IEEE Transactions on Robotics 30(3): 679–693.
 
\end_layout

\begin_layout Enumerate
Bloesch, M, Omari, S, Hutter, M, Siegwart, R (2015) Robust visual inertial
 odometry using a direct EKF-based approach.
 In: IEEE/RSJ International Conference on Intelligent Robots and Systems,
 pp.
 298–304.
 
\end_layout

\begin_layout Enumerate
Bloesch, M, Sommer, H, Laidlow, T, et al.
 (2016) A primer on the differential calculus of 3D orientations.
 ArXiv e-prints.
 Available at 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://arxiv.org/abs/1606.05285
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Enumerate
Bopardikar, SD, Zhang, S, Speranzon, A (2013) A robust and adaptive framework
 for localization under varying sensor modalities.
 In: AIAA Guidance, Navigation, and Control Conference.
 
\end_layout

\begin_layout Enumerate
Casey, RT, Karpenko, M, Curry, R, Elkaim, G (2013) Attitude representation
 and kinematic propagation for low-cost UAVs.
 In: AIAA Guidance, Navigation, and Control Conference, pp.
 1–15.
 
\end_layout

\begin_layout Enumerate
Castellanos, JA, Martinez-Cantin, R, Tardós, JD, Neira, J (2007) Robocentric
 map joining: Improving the consistency of EKF-SLAM.
 Robotics and Autonomous Systems 55(1): 21–29.
 
\end_layout

\begin_layout Enumerate
Censi, A (2008) An ICP variant using a point-to-line metric.
 In: IEEE International Conference on Robotics and Automation, pp.
 19–25.
 
\end_layout

\begin_layout Enumerate
Chong, KS, Kleeman, L (1999) Feature-based mapping in real, large scale
 environments using an ultrasonic array.
 International Journal of Robotics Research 18(1): 3–19.
 
\end_layout

\begin_layout Enumerate
Farrell, J (2008) Aided Navigation: GPS with High Rate Sensors.
 1st Ed.
 New York: McGraw-Hill, Inc.
 
\end_layout

\begin_layout Enumerate
Hertzberg, C, Wagner, R, Frese, U, Schröder, L (2013) Integrating generic
 sensor fusion algorithms with sound state representations through encapsulation
 of manifolds.
 Information Fusion 14(1): 57–77.
 
\end_layout

\begin_layout Enumerate
Jones, E, Vedaldi, A, Soatto, S (2007) Inertial structure from motion with
 autocalibration.
 In: ICCV Workshop on Dynamical Vision.
 
\end_layout

\begin_layout Enumerate
Julier, SJ, Uhlmann, JK (2001) A counter example to the theory of simultaneous
 localization and map building.
 In: IEEE International Conference on Robotics and Automation, Vol.
 4, pp.
 4238–4243.
 
\end_layout

\begin_layout Enumerate
Kim, B, Kaess, M, Fletcher, L, et al.
 (2010) Multiple relative pose graphs for robust cooperative mapping.
 In: IEEE International Conference on Robotics and Automation, pp.
 3185–3192.
 
\end_layout

\begin_layout Enumerate
Kottas, DG, Hesch, JA, Bowman, SL, Roumeliotis, SI (2013) On the consistency
 of vision-aided inertial navigation.
 In: Experimental Robotics (Springer Tracts in Advanced Robotics, Vol.
 88).
 Berlin: Springer, pp.
 303–317.
 
\end_layout

\begin_layout Enumerate
Kuipers, JB (1999) Quaternions and Rotation Sequences: A Primer with Application
s to Orbits, Aerospace, and Virtual Reality.
 Princeton, NJ: Princeton University Press.
 
\end_layout

\begin_layout Enumerate
Lefferts, E, Markley, F, Shuster, M (1982) Kalman filtering for spacecraft
 attitude estimation.
 Journal of Guidance, Control, and Dynamics 5(5): 417–429.
 
\end_layout

\begin_layout Enumerate
Leishman, RC, Macdonald, JC, Beard, RW, McLain, TW (2014a) Quadrotors and
 accelerometers: State estimation with an improved dynamic model.
 IEEE Control Systems Magazine 34(1): 28–41.
 
\end_layout

\begin_layout Enumerate
Leishman, RC, McLain, TW (2014) Multiplicative extended Kalman filter for
 relative rotorcraft navigation.
 Journal of Aerospace Information Systems 12(12): 728–744.
 
\end_layout

\begin_layout Enumerate
Leishman, RC, McLain, TW, Beard, RW (2014b) Relative navigation approach
 for vision-based aerial GPS-denied navigation.
 Journal of Intelligent and Robotic Systems 74(1): 97–111.
 
\end_layout

\begin_layout Enumerate
Leutenegger, S, Lynen, S, Bosse, M, Siegwart, R, Furgale, P (2015) Keyframe-base
d visual-inertial odometry using nonlinear optimization.
 International Journal of Robotics Research 34(3): 314–334.
 
\end_layout

\begin_layout Enumerate
Markley, FL (2003) Attitude error representations for Kalman filtering.
 Journal of Guidance, Control, and Dynamics 26(2): 311–317.
 
\end_layout

\begin_layout Enumerate
Martinelli, A (2012) Vision and IMU data fusion: Closed-form solutions for
 attitude, speed, absolute scale, and bias determination.
 IEEE Transactions on Robotics 28(1): 44–60.
 
\end_layout

\begin_layout Enumerate
Maybeck, PS (1979) Stochastic models, estimation, and control (Mathematics
 in Science and Engineering, Vol.
 141).
 New York: Academic Press.
 
\end_layout

\begin_layout Enumerate
Owen, E, Montano, L (2006) A robocentric motion planner for dynamic environments
 using the velocity space.
 In: IEEE/RSJ International Conference on Intelligent Robots and Systems,
 pp.
 4368–4374.
 
\end_layout

\begin_layout Enumerate
Quigley, M, Conley, K, Gerkey, B, et al.
 (2009) ROS: An open-source robot operating system.
 In: ICRA Workshop on Open Source Software.
 
\end_layout

\begin_layout Enumerate
Shen, S, Michael, N, Kumar, V (2011) Autonomous multi-floor indoor navigation
 with a computationally constrained MAV.
 In: IEEE International Conference on Robotics and Automation, pp.
 20–25.
 
\end_layout

\begin_layout Enumerate
Shen, S, Mulgaonkar, Y, Michael, N, Kumar, V (2014) Multi-sensor fusion
 for robust autonomous flight in indoor and outdoor environments with a
 rotorcraft MAV.
 In: IEEE International Conference on Robotics and Automation, pp.
 4974–4981.
 
\end_layout

\begin_layout Enumerate
Sola, J (2016) Quaternion kinematics for the error-state Kalman filter.
 Technical Report IRI-TR-16-02, Institut de Robòtica i Informàtica Industrial,
 CSIC-UPC.
 
\end_layout

\begin_layout Enumerate
Tomic, T, Schmid, K, Lutz, P, et al.
 (2012) Toward a fully autonomous UAV: Research platform for indoor and
 outdoor urban search and rescue.
 IEEE Robotics and Automation Magazine 19(3): 46–56.
 
\end_layout

\begin_layout Enumerate
Trawny, N, Roumeliotis, SI (2005) Indirect Kalman filter for 3D attitude
 estimation: A tutorial for quaternion algebra.
 Technical Report2005-002, Rev.
 57, University of Minnesota, Department of Computer Science and Engineering,
 Minneapolis.
 
\end_layout

\begin_layout Enumerate
Weiss, S, Achtelik, MW, Lynen, S, Chli, M, Siegwart, R (2012) Real-time
 onboard visual-inertial state estimation and self-calibration of MAVs in
 unknown environments.
 In: IEEE International Conference on Robotics and Automation, pp.
 957–964.
\end_layout

\begin_layout Enumerate
Weiss, S, Siegwart, R (2011) Real-time metric state estimation for modular
 vision-inertial systems.
 In: IEEE International Conference on Robotics and Automation, pp.
 4531–4537.
 
\end_layout

\begin_layout Enumerate
Wheeler, DO, Koch, DP, Jackson, JS, et al.
 (2020) Relative navigation of autonomous GPS-degraded micro air vehicles.
 Autonomous Robots.
 Available at: 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://doi.org/10.1007/s10514-019-09899-4
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Enumerate
Wheeler, DO, Koch, DP, Jackson, JS, Mclain, TW, Beard, RW (2018) Relative
 navigation: A keyframe-based approach for observable GPS-degraded navigation.
 IEEE Control Systems Magazine 38(4): 30–48.
 
\end_layout

\begin_layout Enumerate
Yu, H, Beard, RW (2013) Vision-based local-level frame mapping and planning
 in spherical coordinates for miniature air vehicles.
 IEEE Transactions on Control Systems Technology 21(3): 695–703.
 
\end_layout

\begin_layout Enumerate
Zhang, J, Kaess, M, Singh, S (2014) Real-time depth enhanced monocular odometry.
 In: IEEE/RSJ International Conference on Intelligent Robots and Systems,
 pp.
 4973–4980.
\end_layout

\end_body
\end_document
