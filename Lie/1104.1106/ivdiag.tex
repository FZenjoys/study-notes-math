

% 0. META

\newcommand{\mcm}[3]{\newcommand{#1}[#2]{{\ensuremath{#3}}}}


% 1. PACKAGES

\usepackage{latexsym}
\usepackage{amssymb}

% 2. FORMATTING

% Characters

\mcm{\blank}{0}{(\emptybk)} \mcm{\dashbk}{0}{\mbox{---}}
\mcm{\emptybk}{0}{\:\:} \mcm{\hyph}{0}{\mbox{-}}

% Diagrams

\mcm{\diagspace}{0}{\mbox{\hspace{2em}}}

% Proofs

\newcommand{\done}{\hfill\ensuremath{\Box}}
%\newcommand{\pf}{\noindent\textbf{Proof}}

% References

\newcommand{\bref}[1]{(\ref{#1})}
\newcommand{\ucontents}[2]{\addcontentsline{toc}{#1}{\numberline{}{#2}}}


% 3. TYPOGRAPHIC

\mcm{\cat}{1}{\mc{#1}} \mcm{\fcat}{1}{\mb{#1}}
\mcm{\mc}{1}{\mathcal{#1}} \mcm{\mr}{1}{\mathrm{#1}}
\mcm{\mi}{1}{\mathit{#1}} \mcm{\mb}{1}{\mathbf{#1}}
\mcm{\scat}{1}{\Bbb{#1}} \mcm{\twid}{1}{\widetilde{#1}}


% 4. SINGLE SYMBOLS

% Set theory

\mcm{\elt}{0}{\in} \mcm{\sub}{0}{\,\subseteq\,}
\mcm{\such}{0}{\:|\:} \mcm{\without}{0}{\setminus}

% Category theory

\mcm{\atsr}{0}{\Box} \mcm{\eqv}{0}{\,\simeq\,}
\mcm{\iso}{0}{\,\cong\,}
\mcm{\of}{0}{\raisebox{0.2mm}{\ensuremath{\scriptstyle\circ}}}

% Misc

\mcm{\bdry}{0}{\partial}


% 5. SPECIAL EXPRESSIONS

% Funny letters

\mcm{\Bee}{0}{\cat{B}} \mcm{\Beep}{0}{\cat{B'}}
\mcm{\Eee}{0}{\cat{E}} \mcm{\Eeep}{0}{\cat{E'}}
\newcommand{\epsln}{\varepsilon}
\mcm{\Ess}{0}{\cat{S}} \mcm{\Tee}{0}{\cat{T}}
\mcm{\Teep}{0}{\cat{T'}} \mcm{\Stee}{0}{\scat{T}}
\mcm{\Steep}{0}{\scat{T'}}

% Stars and blobs

\mcm{\blbk}{0}{\blank^{\blob}}
\mcm{\blob}{0}{\scriptscriptstyle{\bullet}}
\mcm{\stbk}{0}{\blank^{*}} \mcm{\ubl}{0}{{}^{\blob}}
\mcm{\ust}{0}{{}^{*}}

% Monads

\mcm{\Cartpr}{0}{\pr{\Eee}{T}} \mcm{\Cartprp}{0}{\pr{\Eeep}{T'}}
\mcm{\Mnd}{0}{\triple{T}{\eta}{\mu}}
\mcm{\Zeropr}{0}{\pr{\Set}{\id}}

% Pasting diagrams

\mcm{\dopset}{0}{\ftrcat{\Delta^{\op}}{\Set}}
\mcm{\tropset}{0}{\ftrcat{\fcat{TR}^{\op}}{\Set}}


% 6. CONSTANTS

% Roman

\mcm{\cod}{0}{\mr{cod}} \mcm{\dom}{0}{\mr{dom}}
\mcm{\End}{0}{\mr{End}} \mcm{\Hom}{0}{\mr{Hom}}
\mcm{\ob}{0}{\mr{ob}\,} \mcm{\op}{0}{\mr{op}}

% Italic

\mcm{\comp}{0}{\mi{comp}} \mcm{\id}{0}{\mi{id}}
\mcm{\ids}{0}{\mi{ids}} \mcm{\mult}{0}{\mi{mult}}
\mcm{\unit}{0}{\mi{unit}}

% Bold

\mcm{\Ab}{0}{\fcat{Ab}} \mcm{\Alg}{0}{\fcat{Alg}}
% \mcm{\Bicat}{0}{\fcat{Bicat}}
\mcm{\Bim}{1}{\fcat{Bim}(#1)} \mcm{\Cat}{0}{\fcat{Cat}}
\mcm{\Cay}{0}{\fcat{Cay}} \mcm{\Cpn}{1}{\pr{\Set/S_{#1}}{T_{#1}}}
\mcm{\fc}{0}{\fcat{fc}} \mcm{\fm}{0}{\fcat{fm}}
\mcm{\Graph}{0}{\fcat{Graph}} \mcm{\Gy}{0}{\fcat{Gy}}
\mcm{\Hpn}{1}{\pr{\Eee_{#1}}{P_{#1}}} \mcm{\Mon}{0}{\mb{Mon}}
\mcm{\Multicat}{0}{\fcat{Multicat}} \mcm{\One}{0}{\fcat{1}}
\mcm{\PD}{1}{\fcat{PD}_{#1}} \mcm{\Prof}{0}{\fcat{Prof}}
\mcm{\Set}{0}{\fcat{Set}} \mcm{\Span}{0}{\fcat{Span}}
\mcm{\Ssq}{0}{\fcat{Ssq}} \mcm{\Struc}{0}{\fcat{Struc}}
\mcm{\Sym}{0}{\fcat{Sym}} \mcm{\TR}{1}{\fcat{TR}(#1)}
\mcm{\Tr}{0}{\fcat{Tr}} \mcm{\Twocat}{0}{\fcat{2\hyph\Cat}}

% Blackboard bold

\mcm{\integers}{0}{\mathbb{Z}}


% 7. TUPLES

% Plain tuples

\mcm{\range}{2}{#1,\,\ldots\,,#2}
\mcm{\bftuple}{2}{\tuplebts{\range{#1}{#2}}}
\mcm{\tuple}{3}{\tuplebts{\range{#1,#2}{#3}}}
\mcm{\rttuple}{1}{\tuplebts{\,\ldots\,,#1}}
\mcm{\abftuple}{2}{\atuplebts{\range{#1}{#2}}}
\mcm{\atuple}{3}{\atuplebts{\range{#1,#2}{#3}}}
\mcm{\arttuple}{1}{\atuplebts{\,\ldots\,,#1}}
\mcm{\sqbftuple}{2}{\obt\range{#1}{#2}\cbt}
\mcm{\pr}{2}{\tuplebts{#1,#2}}
\mcm{\triple}{3}{\tuplebts{#1,#2,#3}}

% Homs

\mcm{\eend}{2}{#1[#2]} \mcm{\ehom}{3}{#1[#2,#3]}
\mcm{\ftrcat}{2}{[#1,#2]} \mcm{\homset}{3}{#1(#2,#3)}
\mcm{\multihom}{3}{#1(#2;#3)}
\mcm{\relhom}{5}{#1_{#2}(\range{#3}{#4};#5)}


% 8. ARROWS

% Single arrows

\mcm{\go}{0}{\rTo} \mcm{\goby}{1}{\rTo^{#1}}
\mcm{\goesto}{0}{\,\longmapsto\,} \mcm{\goiso}{0}{\goby{\diso}}
\mcm{\monic}{0}{\rMonic} \mcm{\og}{0}{\lTo}
\mcm{\ogby}{1}{\lTo^{#1}}

% Plural arrows

\mcm{\gph}{2}{\spn{#1}{T #2}{#2}} \mcm{\graph}{4}{\spaan{#1}{T
#2}{#2}{#3}{#4}} \mcm{\oppair}{2}{\stackrel{\rTo^{#1}}{\lTo_{#2}}}
\mcm{\parpair}{2}{\stackrel{\rTo^{#1}}{\rTo_{#2}}}
\mcm{\spn}{3}{#2 \og #1 \go #3} \mcm{\spaan}{5}{#2 \ogby{#4} #1
\goby{#5} #3}

% Slice objects

\mcm{\bktdvslob}{3}
    {\left(
    \begin{diagram}[height=1.5em]
    #1      \\
    \dTo>{\,#2} \\
    #3      \\
    \end{diagram}
    \right)}
\mcm{\slob}{3}{(#1 \goby{#2} #3)} \mcm{\vslob}{3}
    {\left.
    \begin{diagram}[height=1.5em]
    #1      \\
    \dTo>{\,#2} \\
    #3      \\
    \end{diagram}
    \right.}


% 9. PT DIAGRAMS

% Environments

\newenvironment{opetope}
    {\begin{diagram}[size=1em,abut,tight,noPS]}
    {\end{diagram}}
\newenvironment{slopeydiag}
    {\begin{diagram}[size=2em]}
    {\end{diagram}}
\newenvironment{tree}
    {\begin{diagram}[height=1em,width=.75em,abut,noPS,tight]}
    {\end{diagram}}
\newenvironment{triangdiag}
    {\begin{diagram}[width=1em,height=1.5em]}
    {\end{diagram}}

% Trees

\newcommand{\dn}{\dLine}
\mcm{\enode}{0}{\circ}
\newcommand{\lt}[1]{\ldLine(#1,2)}
\mcm{\nl}{1}{\stackrel{\textstyle #1}{\node}}
\mcm{\node}{0}{\bullet}
\newcommand{\rt}[1]{\rdLine(#1,2)}
\mcm{\utree}{0}{\node}


% Miscellaneous

\newcommand{\cnr}{} % for opetopes
\mcm{\diso}{0}{\sim}
\newcommand{\pullshape}
    {\setlength{\unitlength}{1em}
    \begin{picture}(2,5)(-1,-5)
    \put(0,-5){\line(1,1){1}}
    \put(0,-5){\line(-1,1){1}}
    \end{picture}}
\newcommand{\Spbk}{\overprint{\raisebox{-2.5em}{\pullshape}}}
\mcm{\vdiso}{0}{\wr}


% ********************************  E N D  ********************************

\newcommand{\fcm}{\vsn{FCM}}
\mcm{\nat}{0}{\mathbb{N}}
\newcommand{\absentpiccy}[1]{\mbox{\textsc{Picture: }\texttt{#1}}}
\newcommand{\piccy}[1]{\epsfig{file=#1}}

\mcm{\Onepr}{0}{\pr{\Graph}{\fc}}
\newlength{\nllwidth}
\newlength{\nllheight}
\newcommand{\stackbelow}[2]{%
\settowidth{\nllwidth}{\ensuremath{#1}\ensuremath{#2}}%
\settoheight{\nllheight}{\ensuremath{#2}}%
\addtolength{\nllheight}{.3ex}%
\mbox{%
\ensuremath{#1}%
\hspace{-.5\nllwidth}%
\raisebox{-1\nllheight}{\ensuremath{#2}}}}
\mcm{\nlal}{2}{\stackbelow{\nl{#1}}{#2}}
\mcm{\nll}{1}{\stackbelow{\node}{#1}} \mcm{\wun}{0}{\fcat{1}}
\mcm{\atuplebts}{1}{\langle #1 \rangle} \mcm{\tuplebts}{1}{(#1)}
\mcm{\bo}{0}{(} \mcm{\bc}{0}{)}
\mcm{\UBilax}{0}{\fcat{UBicat}_\mr{lax}}
\mcm{\UBiwk}{0}{\fcat{UBicat}_\mr{wk}}
\mcm{\UBistr}{0}{\fcat{UBicat}_\mr{str}}
\mcm{\Bilax}{0}{\fcat{Bicat}_\mr{lax}}
\mcm{\Biwk}{0}{\fcat{Bicat}_\mr{wk}}
\mcm{\Bistr}{0}{\fcat{Bicat}_\mr{str}} \mcm{\rotsub}{0}{\cup
\raisebox{0.1em}{$\scriptstyle{|}$}} \mcm{\pd}{0}{\fcat{pd}}
\mcm{\rep}{1}{\widehat{#1}} \mcm{\ovln}{1}{\overline{#1}}
\mcm{\Gph}{0}{\fcat{Gph}} \mcm{\tr}{0}{\fcat{tr}}
\newcommand{\UB}{\textbf{(UB)}}
\newcommand{\UF}{\textbf{(UF)}}
\newcommand{\CB}{\textbf{(CB)}}
\newcommand{\CF}{\textbf{(CF)}}
\mcm{\ladj}{0}{\,\dashv\,} \mcm{\zeropd}{0}{\node}
\newenvironment{ntdiag}
    {\begin{diagram}[size=1.5em,noPS]}  % added in noPS - looks nicer
                        % as diagonal arrow is
                        % shorter
    {\end{diagram}}
\mcm{\END}{0}{\fcat{End}} \mcm{\HOM}{0}{\fcat{Hom}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% hdpics

% PRESENTATION COMMANDS

% New lengths

\newlength{\gwidth} % the width of a glob
\newlength{\gvert}  % the overall vertical measurement
\newlength{\gdrop}  % the distance a labelled glob protrudes below the
            % text-line
\newlength{\gbaredrop}  % the distance from the textline to the bottom of the
                % unadorned glob
\newlength{\goffset}    % the distance from the centre of the glob to the
                % textline
\newlength{\gtemp}  % temporary register

% The `present' commands

\newcommand{\present}[1]{%
\makebox[1\gwidth]{%
\rule[-1\gdrop]{0ex}{1\gvert}%
\raisebox{-1\gbaredrop}{#1}}}

\newcommand{\presentl}[1]{%
\makebox[1\gwidth][l]{%
\rule[-1\gdrop]{0ex}{1\gvert}%
\raisebox{-1\gbaredrop}{#1}}}

\newcommand{\presentr}[1]{%
\makebox[1\gwidth][r]{%
\rule[-1\gdrop]{0ex}{1\gvert}%
\raisebox{-1\gbaredrop}{#1}}}

% Dimension commands

\newcommand{\ginitdims}[2]{%        % GLOBULAR VERSION
\setlength{\unitlength}{1em}%       % unitlength = 1em
\setlength{\goffset}{.25\unitlength}%   % globular offset = .25em
\setlength{\gwidth}{#1\unitlength}% % width as specified
\setlength{\gvert}{#2\unitlength}%  % vert = #2
\setlength{\gdrop}{.5\gvert}%       %
\addtolength{\gdrop}{-1\goffset}%   %
\setlength{\gbaredrop}{1\gdrop}%    % gdrop = drop = half(vert) - offset
\addtolength{\gvert}{.6\unitlength}%    % total extra clearance of .6em...
\addtolength{\gdrop}{.3\unitlength}}    % ...half of which is at bottom

\newcommand{\cinitdims}[2]{%        % CELLULAR VERSION
\setlength{\unitlength}{1em}%       % unitlength = 1em
\setlength{\goffset}{.35\unitlength}%   % cellular offset = .35em
\setlength{\gwidth}{#1\unitlength}% % width as specified
\setlength{\gvert}{#2\unitlength}%  % vert = #2
\setlength{\gdrop}{.5\gvert}%       %
\addtolength{\gdrop}{-1\goffset}%   %
\setlength{\gbaredrop}{1\gdrop}%    % gdrop = drop = half(vert) - offset
\addtolength{\gvert}{.6\unitlength}%    % total extra clearance of .6em...
\addtolength{\gdrop}{.3\unitlength}}    % ...half of which is at bottom

\newcommand{\gsinitdims}[2]{%       % SMALL GLOBULAR VERSION
\setlength{\unitlength}{0.5em}%     % unitlength = 0.5em
\setlength{\goffset}{.25\unitlength}%   % globular offset = .25em
\setlength{\gwidth}{#1\unitlength}% % width as specified
\setlength{\gvert}{#2\unitlength}%  % vert = #2
\setlength{\gdrop}{.5\gvert}%       %
\addtolength{\gdrop}{-1\goffset}%   %
\setlength{\gbaredrop}{1\gdrop}%    % gdrop = drop = half(vert) - offset
\addtolength{\gvert}{.6\unitlength}%    % total extra clearance of .6em...
\addtolength{\gdrop}{.3\unitlength}}    % ...half of which is at bottom

\newcommand{\sidespic}[1]{%
\settowidth{\gtemp}{\ensuremath{#1}}%
\addtolength{\gwidth}{1\gtemp}}

\newcommand{\abovepic}[1]{%
\settoheight{\gtemp}{\ensuremath{#1}}%
\addtolength{\gvert}{1\gtemp}%
\settodepth{\gtemp}{\ensuremath{#1}}%
\addtolength{\gvert}{1\gtemp}}

\newcommand{\belowpic}[1]{%
\settoheight{\gtemp}{\ensuremath{#1}}%
\addtolength{\gvert}{1\gtemp}%
\addtolength{\gdrop}{1\gtemp}%
\settodepth{\gtemp}{\ensuremath{#1}}%
\addtolength{\gvert}{1\gtemp}%
\addtolength{\gdrop}{1\gtemp}}


% MISC COMMANDS

\newcommand{\cell}[4]{\put(#1,#2){\makebox(0,0)[#3]{\ensuremath{#4}}}}
\mcm{\zmark}{0}{\scriptstyle{\bullet}}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% GLOBULAR PICTURES
%

\newcommand{\pregfst}[1]{%
\begin{picture}(0.5,0.2)(-0.5,-0.2)%
% label
\cell{-0.1}{-0.2}{tr}{#1}%
% dot
\cell{0}{0}{c}{\zmark}%
\end{picture}}

\mcm{\gfst}{1}{%
\ginitdims{0.5}{0.4}%
\sidespic{#1}%
\belowpic{#1}%
\presentr{\pregfst{#1}}}


\newcommand{\preglst}[1]{%
\begin{picture}(0.5,0.2)(0,-0.2)%
% label
\cell{0.1}{-0.2}{tl}{#1}%
% dot
\cell{0.05}{0}{c}{\zmark}%
\end{picture}}

\mcm{\glst}{1}{%
\ginitdims{.5}{.4}%
\sidespic{#1}%
\belowpic{#1}%
\presentl{\preglst{#1}}}


\newcommand{\preglft}[1]{%
\begin{picture}(0,0.2)(0,-0.2)%
% label
\cell{-0.1}{-0.2}{tr}{#1}%
% dot
\cell{0.05}{0}{c}{\zmark}%
\end{picture}}

\mcm{\glft}{1}{%
\ginitdims{0}{.4}%
\belowpic{#1}%
\present{\preglft{#1}}}


\newcommand{\pregrgt}[1]{%
\begin{picture}(0,0.2)(0,-0.2)%
% label
\cell{0.1}{-0.2}{tl}{#1}%
% dot
\cell{0.05}{0}{c}{\zmark}%
\end{picture}}

\mcm{\grgt}{1}{%
\ginitdims{0}{.4}%
\belowpic{#1}%
\present{\pregrgt{#1}}}


\newcommand{\pregblw}[1]{%
\begin{picture}(0,0.3)(0,-0.3)
% label
\cell{0}{-0.3}{t}{#1}%
% dot
\cell{0.05}{0}{c}{\zmark}%
\end{picture}}

\mcm{\gblw}{1}{%
\ginitdims{0}{.6}%
\belowpic{#1}%
\present{\pregblw{#1}}}

\newcommand{\pregfbw}[1]{%
\begin{picture}(0,0.65)(0,-0.65)
% label
\cell{0}{-0.65}{t}{#1}%
% dot
\cell{0.05}{0}{c}{\zmark}%
\end{picture}}

\mcm{\gfbw}{1}{%
\ginitdims{0}{1.3}%
\belowpic{#1}%
\present{\pregfbw{#1}}}

\newcommand{\pregzero}[1]{%
\begin{picture}(0.8,0.4)(-0.4,-0.4)
% label
\cell{0}{-0.4}{t}{#1}%
% dot
\cell{0}{0}{c}{\zmark}%
\end{picture}}

\mcm{\gzero}{1}{%
\ginitdims{0.8}{.6}%
\belowpic{#1}%
\sidespic{#1}%
\present{\pregzero{#1}}}


\newcommand{\pregone}[1]{%
\begin{picture}(5,0.4)(0,-0.2)%
% label
\cell{2.5}{0.2}{b}{#1}%
% arrow
\put(0,0){\vector(1,0){5}}%
\end{picture}}

\mcm{\gone}{1}{%
\ginitdims{5}{0.4}%
\abovepic{#1}%
\present{\pregone{#1}}}


\newcommand{\pregtwo}[3]{%
\begin{picture}(5,3.4)(0,-0.2)%
% labels
\cell{2.5}{3.2}{b}{#1}%
\cell{2.5}{-.2}{t}{#2}%
\cell{2.7}{1.5}{l}{#3}%
% arrows
\qbezier(0,1.5)(2.5,4.5)(5,1.5)%
\qbezier(0,1.5)(2.5,-1.5)(5,1.5)%
\put(5,1.5){\vector(1,-1){0}}%
\put(5,1.5){\vector(1,1){0}}%
\put(2.5,2.5){\vector(0,-1){2}}%
\end{picture}}

\mcm{\gtwo}{3}{%
\ginitdims{5}{3.4}%
\abovepic{#1}%
\belowpic{#2}%
\present{\pregtwo{#1}{#2}{#3}}}


\newcommand{\pregthree}[5]{%
\begin{picture}(5,5.4)(0,-1.2)%
% labels%
\cell{2.5}{4.2}{b}{#1}%
\cell{1.5}{1.7}{b}{#2}%
\cell{2.5}{-1.2}{t}{#3}%
\cell{2.7}{2.75}{l}{#4}%
\cell{2.7}{0.25}{l}{#5}%
% arrows%
\qbezier(0,1.5)(2.5,6.5)(5,1.5)%
\qbezier(0,1.5)(2.5,-3.5)(5,1.5)%
\put(0,1.5){\vector(1,0){5}}%
\put(2.5,3.5){\vector(0,-1){1.5}}%
\put(2.5,1){\vector(0,-1){1.5}}%
% arrowheads%
\put(5,1.5){\vector(1,-3){0}}%
\put(5,1.5){\vector(1,3){0}}%
\end{picture}}

\mcm{\gthree}{5}{%
\ginitdims{5}{5.4}%
\abovepic{#1}%
\belowpic{#3}%
\present{\pregthree{#1}{#2}{#3}{#4}{#5}}}


\newcommand{\pregfour}[7]{%
\begin{picture}(5,8.4)(0,-2.7)%
% labels%
\cell{2.5}{5.7}{b}{#1}%
\cell{1.5}{2.8}{b}{#2}%
\cell{1.5}{0.2}{t}{#3}%
\cell{2.5}{-2.7}{t}{#4}%
\cell{2.7}{4.25}{l}{#5}%
\cell{2.7}{1.5}{l}{#6}%
\cell{2.7}{-1.25}{l}{#7}%
% arrows%
\qbezier(0,1.5)(2.5,9.5)(5,1.5)%
\qbezier(0,1.5)(2.5,4)(5,1.5)%
\qbezier(0,1.5)(2.5,-1)(5,1.5)%
\qbezier(0,1.5)(2.5,-6.5)(5,1.5)%
\put(2.5,5.25){\vector(0,-1){2}}%
\put(2.5,2.5){\vector(0,-1){2}}%
\put(2.5,-0.25){\vector(0,-1){2}}%
% arrowheads%
\put(5,1.5){\vector(1,-4){0}}%
\put(5,1.5){\vector(4,-3){0}}%
\put(5,1.5){\vector(4,3){0}}%
\put(5,1.5){\vector(1,4){0}}%
\end{picture}}

\mcm{\gfour}{7}{%
\ginitdims{5}{8.4}%
\abovepic{#1}%
\belowpic{#4}%
\present{\pregfour{#1}{#2}{#3}{#4}{#5}{#6}{#7}}}


\newcommand{\pregthreecell}[5]{%
\begin{picture}(8,5)(-4,-2.5)%
% labels%
\cell{0}{2.5}{b}{#1}%
\cell{0}{-2.5}{t}{#2}%
\cell{-1.7}{0}{r}{#3}%
\cell{1.7}{0}{l}{#4}%
\cell{0}{0.2}{b}{#5}%
% arrows%
\qbezier(-4,0)(0,4.2)(4,0)%
\qbezier(-4,0)(0,-4.2)(4,0)%
\qbezier(-0.5,1.8)(-2.5,0)(-0.5,-1.8)%
\qbezier(0.5,1.8)(2.5,0)(0.5,-1.8)%
\put(-1,0){\vector(1,0){2}}%
% arrowheads%
\put(4,0){\vector(1,-1){0}}%
\put(4,0){\vector(1,1){0}}%
\put(-0.5,-1.8){\vector(1,-1){0}}%
\put(0.5,-1.8){\vector(-1,-1){0}}%
\end{picture}}

\mcm{\gthreecell}{5}{%
\ginitdims{8}{5}%
\abovepic{#1}%
\belowpic{#2}%
\present{\pregthreecell{#1}{#2}{#3}{#4}{#5}}}


%
% Special globular pictures
%

\newcommand{\pregthreecellu}{%
\begin{picture}(5,3.4)(-0.5,-0.2)%
% arrows%
\qbezier(-.5,1.5)(2,4.5)(4.5,1.5)%
\qbezier(-.5,1.5)(2,-1.5)(4.5,1.5)%
\qbezier(1.5,2.7)(0.5,1.5)(1.5,0.3)%
\qbezier(2.5,2.7)(3.5,1.5)(2.5,0.3)%
\put(1.3,1.5){\vector(1,0){1.4}}%
% arrowheads%
\put(4.5,1.5){\vector(1,-1){0}}%
\put(4.5,1.5){\vector(1,1){0}}%
\put(1.5,0.3){\vector(2,-3){0}}%
\put(2.5,0.3){\vector(-2,-3){0}}%
\end{picture}}

\mcm{\gthreecellu}{0}{%
\ginitdims{5}{3.4}%
\present{\pregthreecellu}}

\newcommand{\pregtwocentre}[3]{%
\begin{picture}(5,3.4)(0,-0.2)%
% labels
\cell{2.5}{3.2}{b}{#1}%
\cell{2.5}{-.2}{t}{#2}%
\cell{2.5}{1.5}{c}{#3}%
% arrows
\qbezier(0,1.5)(2.5,4.5)(5,1.5)%
\qbezier(0,1.5)(2.5,-1.5)(5,1.5)%
\put(5,1.5){\vector(1,-1){0}}%
\put(5,1.5){\vector(1,1){0}}%
\put(2.5,2.5){\vector(0,-1){2}}%
\end{picture}}

\mcm{\gtwocentre}{3}{%
\ginitdims{5}{3.4}%
\abovepic{#1}%
\belowpic{#2}%
\present{\pregtwocentre{#1}{#2}{#3}}}


\newcommand{\pregspecialone}[9]{%
\begin{picture}(8,8)(-4,-4)%
% labels%
\cell{0}{3.9}{b}{#1}%
\cell{-2}{-0.2}{t}{#2}%
\cell{0}{-3.9}{t}{#3}%
\cell{-1.5}{1.1}{r}{#4}%
\cell{0.2}{1.5}{l}{#5}%
\cell{1.5}{1.1}{l}{#6}%
\cell{0.2}{-2}{l}{#7}%
\cell{-0.9}{2.3}{b}{#8}%
\cell{0.9}{2.3}{b}{#9}%
% arrows%
\qbezier(-4,0)(0,8)(4,0)%
\qbezier(-4,0)(0,-8)(4,0)%
\qbezier(-0.5,3.4)(-3.5,2)(-0.5,0.6)%
\qbezier(0.5,3.4)(3.5,2)(0.5,0.6)%
\put(-4,0){\vector(1,0){8}}%
\put(0,3.4){\vector(0,-1){2.8}}%
\put(0,-0.8){\vector(0,-1){2.4}}%
\put(-1.5,2.2){\vector(1,0){1.2}}%
\put(0.3,2.2){\vector(1,0){1.2}}%
% arrowheads%
\put(4,0){\vector(1,-2){0}}%
\put(4,0){\vector(1,2){0}}%
\put(-0.5,0.6){\vector(2,-1){0}}%
\put(0.5,0.6){\vector(-2,-1){0}}%
\end{picture}}

\mcm{\gspecialone}{9}{%
\ginitdims{8}{8}%
\abovepic{#1}%
\belowpic{#3}%
\present{\pregspecialone{#1}{#2}{#3}{#4}{#5}{#6}{#7}{#8}{#9}}}


\newcommand{\pregspecialtwo}{%
\begin{picture}(5,3.4)(0,-0.2)%
% arrows
\qbezier(0,1.5)(2.5,4.5)(5,1.5)%
\qbezier(0,1.5)(2.5,-1.5)(5,1.5)%
\qbezier(1.7,2.5)(0,1.5)(1.7,0.5)%
\qbezier(3.3,2.5)(5,1.5)(3.3,0.5)%
% arrowheads
\put(5,1.5){\vector(1,-1){0}}%
\put(5,1.5){\vector(1,1){0}}%
\put(1.7,0.5){\vector(3,-2){0}}%
\put(3.3,0.5){\vector(-3,-2){0}}%
\put(2.5,2.5){\vector(0,-1){2}}%
\put(1.2,1.5){\vector(1,0){1}}%
\put(2.8,1.5){\vector(1,0){1}}%
\end{picture}}

\mcm{\gspecialtwo}{0}{%
\ginitdims{5}{3.4}%
\present{\pregspecialtwo}}


\newcommand{\pregspecialthree}{%
\begin{picture}(5,5.4)(0,-1.2)%
% arrows%
\qbezier(0,1.5)(2.5,6.5)(5,1.5)%
\qbezier(0,1.5)(2.5,-3.5)(5,1.5)%
\qbezier(2,3.5)(1,2.75)(2,2)%
\qbezier(3,3.5)(4,2.75)(3,2)%
\qbezier(2,1)(1,0.25)(2,-0.5)%
\qbezier(3,1)(4,0.25)(3,-0.5)%
\put(0,1.5){\vector(1,0){5}}%
\put(1.5,2.75){\vector(1,0){2}}%
\put(1.5,0.25){\vector(1,0){2}}%
% arrowheads%
\put(5,1.5){\vector(1,-3){0}}%
\put(5,1.5){\vector(1,3){0}}%
\put(2,2){\vector(1,-1){0}}%
\put(3,2){\vector(-1,-1){0}}%
\put(2,-0.5){\vector(1,-1){0}}%
\put(3,-0.5){\vector(-1,-1){0}}%
\end{picture}}

\mcm{\gspecialthree}{0}{%
\ginitdims{5}{5.4}%
\present{\pregspecialthree}}


\newcommand{\pregonew}[1]{%
\begin{picture}(8,0.4)(0,-0.2)%
% label
\cell{4}{0.2}{b}{#1}%
% arrow
\put(0,0){\vector(1,0){8}}%
\end{picture}}

\mcm{\gonew}{1}{%
\ginitdims{8}{0.4}%
\abovepic{#1}%
\present{\pregonew{#1}}}


\mcm{\gzersu}{0}{%
\gsinitdims{0}{.6}%
\present{\pregblw{}}}


\mcm{\gonesu}{0}{%
\gsinitdims{5}{0.4}%
\present{\pregone{}}}


\mcm{\gtwosu}{0}{%
\gsinitdims{5}{3.4}%
\present{\pregtwo{}{}{}}}


\mcm{\gthreesu}{0}{%
\gsinitdims{5}{5.4}%
\present{\pregthree{}{}{}{}{}}}


\mcm{\gfoursu}{0}{%
\gsinitdims{5}{8.4}%
\present{\pregfour{}{}{}{}{}{}{}}}




\newcommand{\precone}[1]{%
\begin{picture}(4.2,0.4)(-0.3,-0.2)%
% label
\cell{1.8}{0.2}{b}{#1}%
% arrow
\put(0,0){\vector(1,0){3.6}}%
\end{picture}}

\mcm{\cone}{1}{%
\cinitdims{4.2}{0.4}%
\abovepic{#1}%
\present{\precone{#1}}}

\mcm{\gfstsu}{0}{%
\gsinitdims{0.5}{0.4}%
\presentr{\pregfst{}}}

\mcm{\glstsu}{0}{%
\gsinitdims{0.5}{0.4}%
\presentl{\preglst{}}}


% Cellular cells with double and triple arrows (drawn full-length, not with
% LaTeX characters)

\newcommand{\prectwodbl}[3]%
{\begin{picture}(4.2,3.4)(-0.1,-0.2)%
% labels%
\cell{2}{3.2}{b}{#1}%
\cell{2}{-0.2}{t}{#2}%
\cell{2.3}{1.5}{l}{#3}%
% arrows%
\qbezier(0,2)(2,4)(4,2)%
\qbezier(0,1)(2,-1)(4,1)%
\put(4,2){\vector(1,-1){0}}%
\put(4,1){\vector(1,1){0}}%
\put(1.9,2.5){\line(0,-1){1.8}}%
\put(2.1,2.5){\line(0,-1){1.8}}%
\cell{2.01}{0.4}{b}{\vee}%
\end{picture}}

\mcm{\ctwodbl}{3}{%
\cinitdims{4.2}{3.4}%
\abovepic{#1}%
\belowpic{#2}%
\present{\prectwodbl{#1}{#2}{#3}}}


\newcommand{\precthreedbl}[5]{%
\begin{picture}(4.2,5.4)(-0.1,-0.2)%
% labels%
\cell{2}{5.2}{b}{#1}%
\cell{1}{2.7}{b}{#2}%
\cell{2}{-.2}{t}{#3}%
\cell{2.3}{3.75}{l}{#4}%
\cell{2.3}{1.25}{l}{#5}%
% arrows%
\qbezier(0,3)(2,7)(4,3)%
\qbezier(0,2)(2,-2)(4,2)%
\put(0,2.5){\vector(1,0){4}}%
\put(1.9,4.5){\line(0,-1){1.3}}%
\put(2.1,4.5){\line(0,-1){1.3}}%
\cell{2.01}{2.9}{b}{\vee}%
\put(1.9,2){\line(0,-1){1.3}}%
\put(2.1,2){\line(0,-1){1.3}}%
\cell{2.01}{0.4}{b}{\vee}%
% arrowheads%
\put(4,3){\vector(1,-3){0}}%
\put(4,2){\vector(1,3){0}}%
\end{picture}}

\mcm{\cthreedbl}{5}{%
\cinitdims{4.2}{5.4}%
\abovepic{#1}%
\belowpic{#3}%
\present{\precthreedbl{#1}{#2}{#3}{#4}{#5}}}


\newcommand{\precthreecelltrp}[5]{%
\begin{picture}(8.2,5)(-4.1,-2.5)%
% labels%
\cell{0}{2.5}{b}{#1}%
\cell{0}{-2.5}{t}{#2}%
\cell{-1.8}{0}{r}{#3}%
\cell{1.8}{0}{l}{#4}%
\cell{0}{0.3}{b}{#5}%
% arrows%
\qbezier(-4,0.5)(0,4)(4,0.5)%
\qbezier(-4,-0.5)(0,-4)(4,-0.5)%
\qbezier(-0.6,2)(-2.6,0)(-0.6,-2)%
\qbezier(-0.4,2)(-2.4,0)(-0.5,-1.9)%
\cell{-0.6}{-2}{b}{\lrcorner}%
\qbezier(0.4,2)(2.4,0)(0.5,-1.9)%
\qbezier(0.6,2)(2.6,0)(0.6,-2)%
\cell{0.65}{-2}{b}{\llcorner}%
\put(-1,0.15){\line(1,0){1.7}}%
\put(-1,0){\line(1,0){2}}%
\put(-1,-0.15){\line(1,0){1.7}}%
\cell{1.15}{0}{r}{>}%
% arrowheads%
\put(4,0.5){\vector(1,-1){0}}%
\put(4,-0.5){\vector(1,1){0}}%
\end{picture}}

\mcm{\cthreecelltrp}{5}{%
\cinitdims{8.2}{5}%
\abovepic{#1}%
\belowpic{#2}%
\present{\precthreecelltrp{#1}{#2}{#3}{#4}{#5}}}



%
% CELLULAR PICTURES
%


\newcommand{\prectwo}[3]%
{\begin{picture}(4.2,3.4)(-0.1,-0.2)%
% labels%
\cell{2}{3.2}{b}{#1}%
\cell{2}{-0.2}{t}{#2}%
\cell{2.2}{1.5}{l}{#3}%
% arrows%
\qbezier(0,2)(2,4)(4,2)%
\qbezier(0,1)(2,-1)(4,1)%
\put(4,2){\vector(1,-1){0}}%
\put(4,1){\vector(1,1){0}}%
\put(2,2.5){\vector(0,-1){2}}%
\end{picture}}

\mcm{\ctwo}{3}{%
\cinitdims{4.2}{3.4}%
\abovepic{#1}%
\belowpic{#2}%
\present{\prectwo{#1}{#2}{#3}}}

\newcommand{\precthree}[5]{%
\begin{picture}(4.2,5.4)(-0.1,-0.2)%
% labels%
\cell{2}{5.2}{b}{#1}%
\cell{1}{2.7}{b}{#2}%
\cell{2}{-.2}{t}{#3}%
\cell{2.2}{3.75}{l}{#4}%
\cell{2.2}{1.25}{l}{#5}%
% arrows%
\qbezier(0,3)(2,7)(4,3)%
\qbezier(0,2)(2,-2)(4,2)%
\put(0,2.5){\vector(1,0){4}}%
\put(2,4.5){\vector(0,-1){1.5}}%
\put(2,2){\vector(0,-1){1.5}}%
% arrowheads%
\put(4,3){\vector(1,-3){0}}%
\put(4,2){\vector(1,3){0}}%
\end{picture}}

\mcm{\cthree}{5}{%
\cinitdims{4.2}{5.4}%
\abovepic{#1}%
\belowpic{#3}%
\present{\precthree{#1}{#2}{#3}{#4}{#5}}}


%
% Special cellular pictures (horizontal)
%


\newcommand{\prectwoop}[3]%
{\begin{picture}(4.2,3.4)(-0.1,-0.2)%
% labels%
\cell{2}{3.2}{b}{#1}%
\cell{2}{-0.2}{t}{#2}%
\cell{2.2}{1.5}{l}{#3}%
% arrows%
\qbezier(0,2)(2,4)(4,2)%
\qbezier(0,1)(2,-1)(4,1)%
\put(0,2){\vector(-1,-1){0}}%
\put(0,1){\vector(-1,1){0}}%
\put(2,2.5){\vector(0,-1){2}}%
\end{picture}}

\mcm{\ctwoop}{3}{%
\cinitdims{4.2}{3.4}%
\abovepic{#1}%
\belowpic{#2}%
\present{\prectwoop{#1}{#2}{#3}}}


\newcommand{\prectwopar}[4]{%
\begin{picture}(4.2,3.4)(-0.1,-0.2)%
% labels%
\cell{2}{3.2}{b}{#1}%
\cell{2}{-0.2}{t}{#2}%
\cell{1.6}{1.5}{r}{#3}%
\cell{2.4}{1.5}{l}{#4}%
% arrows%
\qbezier(0,2)(2,4)(4,2)%
\qbezier(0,1)(2,-1)(4,1)%
\put(4,2){\vector(1,-1){0}}%
\put(4,1){\vector(1,1){0}}%
\put(1.8,2.5){\vector(0,-1){2}}%
\put(2.2,2.5){\vector(0,-1){2}}%
\end{picture}}

\mcm{\ctwopar}{4}{%
\cinitdims{4.2}{3.4}%
\abovepic{#1}%
\belowpic{#2}%
\present{\prectwopar{#1}{#2}{#3}{#4}}}



\newcommand{\precthreein}[5]{%
\begin{picture}(4.2,5.4)(-0.1,-0.2)%
% labels%
\cell{2}{5.2}{b}{#1}%
\cell{1}{2.7}{b}{#2}%
\cell{2}{-.2}{t}{#3}%
\cell{2.2}{3.75}{l}{#4}%
\cell{2.2}{1.25}{l}{#5}%
% arrows%
\qbezier(0,3)(2,7)(4,3)%
\qbezier(0,2)(2,-2)(4,2)%
\put(0,2.5){\vector(1,0){4}}%
\put(2,4.5){\vector(0,-1){1.5}}%
\put(2,0.5){\vector(0,1){1.5}}%
% arrowheads%
\put(4,3){\vector(1,-3){0}}%
\put(4,2){\vector(1,3){0}}%
\end{picture}}

\mcm{\cthreein}{5}{%
\cinitdims{4.2}{5.4}%
\abovepic{#1}%
\belowpic{#3}%
\present{\precthreein{#1}{#2}{#3}{#4}{#5}}}


\newcommand{\precthreecell}[5]{%
\begin{picture}(8.2,5)(-4.1,-2.5)%
% labels%
\cell{0}{2.5}{b}{#1}%
\cell{0}{-2.5}{t}{#2}%
\cell{-1.7}{0}{r}{#3}%
\cell{1.7}{0}{l}{#4}%
\cell{0}{0.2}{b}{#5}%
% arrows%
\qbezier(-4,0.5)(0,4)(4,0.5)%
\qbezier(-4,-0.5)(0,-4)(4,-0.5)%
\qbezier(-0.5,2)(-2.5,0)(-0.5,-2)%
\qbezier(0.5,2)(2.5,0)(0.5,-2)%
\put(-1,0){\vector(1,0){2}}%
% arrowheads%
\put(4,0.5){\vector(1,-1){0}}%
\put(4,-0.5){\vector(1,1){0}}%
\put(-0.5,-2){\vector(1,-1){0}}%
\put(0.5,-2){\vector(-1,-1){0}}%
\end{picture}}

\mcm{\cthreecell}{5}{%
\cinitdims{8.2}{5}%
\abovepic{#1}%
\belowpic{#2}%
\present{\precthreecell{#1}{#2}{#3}{#4}{#5}}}


\newcommand{\precthreecellpar}[6]{%
\begin{picture}(8.2,5)(-4.1,-2.5)%
% labels%
\cell{0}{2.5}{b}{#1}%
\cell{0}{-2.5}{t}{#2}%
\cell{-1.7}{0}{r}{#3}%
\cell{1.7}{0}{l}{#4}%
\cell{0}{0.4}{b}{#5}%
\cell{0}{-0.4}{t}{#6}%
% arrows%
\qbezier(-4,0.5)(0,4)(4,0.5)%
\qbezier(-4,-0.5)(0,-4)(4,-0.5)%
\qbezier(-0.5,2)(-2.5,0)(-0.5,-2)%
\qbezier(0.5,2)(2.5,0)(0.5,-2)%
\put(-1,0.2){\vector(1,0){2}}%
\put(-1,-0.2){\vector(1,0){2}}%
% arrowheads%
\put(4,0.5){\vector(1,-1){0}}%
\put(4,-0.5){\vector(1,1){0}}%
\put(-0.5,-2){\vector(1,-1){0}}%
\put(0.5,-2){\vector(-1,-1){0}}%
\end{picture}}

\mcm{\cthreecellpar}{6}{%
\cinitdims{8.2}{5}%
\abovepic{#1}%
\belowpic{#2}%
\present{\precthreecellpar{#1}{#2}{#3}{#4}{#5}{#6}}}


%
% Special cellular pictures (vertical)
%



\newcommand{\prectwov}[5]{%
\begin{picture}(3.4,4.2)(0.8,0.9)%
% labels%
\cell{2.5}{5.1}{b}{#1}%
\cell{2.5}{0.9}{t}{#2}%
\cell{0.8}{3}{r}{#3}%
\cell{4.2}{3}{l}{#4}%
\cell{2.5}{3.2}{b}{#5}%
% arrows%
\qbezier(2,5)(0,3)(2,1)%
\qbezier(3,5)(5,3)(3,1)%
\put(2,1){\vector(1,-1){0}}%
\put(3,1){\vector(-1,-1){0}}%
\put(1.5,3){\vector(1,0){2}}%
\end{picture}}

\mcm{\ctwov}{5}{%
\cinitdims{3.4}{4.2}%
\abovepic{#1}%
\belowpic{#2}%
\sidespic{#3}%
\sidespic{#4}%
\present{\prectwov{#1}{#2}{#3}{#4}{#5}}}



\newcommand{\precthreecellv}[7]{%
\begin{picture}(5,8.2)(0.5,-1.6)%
% labels%
\cell{3}{6.6}{b}{#1}%
\cell{3}{-1.6}{t}{#2}%
\cell{0.5}{2.5}{r}{#3}%
\cell{5.5}{2.5}{l}{#4}%
\cell{3}{4.2}{b}{#5}%
\cell{3}{0.8}{t}{#6}%
\cell{3.2}{2.5}{l}{#7}%
% arrows%
\qbezier(3.5,6.5)(7,2.5)(3.5,-1.5)%
\qbezier(2.5,6.5)(-1,2.5)(2.5,-1.5)%
\put(2.5,-1.5){\vector(1,-1){0}}%
\put(3.5,-1.5){\vector(-1,-1){0}}%
\qbezier(1,3)(3,5)(5,3)%
\qbezier(1,2)(3,0)(5,2)%
\put(5,3){\vector(1,-1){0}}%
\put(5,2){\vector(1,1){0}}%
\put(3,3.5){\vector(0,-1){2}}%
\end{picture}}

\mcm{\cthreecellv}{7}{%
\cinitdims{5}{8.2}%
\abovepic{#1}%
\belowpic{#2}%
\sidespic{#3}%
\sidespic{#4}%
\present{\precthreecellv{#1}{#2}{#3}{#4}{#5}{#6}{#7}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% OPETOPES
%

\newcommand{\pretopez}[2]{%
\begin{picture}(2.6,2.3)(-1.3,-2.2)%
% labels
\cell{0}{-2.2}{t}{#1}%
\cell{0}{-1.2}{c}{#2}%
% dot
% \cell{0}{0}{c}{\zmark}%
% edge
\qbezier(0,0)(-2,-2)(0,-2)%
\qbezier(0,0)(2,-2)(0,-2)%
% arrowhead
\put(0,0){\vector(-1,1){0}}%
\end{picture}}

\mcm{\topez}{2}{%
\ginitdims{2.6}{2.3}%
\belowpic{#1}%
\present{\pretopez{#1}{#2}}}


\newcommand{\pretopea}[3]{%
\begin{picture}(4,1.9)(-2,-0,2)%
% labels
\cell{0}{1.7}{b}{#1}%
\cell{0}{-0.2}{t}{#2}%
\cell{0}{0.7}{c}{#3}%
% edges
\qbezier(-2,0)(0,3)(2,0)%
\put(-2,0){\vector(1,0){4}}%
% arrowhead
\put(2,0){\vector(2,-3){0}}%
\end{picture}}

\mcm{\topea}{3}{%
\ginitdims{4}{1.9}%
\abovepic{#1}%
\belowpic{#2}%
\present{\pretopea{#1}{#2}{#3}}}


\newcommand{\pretopeb}[4]{%
\begin{picture}(4,2.2)(-2,-0.2)%
% labels
\cell{-1.1}{1}{br}{#1}%
\cell{1.1}{1}{bl}{#2}%
\cell{0}{-0.2}{t}{#3}%
\cell{0}{0.8}{c}{#4}%
% edges
\put(-2,0){\vector(1,1){2}}%
\put(0,2){\vector(1,-1){2}}%
\put(-2,0){\vector(1,0){4}}%
\end{picture}}

\mcm{\topeb}{4}{%
\ginitdims{4}{2.2}%
\belowpic{#3}%
\present{\pretopeb{#1}{#2}{#3}{#4}}}


\newcommand{\pretopec}[5]{%
\begin{picture}(4,2.2)(-2,-0.2)%
% labels
\cell{-1.8}{1}{br}{#1}%
\cell{0}{2.2}{b}{#2}%
\cell{1.8}{1}{bl}{#3}%
\cell{0}{-0.2}{t}{#4}%
\cell{0}{0.8}{c}{#5}%
% edges
\put(-2,0){\vector(1,2){1}}%
\put(-1,2){\vector(1,0){2}}%
\put(1,2){\vector(1,-2){1}}%
\put(-2,0){\vector(1,0){4}}%
\end{picture}}

\mcm{\topec}{5}{%
\ginitdims{4}{2.2}%
\sidespic{#1}%
\abovepic{#2}%
\sidespic{#3}%
\belowpic{#4}%
\present{\pretopec{#1}{#2}{#3}{#4}{#5}}}


\newcommand{\pretoped}[6]{%
\begin{picture}(4,2.5)(-2,-0.2)%
% labels
\cell{-2}{0.6}{br}{#1}%
\cell{-0.7}{2.2}{br}{#2}%
\cell{0.7}{2.2}{bl}{#3}%
\cell{2}{0.6}{bl}{#4}%
\cell{0}{-0.2}{t}{#5}%
\cell{0}{0.8}{c}{#6}%
% edges
\put(-2,0){\vector(1,3){0.5}}%
\put(-1.5,1.5){\vector(3,2){1.5}}%
\put(0,2.5){\vector(3,-2){1.5}}%
\put(1.5,1.5){\vector(1,-3){0.5}}%
\put(-2,0){\vector(1,0){4}}%
\end{picture}}

\mcm{\toped}{6}{%
\ginitdims{4}{2.5}%
\sidespic{#1}%
\abovepic{#2}%
\abovepic{#3}%
\sidespic{#4}%
\belowpic{#5}%
\present{\pretoped{#1}{#2}{#3}{#4}{#5}{#6}}}


\newcommand{\pretopeq}[5]{%
\begin{picture}(4,2.5)(-2,-0.2)%
% labels
\cell{-2}{0.6}{br}{#1}%
\cell{-1}{2.2}{br}{#2}%
\cell{2}{0.6}{bl}{#3}%
\cell{0}{-0.2}{t}{#4}%
\cell{0}{0.8}{c}{#5}%
% edges
\put(-2,0){\vector(1,3){0.5}}%
\put(-1.5,1.5){\vector(1,1){1}}%
\cell{0.9}{2.3}{c}{\ddots}
\put(1.5,1.5){\vector(1,-3){0.5}}%
\put(-2,0){\vector(1,0){4}}%
\end{picture}}

\mcm{\topeq}{5}{%
\ginitdims{4}{2.5}%
\sidespic{#1}%
\abovepic{#2}%
\sidespic{#3}%
\belowpic{#4}%
\present{\pretopeq{#1}{#2}{#3}{#4}{#5}}}


\newcommand{\pretopebase}[1]{%
\begin{picture}(4,0.4)(0,-0.2)%
% label
\cell{2}{0.2}{b}{#1}%
% arrow
\put(0,0){\vector(1,0){4}}%
\end{picture}}

\mcm{\topebase}{1}{%
\ginitdims{4}{0.4}%
\abovepic{#1}%
\present{\pretopebase{#1}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% OPETOPES STRIPPED OF ARROWHEADS
%

\newcommand{\pretopezs}[2]{%
\begin{picture}(2.6,2.3)(-1.3,-2.2)%
% labels
\cell{0}{-2.2}{t}{#1}%
\cell{0}{-1.2}{c}{#2}%
% dot
% \cell{0}{0}{c}{\zmark}%
% edge
\qbezier(0,0)(-2,-2)(0,-2)%
\qbezier(0,0)(2,-2)(0,-2)%
\end{picture}}

\mcm{\topezs}{2}{%
\ginitdims{2.6}{2.3}%
\belowpic{#1}%
\present{\pretopezs{#1}{#2}}}


\newcommand{\pretopeas}[3]{%
\begin{picture}(4,1.9)(-2,-0,2)%
% labels
\cell{0}{1.7}{b}{#1}%
\cell{0}{-0.2}{t}{#2}%
\cell{0}{0.7}{c}{#3}%
% edges
\qbezier(-2,0)(0,3)(2,0)%
\put(-2,0){\line(1,0){4}}%
\end{picture}}

\mcm{\topeas}{3}{%
\ginitdims{4}{1.9}%
\abovepic{#1}%
\belowpic{#2}%
\present{\pretopeas{#1}{#2}{#3}}}


\newcommand{\pretopebs}[4]{%
\begin{picture}(4,2.2)(-2,-0.2)%
% labels
\cell{-1.1}{1}{br}{#1}%
\cell{1.1}{1}{bl}{#2}%
\cell{0}{-0.2}{t}{#3}%
\cell{0}{0.8}{c}{#4}%
% edges
\put(-2,0){\line(1,1){2}}%
\put(0,2){\line(1,-1){2}}%
\put(-2,0){\line(1,0){4}}%
\end{picture}}

\mcm{\topebs}{4}{%
\ginitdims{4}{2.2}%
\belowpic{#3}%
\present{\pretopebs{#1}{#2}{#3}{#4}}}


\newcommand{\pretopecs}[5]{%
\begin{picture}(4,2.2)(-2,-0.2)%
% labels
\cell{-1.8}{1}{br}{#1}%
\cell{0}{2.2}{b}{#2}%
\cell{1.8}{1}{bl}{#3}%
\cell{0}{-0.2}{t}{#4}%
\cell{0}{0.8}{c}{#5}%
% edges
\put(-2,0){\line(1,2){1}}%
\put(-1,2){\line(1,0){2}}%
\put(1,2){\line(1,-2){1}}%
\put(-2,0){\line(1,0){4}}%
\end{picture}}

\mcm{\topecs}{5}{%
\ginitdims{4}{2.2}%
\sidespic{#1}%
\abovepic{#2}%
\sidespic{#3}%
\belowpic{#4}%
\present{\pretopecs{#1}{#2}{#3}{#4}{#5}}}


\newcommand{\pretopeds}[6]{%
\begin{picture}(4,2.5)(-2,-0.2)%
% labels
\cell{-2}{0.6}{br}{#1}%
\cell{-0.7}{2.2}{br}{#2}%
\cell{0.7}{2.2}{bl}{#3}%
\cell{2}{0.6}{bl}{#4}%
\cell{0}{-0.2}{t}{#5}%
\cell{0}{0.8}{c}{#6}%
% edges
\put(-2,0){\line(1,3){0.5}}%
\put(-1.5,1.5){\line(3,2){1.5}}%
\put(0,2.5){\line(3,-2){1.5}}%
\put(1.5,1.5){\line(1,-3){0.5}}%
\put(-2,0){\line(1,0){4}}%
\end{picture}}

\mcm{\topeds}{6}{%
\ginitdims{4}{2.5}%
\sidespic{#1}%
\abovepic{#2}%
\abovepic{#3}%
\sidespic{#4}%
\belowpic{#5}%
\present{\pretopeds{#1}{#2}{#3}{#4}{#5}{#6}}}


\newcommand{\pretopeqs}[5]{%
\begin{picture}(4,2.5)(-2,-0.2)%
% labels
\cell{-2}{0.6}{br}{#1}%
\cell{-1}{2.2}{br}{#2}%
\cell{2}{0.6}{bl}{#3}%
\cell{0}{-0.2}{t}{#4}%
\cell{0}{0.8}{c}{#5}%
% edges
\put(-2,0){\line(1,3){0.5}}%
\put(-1.5,1.5){\line(1,1){1}}%
\cell{0.9}{2.3}{c}{\ddots}
\put(1.5,1.5){\line(1,-3){0.5}}%
\put(-2,0){\line(1,0){4}}%
\end{picture}}

\mcm{\topeqs}{5}{%
\ginitdims{4}{2.5}%
\sidespic{#1}%
\abovepic{#2}%
\sidespic{#3}%
\belowpic{#4}%
\present{\pretopeqs{#1}{#2}{#3}{#4}{#5}}}


\newcommand{\pretopebases}[1]{%
\begin{picture}(4,0.4)(0,-0.2)%
% label
\cell{2}{0.2}{b}{#1}%
% arrow
\put(0,0){\line(1,0){4}}%
\end{picture}}

\mcm{\topebases}{1}{%
\ginitdims{4}{0.4}%
\abovepic{#1}%
\present{\pretopebases{#1}}}


% Notes and changes
%
% ctwocellv has been changed to ctwov


% This is a new one, adapted from gfour and used in defn.tex (thesis)

\newcommand{\pregdots}[6]{%
\begin{picture}(5,8.4)(0,-2.7)%
% labels%
\cell{2.5}{5.7}{b}{#1}%
\cell{1.5}{2.8}{b}{#2}%
\cell{1.5}{0.2}{t}{#3}%
\cell{2.5}{-2.7}{t}{#4}%
\cell{2.7}{4.25}{l}{#5}%
\cell{2.7}{-1.25}{l}{#6}%
% arrows%
\qbezier(0,1.5)(2.5,9.5)(5,1.5)%
\qbezier(0,1.5)(2.5,4)(5,1.5)%
\qbezier(0,1.5)(2.5,-1)(5,1.5)%
\qbezier(0,1.5)(2.5,-6.5)(5,1.5)%
\put(2.5,5.25){\vector(0,-1){2}}%
\put(2.5,-0.25){\vector(0,-1){2}}%
% vertical ellipsis%
\cell{2.5}{1.7}{c}{\vdots}%
% arrowheads%
\put(5,1.5){\vector(1,-4){0}}%
\put(5,1.5){\vector(4,-3){0}}%
\put(5,1.5){\vector(4,3){0}}%
\put(5,1.5){\vector(1,4){0}}%
\end{picture}}

\mcm{\gdots}{6}{%
\ginitdims{5}{8.4}%
\abovepic{#1}%
\belowpic{#4}%
\present{\pregdots{#1}{#2}{#3}{#4}{#5}{#6}}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% Tree shapes

% generic tree of height 1
%
\newcommand{\GenericOne}[3]
{\begin{tree}
\nl{#1} &   &\nl{#2}&   &   &\cdots & & &\nl{#3}    \\
    &\rt{4} &   &\rt{2} &   &   & &\lt{4} & \\
    &   &   &   &\node  &   & & &       \\
\end{tree}}

% empty-headed tree of height 1
%
\newcommand{\EmptyOne}
{\begin{tree}
\enode  \\
\dn \\
\node   \\
\end{tree}}

% 0,5,3,1 is 'formation' of this tree; there are 5 leaves
%
\newcommand{\Oak}[5]
{\begin{tree}
 & & & &\enode& & & & & & & & \\
 & & & &\dn& & & & & & & & \\
\nl{#1}& &\nl{#2}& &\node& & & &\nl{#4}& & & &\nl{#5}\\
 &\rt{2}&\dn&\lt{2}& & & & & &\rt{2}& &\lt{2}& \\
 & &\node& & & &\nl{#3}& & & &\node& & \\
 & & &\rt{4}& & &\dn& & &\lt{4}& & & \\
 & & & & & &\node& & & & & & \\
\end{tree}}

% 0,2,2,1; 2
%
\newcommand{\Pear}[3]
{\begin{tree}
    &   &   &   &\enode &&  &   &   \\
    &   &   &   &\dn    &&  &   &   \\
\nl{#1}&    &   &   &\node  &&  &   &   \\
    &\rt{2} &   &\lt{2} &   &&  &   &   \\
    &   &\node  &   &   &&  &   &\nl{#2}\\
    &   &   &\rt{4} &   &&  &\lt{2} &   \\
    &   &   &   &   &&\nll{#3}& &   \\
\end{tree}}

% 1,2,1; 2
%
\newcommand{\Orange}[3]
{\begin{tree}
    &   &   &   &\nl{#2}\\
    &   &   &   &\dn    \\
\nl{#1}&    &   &   &\node  \\
    &\rt{2} &   &\lt{2} &   \\
    &   &\nll{#3}&  &   \\
\end{tree}}

% 0,3,1,1; 2
%
\newcommand{\Apple}[3]
{\begin{tree}
    &   &\enode &   &   \\
    &   &\dn    &   &   \\
\nl{#1} &   &\node  &   &\nl{#2}\\
    &\rt{2} &\dn    &\lt{2} &   \\
    &   &\node  &   &   \\
    &   &\dn    &   &   \\
    &   &\nll{#3}&  &   \\
\end{tree}}

% This is orange and apple substituted into pear
% 1,5,3,2,1; 4
%
\newcommand{\MixedFruit}[5]
{\begin{tree}
 & & & &\nl{#2}& & & & & & &\enode& & \\
 & & & &\dn    & & & & & & &\dn   & & \\
\nl{#1}& & & &\node& & &\enode& &\nl{#3}& &\node& &\nl{#4}\\
 &\rt{2}& &\lt{2}& & & &\dn& & &\rt{2}&\dn&\lt{2}& \\
 & &\node& & & & &\node& & & &\node& & \\
 & & &\rt{3}& & &\lt{2}& & & & &\dn& & \\
 & & & & &\node& & & & & &\node& & \\
 & & & & & &\rt{3}& & & &\lt{3}& & & \\
 & & & & & & & &\nll{#5}& & & & & \\
\end{tree}}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Unlabelled trees

\newcommand{\treedc}{
\begin{tree}
\node &\node            &\node &      &      &\node \\
      &\rt{1} \dn \lt{1}&      &      &      & \dn  \\
      &\node            &      &\node &      &\node \\
      &                 &\rt{2}&\dn   &\lt{2}&      \\
      &                 &      &\node &      &      \\
\end{tree}}

\newcommand{\treedcbang}{
\begin{tree}
\node &                 &\node &      &      &\node \\
      &\rt{1}     \lt{1}&      &      &      & \dn  \\
      &\node            &      &\node &      &\node \\
      &                 &\rt{2}&\dn   &\lt{2}&      \\
      &                 &      &\node &      &      \\
\end{tree}}

\newcommand{\treec}{
\begin{tree}
\node   &   &\node  &   &\node  \\
    &\rt{2} &\dn    &\lt{2} &   \\
    &   &\node  &   &   \\
\end{tree}}

\newcommand{\treecc}{
\begin{tree}
    &   &   &\node  &\node          &\node  \\
    &   &   &   &\rt{1} \dn \lt{1}  &   \\
\node   &   &\node  &   &\node          &   \\
    &\rt{2} &\dn    &\lt{2} &           &   \\
    &   &\node  &   &           &   \\
\end{tree}}

\newcommand{\treeccbang}{
\begin{tree}
    &   &   &\node  &           &\node  \\
    &   &   &   &\rt{1}  \lt{1}     &   \\
\node   &   &\node  &   &\node          &   \\
    &\rt{2} &\dn    &\lt{2} &           &   \\
    &   &\node  &   &           &   \\
\end{tree}}

\newcommand{\treegc}{
\begin{tree}
\node &\node    &\node  &   &\node  &\node  &\node      &\node  \\
&\rt{1} \dn \lt{1}& &   &   &\rt{1}\dn\lt{1}&\lt{2} &   \\
    &\node  &   &\node  &   &\node  &       &   \\
    &   &\rt{2} &\dn    &\lt{2} &   &       &   \\
    &   &   &\node  &   &   &       &   \\
\end{tree}}

\newcommand{\treegcbang}{
\begin{tree}
\node &     &\node  &   &\node  &\node  &\node      &   \\
&\rt{1}  \lt{1} &   &   &   &\rt{1}\dn\lt{1}&   &   \\
    &\node  &   &\node  &   &\node  &       &   \\
    &   &\rt{2} &\dn    &\lt{2} &   &       &   \\
    &   &   &\node  &   &   &       &   \\
\end{tree}}

\newcommand{\treebaa}{
\begin{tree}
\node   &       &\node  \\
    &\rt{1}\lt{1}   &   \\
    &\node      &   \\
    &\dn        &   \\
    &\node      &   \\
    &\dn        &   \\
    &\node      &   \\
\end{tree}}

\newcommand{\treeba}{
\begin{tree}
\node   &       &\node  \\
    &\rt{1}\lt{1}   &   \\
    &\node      &   \\
    &\dn        &   \\
    &\node      &   \\
\end{tree}}

\newcommand{\treebcb}{
\begin{tree}
\node   &   &\node  &   &   &   \\
    &\rt{1}\lt{1}&  &   &   &   \\
    &\node  &   &\node  &   &\node  \\
    &\dn    &   &   &\rt{1}\lt{1}&  \\
    &\node  &   &   &\node  &   \\
    &   &\rt{1} &\lt{2} &   &   \\
    &   &\node  &   &   &   \\
\end{tree}}

\newcommand{\treeb}{
\begin{tree}
\node   &       &\node  \\
    &\rt{1}\lt{1}   &   \\
    &\node      &   \\
\end{tree}}

\newcommand{\treedb}{
\begin{tree}
\node   &   &   &\node  &\node      &\node  \\
\dn &   &   &   &\rt{1}\dn\lt{1}&   \\
\node   &   &   &   &\node      &   \\
    &\rt{2} &   &\lt{2} &       &   \\
    &   &\node  &   &       &   \\
\end{tree}}

\newcommand{\treebb}{
\begin{tree}
    &   &   &\node  &       &\node  \\
    &   &   &   &\rt{1}\lt{1}   &   \\
\node   &   &   &   &\node      &   \\
    &\rt{2} &   &\lt{2} &       &   \\
    &   &\node  &   &       &   \\
\end{tree}}

\newcommand{\treefg}{
\begin{tree}
\node   &\node  &\node  &\node  &   &\node  &   &\node  &
    &   &   &   &   \\
\dn &   &\rt{1}\dn\lt{1}&&  &   &\rt{1}\lt{1}&  &
    &   &   &   &   \\
\node   &   &\node  &   &\node  &   &\node  &   &
\node   &   &\node  &   &\node  \\
    &\rt{6} &   &\rt{4} &   &\rt{2} &\dn    &\lt{2} &
    &\lt{4} &   &\lt{6} &   \\
    &   &   &   &   &   &\node  &   &
    &   &   &   &   \\
\end{tree}}

\newcommand{\treeec}{
\begin{tree}
    &   &\node  &\node      &\node  &\node  &   &\node  \\
    &   &   &\rt{1} \dn \lt{1}& &   &\rt{1}\lt{1}&  \\
\node   &   &   &\node      &   &   &\node  &   \\
    &\rt{3} &   &\dn        &   &\lt{3} &   &   \\
    &   &   &\node      &   &   &   &   \\
\end{tree}}

\newcommand{\treeaaq}{
\begin{tree}
\node   \\
\dn \\
\node   \\
\dn \\
\node   \\
\vdots  \\
\node   \\
\dn \\
\node   \\
\end{tree}}

\newcommand{\treeq}{
\begin{tree}
\node   &\node  &   &\ldots &   &\node  \\
    &\rt{2} &\rt{1} &   &\lt{3} &   \\
    &   &\node  &   &   &   \\
\end{tree}}

\newcommand{\treea}{
\begin{tree}
\node   \\
\dn \\
\node   \\
\end{tree}}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Transistor section


\newlength{\volt}
\setlength{\volt}{1ex}

% A transistor; used like `transistor{a}{s1}{s2}{sn}{s}'
%
\newcommand{\transistor}[5]
{\setlength{\unitlength}{1\volt}
\begin{picture}(18,12)(-5,-6)
% main triangle
\put(0,6){\line(0,-1){12}} \put(0,-6){\line(3,2){9}}
\put(0,6){\line(3,-2){9}}
% legs
\put(9,0){\line(1,0){2}} \put(-2,4){\line(1,0){2}}
\put(-2,2){\line(1,0){2}} \put(-2,-4){\line(1,0){2}}
% leg-labels
\put(12,-0.5){\ensuremath{#5}} \put(-5,3.5){\ensuremath{#2}}
\put(-5,1.5){\ensuremath{#3}} \put(-5,-4.5){\ensuremath{#4}}
% ellipsis and centre-text
\thicklines \put(-1.5,0){\line(1,0){.1}}
\put(-1.5,-1){\line(1,0){.1}} \put(-1.5,-2){\line(1,0){.1}}
\thinlines \put(2,-0.5){\ensuremath{#1}}
\end{picture}}
%

% Centred transistor, for use in text
%
\newcommand{\ctransistor}[5]
    {\raisebox{-6\volt}{\transistor{#1}{#2}{#3}{#4}{#5}}}

% A brief transistor
%
\newcommand{\bftransistor}[4]
{\setlength{\unitlength}{1\volt}
\begin{picture}(18,12)(-5,-6)
% main triangle
\put(0,6){\line(0,-1){12}} \put(0,-6){\line(3,2){9}}
\put(0,6){\line(3,-2){9}}
% legs
\put(9,0){\line(1,0){2}} \put(-2,4){\line(1,0){2}}
\put(-2,-4){\line(1,0){2}}
% leg-labels
\put(12,-0.5){\ensuremath{#4}} \put(-5,3.5){\ensuremath{#2}}
\put(-5,-4.5){\ensuremath{#3}}
% ellipsis and centre-text
\thicklines \put(-1.5,1){\line(1,0){.1}}
\put(-1.5,0){\line(1,0){.1}} \put(-1.5,-1){\line(1,0){.1}}
\thinlines \put(2,-0.5){\ensuremath{#1}}
\end{picture}}
%

% Composite of transistors
%
\newcommand{\comptrans}[4]
{\setlength{\volt}{.5ex} \setlength{\unitlength}{1\volt}
\begin{picture}(80,72)(0,-36)
\put(0,23){\bftransistor{#1}{}{}{}}
\put(0,6){\bftransistor{#2}{}{}{}}
\put(0,-35){\bftransistor{#3}{}{}{}}
\put(63,-6){\transistor{#4}{}{}{}} \put(17,29){\line(2,-1){50}}
\put(17,12){\line(5,-1){50}} \put(17,-29){\line(2,1){50}}
\thicklines \put(24,-5){\line(1,0){.4}}
\put(24,-9){\line(1,0){.4}} \put(24,-13){\line(1,0){.4}}
\thinlines \setlength{\volt}{1ex}
\end{picture}}

% Centred composite of transistors, for use in text
%
\newcommand{\ccomptrans}[4]
    {\raisebox{-36\volt}{\comptrans{#1}{#2}{#3}{#4}}}

% A 3-legged transistor; used like `threetransistor{a}{s1}{s2}{s3}{s}'
%
\newcommand{\threetransistor}[5]
{\setlength{\unitlength}{1\volt}
\begin{picture}(18,12)(-5,-6)
% main triangle
\put(0,6){\line(0,-1){12}} \put(0,-6){\line(3,2){9}}
\put(0,6){\line(3,-2){9}}
% legs
\put(9,0){\line(1,0){2}} \put(-2,4){\line(1,0){2}}
\put(-2,0){\line(1,0){2}} \put(-2,-4){\line(1,0){2}}
% leg-labels
\put(12,-0.5){\ensuremath{#5}} \put(-5,3.5){\ensuremath{#2}}
\put(-5,-0.5){\ensuremath{#3}} \put(-5,-4.5){\ensuremath{#4}}
% centre-text
\put(2,-0.5){\ensuremath{#1}}
\end{picture}}
%

% A 2-legged transistor; used like `twotransistor{a}{s1}{s2}{s}'
%
\newcommand{\twotransistor}[4]
{\setlength{\unitlength}{1\volt}
\begin{picture}(18,12)(-5,-6)
% main triangle
\put(0,6){\line(0,-1){12}} \put(0,-6){\line(3,2){9}}
\put(0,6){\line(3,-2){9}}
% legs
\put(9,0){\line(1,0){2}} \put(-2,4){\line(1,0){2}}
\put(-2,-4){\line(1,0){2}}
% leg-labels
\put(12,-0.5){\ensuremath{#4}} \put(-5,3.5){\ensuremath{#2}}
\put(-5,-4.5){\ensuremath{#3}}
% centre-text
\put(2,-0.5){\ensuremath{#1}}
\end{picture}}
%

% A no-legged transistor; used like `notransistor{a}{s}'
%
\newcommand{\notransistor}[2]
{\setlength{\unitlength}{1\volt}
\begin{picture}(18,12)(-5,-6)
% main triangle
\put(0,6){\line(0,-1){12}} \put(0,-6){\line(3,2){9}}
\put(0,6){\line(3,-2){9}}
% leg
\put(9,0){\line(1,0){2}}
% leg-labels
\put(12,-0.5){\ensuremath{#2}}
% centre-text
\put(2,-0.5){\ensuremath{#1}}
\end{picture}}
%

% The picture for arrows in the free mon cat on a multicat
%
\newcommand{\freemoncatpic}
{\setlength{\volt}{.6ex} \setlength{\unitlength}{1\volt}
\begin{picture}(18,48)
\put(0,3){\twotransistor{\theta_3}{a_4}{a_5}{a'_3}}
\put(0,18){\notransistor{\theta_2}{a'_2}}
\put(0,33){\threetransistor{\theta_1}{a_1}{a_2}{a_3}{a'_1}}
%   \put(4.2,0){\framebox(12.6,48){}}
\put(5.7,0){\framebox(10.3,48){}}
\end{picture}}
%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Miscellaneous pictures

% _+1-multicat picture
%
\newcommand{\dotty}{\raisebox{-.4ex}{\ensuremath{\!\scriptstyle\bullet}}}
\newcommand{\discfibpic}
{\setlength{\unitlength}{1em}       % if you change this, also
                    % change cdiscfib below
\begin{picture}(16,9)(-6,0)
% main oval
\put(4,2){\oval(8,4)}
% dots
\put(4,8){\dotty} \put(2,2){\dotty} \put(4,1){\dotty}
\put(6,1){\dotty} \put(5,3){\dotty}
% arrows
\put(4,8){\vector(-1,-3){2}} \put(2,2){\vector(2,-1){2}}
\put(4,8){\vector(0,-1){7}} \put(2,2){\vector(3,1){3}}
\put(4,1){\vector(1,0){2}}
% text
\put(4.2,8){0} \put(4.2,5.5){\ensuremath{\theta\of y}}
\put(2.5,5.5){\ensuremath{y}} \put(1.2,1.7){\ensuremath{a}}
\put(3.6,.2){\ensuremath{a'}} \put(2.1,.9){\ensuremath{\theta}}
\put(8.5,1.5){\ensuremath{C_0}}
\end{picture}}
%

% Centred version of this, for use in text
%
\newcommand{\cdiscfibpic}{\raisebox{-4.5em}{\discfibpic}}
%


%-----------------------------------------------------------------------------

\makeatletter

\def\diagram{\m@th\leftwidth=\z@ \rightwidth=\z@ \topheight=\z@
\botheight=\z@ \setbox\@picbox\hbox\bgroup}

\def\enddiagram{\egroup\wd\@picbox\rightwidth\unitlength
\ht\@picbox\topheight\unitlength \dp\@picbox\botheight\unitlength
\hskip\leftwidth\unitlength\box\@picbox}

\def\bfig{\begin{diagram}}
\def\efig{\end{diagram}}
\newcount\wideness \newcount\leftwidth \newcount\rightwidth
\newcount\highness \newcount\topheight \newcount\botheight

\def\ratchet#1#2{\ifnum#1<#2 \global #1=#2 \fi}

\def\putbox(#1,#2)#3{%
\horsize{\wideness}{#3} \divide\wideness by 2 {\advance\wideness
by #1 \ratchet{\rightwidth}{\wideness}} {\advance\wideness by -#1
\ratchet{\leftwidth}{\wideness}} \vertsize{\highness}{#3}
\divide\highness by 2 {\advance\highness by #2
\ratchet{\topheight}{\highness}} {\advance\highness by -#2
\ratchet{\botheight}{\highness}} \put(#1,#2){\makebox(0,0){$#3$}}}

\def\putlbox(#1,#2)#3{%
\horsize{\wideness}{#3} {\advance\wideness by #1
\ratchet{\rightwidth}{\wideness}} {\ratchet{\leftwidth}{-#1}}
\vertsize{\highness}{#3} \divide\highness by 2 {\advance\highness
by #2 \ratchet{\topheight}{\highness}} {\advance\highness by -#2
\ratchet{\botheight}{\highness}}
\put(#1,#2){\makebox(0,0)[l]{$#3$}}}

\def\putrbox(#1,#2)#3{%
\horsize{\wideness}{#3} {\ratchet{\rightwidth}{#1}}
{\advance\wideness by -#1 \ratchet{\leftwidth}{\wideness}}
\vertsize{\highness}{#3} \divide\highness by 2 {\advance\highness
by #2 \ratchet{\topheight}{\highness}} {\advance\highness by -#2
\ratchet{\botheight}{\highness}}
\put(#1,#2){\makebox(0,0)[r]{$#3$}}}


\def\adjust[#1]{} % For compatibility

\newcount \coefa
\newcount \coefb
\newcount \coefc
\newcount\tempcounta
\newcount\tempcountb
\newcount\tempcountc
\newcount\tempcountd
\newcount\xext
\newcount\yext
\newcount\xoff
\newcount\yoff
\newcount\gap%
\newcount\arrowtypea
\newcount\arrowtypeb
\newcount\arrowtypec
\newcount\arrowtyped
\newcount\arrowtypee
\newcount\height
\newcount\width
\newcount\xpos
\newcount\ypos
\newcount\run
\newcount\rise
\newcount\arrowlength
\newcount\halflength
\newcount\arrowtype
\newdimen\tempdimen
\newdimen\xlen
\newdimen\ylen
\newsavebox{\tempboxa}%
\newsavebox{\tempboxb}%
\newsavebox{\tempboxc}%

\newdimen\w@dth

\def\setw@dth#1#2{\setbox\z@\hbox{\m@th$#1$}\w@dth=\wd\z@
\setbox\@ne\hbox{\m@th$#2$}\ifnum\w@dth<\wd\@ne \w@dth=\wd\@ne \fi
\advance\w@dth by 1.2em}

%The definitions below look more elaborate than they need to be.
%The reason is that an empty asscript will still cause extra vertical
%spacing and the only way to avoid ugly extra space seems to be using
%some such method as this.

\def\t@^#1_#2{\allowbreak\def\n@one{#1}\def\n@two{#2}\mathrel
{\setw@dth{#1}{#2} \mathop{\hbox to
\w@dth{\rightarrowfill}}\limits \ifx\n@one\empty\else
^{\box\z@}\fi \ifx\n@two\empty\else _{\box\@ne}\fi}}
%\def\t@^#1_#2{\mathrel{\mathop{\hbox{\rightarrowfill}}\limits
%^{\mkern12mu#1\mkern12mu}_{\mkern12mu#2\mkern12mu}}}
\def\t@@^#1{\@ifnextchar_{\t@^{#1}}{\t@^{#1}_{}}}
\def\to{\@ifnextchar^{\t@@}{\t@@^{}}}

\def\t@left^#1_#2{\def\n@one{#1}\def\n@two{#2}\mathrel{\setw@dth{#1}{#2}
\mathop{\hbox to \w@dth{\leftarrowfill}}\limits
\ifx\n@one\empty\else ^{\box\z@}\fi \ifx\n@two\empty\else
_{\box\@ne}\fi}}
%\def\t@left^#1_#2{\mathrel{\mathop{\hbox{\leftarrowfill}}\limits
%^{\mkern12mu#1\mkern12mu}_{\mkern12mu#2\mkern12mu}}}
\def\t@@left^#1{\@ifnextchar_{\t@left^{#1}}{\t@left^{#1}_{}}}
\def\toleft{\@ifnextchar^{\t@@left}{\t@@left^{}}}

\def\two@^#1_#2{\allowbreak
\def\n@one{#1}\def\n@two{#2}\mathrel{\setw@dth{#1}{#2}
\mathop{\vcenter{\lineskip\z@\baselineskip\z@
                 \hbox to \w@dth{\rightarrowfill}%
                 \hbox to \w@dth{\rightarrowfill}}%
       }\limits
\ifx\n@one\empty\else ^{\box\z@}\fi \ifx\n@two\empty\else
_{\box\@ne}\fi}}
\def\tw@@^#1{\@ifnextchar _{\two@^{#1}}{\two@^{#1}_{}}}
\def\two{\@ifnextchar ^{\tw@@}{\tw@@^{}}}

\def\tofr@^#1_#2{\def\n@one{#1}\def\n@two{#2}\mathrel{\setw@dth{#1}{#2}
\mathop{\vcenter{\hbox to \w@dth{\rightarrowfill}\kern-1.7ex
                 \hbox to \w@dth{\leftarrowfill}}%
       }\limits
\ifx\n@one\empty\else ^{\box\z@}\fi \ifx\n@two\empty\else
_{\box\@ne}\fi}}
\def\t@fr@^#1{\@ifnextchar_ {\tofr@^{#1}}{\tofr@^{#1}_{}}}
\def\tofro{\@ifnextchar^ {\t@fr@}{\t@fr@^{}}}

\def\epi{\mathop{\mathchar"221\mkern -12mu\mathchar"221}\limits}
\def\leftepi{\mathop{\mathchar"220\mkern -12mu\mathchar"220}\limits}
\def\mon{\mathop{\m@th\hbox to
      14.6\P@{\lasyb\char'51\hskip-2.1\P@$\arrext$\hss
$\mathord\rightarrow$}}\limits} % width of \epi
\def\leftmono{\mathrel{\m@th\hbox to
14.6\P@{$\mathord\leftarrow$\hss$\arrext$\hskip-2.1\P@\lasyb\char'50%
}}\limits} % width of \epi
\mathchardef\arrext="0200       % amr minus for arrow extension (see \into)


\setlength{\unitlength}{.01em}%
\def\settypes(#1,#2,#3){\arrowtypea#1 \arrowtypeb#2 \arrowtypec#3}
\def\settoheight#1#2{\setbox\@tempboxa\hbox{#2}#1\ht\@tempboxa\relax}%
\def\settodepth#1#2{\setbox\@tempboxa\hbox{#2}#1\dp\@tempboxa\relax}%
\def\settokens`#1`#2`#3`#4`{%
     \def\tokena{#1}\def\tokenb{#2}\def\tokenc{#3}\def\tokend{#4}}
\def\setsqparms[#1`#2`#3`#4;#5`#6]{%
\arrowtypea #1 \arrowtypeb #2 \arrowtypec #3 \arrowtyped #4
\width #5 \height #6 }
\def\setpos(#1,#2){\xpos=#1 \ypos#2}



\def\settriparms[#1`#2`#3;#4]{\settripairparms[#1`#2`#3`1`1;#4]}%

\def\settripairparms[#1`#2`#3`#4`#5;#6]{%
\arrowtypea #1 \arrowtypeb #2 \arrowtypec #3 \arrowtyped #4
\arrowtypee #5 \width #6 \height #6 }

\def\resetparms{\settripairparms[1`1`1`1`1;500]\width 500}%default values%

\resetparms

\def\mvector(#1,#2)#3{%%
\put(0,0){\vector(#1,#2){#3}}%
\put(0,0){\vector(#1,#2){26}}%
}
\def\evector(#1,#2)#3{{%%
\arrowlength #3
\put(0,0){\vector(#1,#2){\arrowlength}}%
\advance \arrowlength by-30
\put(0,0){\vector(#1,#2){\arrowlength}}%
}}

\def\horsize#1#2{%
\settowidth{\tempdimen}{$#2$}%
#1=\tempdimen \divide #1 by\unitlength }

\def\vertsize#1#2{%
\settoheight{\tempdimen}{$#2$}%
#1=\tempdimen
\settodepth{\tempdimen}{$#2$}%
\advance #1 by\tempdimen \divide #1 by\unitlength }

\def\putvector(#1,#2)(#3,#4)#5#6{{%
\ifnum3<\arrowtype \putdashvector(#1,#2)(#3,#4)#5\arrowtype \else
\ifnum\arrowtype<-3 \putdashvector(#1,#2)(#3,#4)#5\arrowtype \else
\xpos=#1 \ypos=#2 \run=#3 \rise=#4 \arrowlength=#5 \ifnum
\arrowtype<0
    \ifnum \run=0
        \advance \ypos by-\arrowlength
    \else
        \tempcounta \arrowlength
        \multiply \tempcounta by\rise
        \divide \tempcounta by\run
        \ifnum\run>0
            \advance \xpos by\arrowlength
            \advance \ypos by\tempcounta
        \else
            \advance \xpos by-\arrowlength
            \advance \ypos by-\tempcounta
        \fi
    \fi
    \multiply \arrowtype by-1
    \multiply \rise by-1
    \multiply \run by-1
\fi \ifcase \arrowtype
\or \put(\xpos,\ypos){\vector(\run,\rise){\arrowlength}}%
\or \put(\xpos,\ypos){\mvector(\run,\rise)\arrowlength}%
\or \put(\xpos,\ypos){\evector(\run,\rise){\arrowlength}}%
\fi\fi\fi }}

\def\putsplitvector(#1,#2)#3#4{%%
\xpos #1 \ypos #2 \arrowtype #4 \halflength #3 \arrowlength #3
\gap 140 \advance \halflength by-\gap \divide \halflength by2
\ifnum\arrowtype>0
   \ifcase \arrowtype
   \or \put(\xpos,\ypos){\line(0,-1){\halflength}}%
       \advance\ypos by-\halflength
       \advance\ypos by-\gap
       \put(\xpos,\ypos){\vector(0,-1){\halflength}}%
   \or \put(\xpos,\ypos){\line(0,-1)\halflength}%
       \put(\xpos,\ypos){\vector(0,-1)3}%
       \advance\ypos by-\halflength
       \advance\ypos by-\gap
       \put(\xpos,\ypos){\vector(0,-1){\halflength}}%
   \or \put(\xpos,\ypos){\line(0,-1)\halflength}%
       \advance\ypos by-\halflength
       \advance\ypos by-\gap
       \put(\xpos,\ypos){\evector(0,-1){\halflength}}%
   \fi
\else \arrowtype=-\arrowtype
   \ifcase\arrowtype
   \or \advance \ypos by-\arrowlength
       \put(\xpos,\ypos){\line(0,1){\halflength}}%
       \advance\ypos by\halflength
       \advance\ypos by\gap
       \put(\xpos,\ypos){\vector(0,1){\halflength}}%
   \or \advance \ypos by-\arrowlength
       \put(\xpos,\ypos){\line(0,1)\halflength}%
       \put(\xpos,\ypos){\vector(0,1)3}%
       \advance\ypos by\halflength
       \advance\ypos by\gap
       \put(\xpos,\ypos){\vector(0,1){\halflength}}%
   \or \advance \ypos by-\arrowlength
       \put(\xpos,\ypos){\line(0,1)\halflength}%
       \advance\ypos by\halflength
       \advance\ypos by\gap
       \put(\xpos,\ypos){\evector(0,1){\halflength}}%
   \fi
\fi }

\def\putmorphism(#1)(#2,#3)[#4`#5`#6]#7#8#9{{%
\run #2 \rise #3 \ifnum\rise=0
  \puthmorphism(#1)[#4`#5`#6]{#7}{#8}#9%
\else\ifnum\run=0
  \putvmorphism(#1)[#4`#5`#6]{#7}{#8}#9%
\else
\setpos(#1)%
\arrowlength #7 \arrowtype #8 \ifnum\run=0 \else\ifnum\rise=0
\else \ifnum\run>0
    \coefa=1
\else
   \coefa=-1
\fi \ifnum\arrowtype>0
   \coefb=0
   \coefc=-1
\else
   \coefb=\coefa
   \coefc=1
   \arrowtype=-\arrowtype
\fi \width=2 \multiply \width by\run \divide \width by\rise
\ifnum \width<0  \width=-\width\fi \advance\width by60 \if l#9
\width=-\width\fi
\putbox(\xpos,\ypos){#4}%            %node 1
{\multiply \coefa by\arrowlength%      %node 2
\advance\xpos by\coefa \multiply \coefa by\rise \divide \coefa
by\run \advance \ypos by\coefa
\putbox(\xpos,\ypos){#5} }%
{\multiply \coefa by\arrowlength%      %label
\divide \coefa by2 \advance \xpos by\coefa \advance \xpos by\width
\multiply \coefa by\rise \divide \coefa by\run \advance \ypos
by\coefa
\if l#9%
   \putrbox(\xpos,\ypos){#6}%
\else\if r#9%
   \putlbox(\xpos,\ypos){#6}%
\fi\fi }%
{\multiply \rise by-\coefc%             %arrow
\multiply \run by-\coefc \multiply \coefb by\arrowlength \advance
\xpos by\coefb \multiply \coefb by\rise \divide \coefb by\run
\advance \ypos by\coefb \multiply \coefc by70 \advance \ypos
by\coefc \multiply \coefc by\run \divide \coefc by\rise \advance
\xpos by\coefc \multiply \coefa by140 \multiply \coefa by\run
\divide \coefa by\rise \advance \arrowlength by\coefa
\ifcase\arrowtype
\or \put(\xpos,\ypos){\vector(\run,\rise){\arrowlength}}%
\or \put(\xpos,\ypos){\mvector(\run,\rise){\arrowlength}}%
\or \put(\xpos,\ypos){\evector(\run,\rise){\arrowlength}}%
\fi}\fi\fi\fi\fi}}


\newcount\numbdashes \newcount\lengthdash \newcount\increment

\def\howmanydashes{% Actually returns both number and length
\numbdashes=\arrowlength \lengthdash=40 \divide\numbdashes by
\lengthdash \lengthdash=\arrowlength \divide\lengthdash by
\numbdashes
%This futzing around is to minimize round-off error.
\increment=\lengthdash \multiply\lengthdash by 3
\divide\lengthdash by 5 }

\def\putdashvector(#1)(#2,#3)#4#5{%
\ifnum#3=0 \putdashhvector(#1){#4}#5 \else \ifnum#2=0
\putdashvvector(#1){#4}#5\fi\fi}

\def\putdashhvector(#1,#2)#3#4{{%
\arrowlength=#3 \howmanydashes
\multiput(#1,#2)(\increment,0){\numbdashes}%
{\vrule height .4pt width \lengthdash\unitlength} \arrowtype=#4
\xpos=#1 \ifnum\arrowtype<0 \advance\arrowtype by 7 \fi
\ifcase\arrowtype \or \advance\xpos by 10
    \put(\xpos,#2){\vector(-1,0){\lengthdash}}
    \advance\xpos by 40
    \put(\xpos,#2){\vector(-1,0){\lengthdash}}
\or \advance \xpos by 10
    \put(\xpos,#2){\vector(-1,0){\lengthdash}}
    \advance\xpos by  \arrowlength
    \advance\xpos by  -50
    \put(\xpos,#2){\vector(-1,0){\lengthdash}}
\or \advance\xpos by 10
    \put(\xpos,#2){\vector(-1,0){\lengthdash}}
\or \advance\xpos by \arrowlength
    \advance\xpos by -\lengthdash
    \put(\xpos,#2){\vector(1,0){\lengthdash}}
\or {\advance\xpos by 10
    \put(\xpos,#2){\vector(1,0){\lengthdash}}}
    \advance\xpos by \arrowlength
    \advance\xpos by -\lengthdash
    \put(\xpos,#2){\vector(1,0){\lengthdash}}
\or \advance\xpos by \arrowlength
    \advance\xpos by -\lengthdash
    \put(\xpos,#2){\vector(1,0){\lengthdash}}
    \advance\xpos by -40
    \put(\xpos,#2){\vector(1,0){\lengthdash}}
   \fi
}}

\def\putdashvvector(#1,#2)#3#4{{%
\arrowlength=#3 \howmanydashes \ypos=#2 \advance\ypos by
-\arrowlength
\multiput(#1,#2)(0,\increment){\numbdashes}%
    {\vrule width .4pt height \lengthdash\unitlength}
\arrowtype=#4 \ypos=#2 \ifnum\arrowtype<0 \advance\arrowtype by 7
\fi \ifcase\arrowtype \or \advance\ypos by \arrowlength
\advance\ypos by -40
    \put(#1,\ypos){\vector(0,1){\lengthdash}}
    \advance\ypos by -40
    \put(#1,\ypos){\vector(0,1){\lengthdash}}
\or \advance\ypos by 10
    \put(#1,\ypos){\vector(0,1){\lengthdash}}
    \advance\ypos by \arrowlength \advance\ypos by -40
    \put(#1,\ypos){\vector(0,1){\lengthdash}}
\or \advance\ypos by \arrowlength \advance\ypos by -40
    \put(#1,\ypos){\vector(0,1){\lengthdash}}
\or \advance\ypos by 10
    \put(#1,\ypos){\vector(0,-1){\lengthdash}}
\or \advance\ypos by 10
    \put(#1,\ypos){\vector(0,-1){\lengthdash}}
    \advance\ypos by \arrowlength \advance\ypos by -40
    \put(#1,\ypos){\vector(0,-1){\lengthdash}}
\or \advance\ypos by 10
    \put(#1,\ypos){\vector(0,-1){\lengthdash}}
    \advance\ypos by 40
    \put(#1,\ypos){\vector(0,-1){\lengthdash}}
\fi }}

\def\puthmorphism(#1,#2)[#3`#4`#5]#6#7#8{{%
\xpos #1 \ypos #2 \width #6 \arrowlength #6 \arrowtype=#7
\putbox(\xpos,\ypos){#3\vphantom{#4}}%
{\advance \xpos by\arrowlength
\putbox(\xpos,\ypos){\vphantom{#3}#4}}%
\horsize{\tempcounta}{#3}%
\horsize{\tempcountb}{#4}%
\divide \tempcounta by2 \divide \tempcountb by2 \advance
\tempcounta by30 \advance \tempcountb by30 \advance \xpos
by\tempcounta \advance \arrowlength by-\tempcounta \advance
\arrowlength by-\tempcountb
\putvector(\xpos,\ypos)(1,0)\arrowlength\arrowtype \divide
\arrowlength by2 \advance \xpos by\arrowlength
\vertsize{\tempcounta}{#5}%
\divide\tempcounta by2 \advance \tempcounta by20
\if a#8 %
   \advance \ypos by\tempcounta
   \putbox(\xpos,\ypos){#5}%
\else
   \advance \ypos by-\tempcounta
   \putbox(\xpos,\ypos){#5}%
\fi}}

\def\putvmorphism(#1,#2)[#3`#4`#5]#6#7#8{{%
\xpos #1 \ypos #2 \arrowlength #6 \arrowtype #7
\settowidth{\xlen}{$#5$}%
\putbox(\xpos,\ypos){#3}%
{\advance \ypos by-\arrowlength
\putbox(\xpos,\ypos){#4}}%
{\advance\arrowlength by-140 \advance \ypos by-70 \ifdim\xlen>0pt
   \if m#8%
      \putsplitvector(\xpos,\ypos)\arrowlength\arrowtype
   \else
   \putvector(\xpos,\ypos)(0,-1)\arrowlength\arrowtype
   \fi
\else
   \putvector(\xpos,\ypos)(0,-1)\arrowlength\arrowtype
\fi}%
\ifdim\xlen>0pt
   \divide \arrowlength by2
   \advance\ypos by-\arrowlength
   \if l#8%
      \advance \xpos by-40
      \putrbox(\xpos,\ypos){#5}%
   \else\if r#8%
      \advance \xpos by40
      \putlbox(\xpos,\ypos){#5}%
   \else
      \putbox(\xpos,\ypos){#5}%
   \fi\fi
\fi }}

\def\putsquarep<#1>(#2)[#3;#4`#5`#6`#7]{{%
\setsqparms[#1]%
\setpos(#2)%
\settokens`#3`%
\puthmorphism(\xpos,\ypos)[\tokenc`\tokend`{#7}]{\width}{\arrowtyped}b%
\advance\ypos by \height
\puthmorphism(\xpos,\ypos)[\tokena`\tokenb`{#4}]{\width}{\arrowtypea}a%
\putvmorphism(\xpos,\ypos)[``{#5}]{\height}{\arrowtypeb}l%
\advance\xpos by \width
\putvmorphism(\xpos,\ypos)[``{#6}]{\height}{\arrowtypec}r%
}}

\def\putsquare{\@ifnextchar <{\putsquarep}{\putsquarep%
   <\arrowtypea`\arrowtypeb`\arrowtypec`\arrowtyped;\width`\height>}}
\def\square{\@ifnextchar< {\squarep}{\squarep
   <\arrowtypea`\arrowtypeb`\arrowtypec`\arrowtyped;\width`\height>}}
                                                   %         #6
\def\squarep<#1>[#2`#3`#4`#5;#6`#7`#8`#9]{{%       %     #2------>#3
\setsqparms[#1]%                                   %      |       |
\diagram%                                          %      |       |
\putsquarep<\arrowtypea`\arrowtypeb`\arrowtypec`%  %    #7|       |#8
\arrowtyped;\width`\height>%                       %      |       |
(0,0)[#2`#3`#4`{#5};#6`#7`#8`{#9}]%                %      |       |
\enddiagram%                                       %      v       v
}}                                                 %     #4------>#5
                                                   %         #9
\def\putptrianglep<#1>(#2,#3)[#4`#5`#6;#7`#8`#9]{{%
\settriparms[#1]%
\xpos=#2 \ypos=#3 \advance\ypos by \height
\puthmorphism(\xpos,\ypos)[#4`#5`{#7}]{\height}{\arrowtypea}a%
\putvmorphism(\xpos,\ypos)[`#6`{#8}]{\height}{\arrowtypeb}l%
\advance\xpos by\height
\putmorphism(\xpos,\ypos)(-1,-1)[``{#9}]{\height}{\arrowtypec}r%
}}

\def\putptriangle{\@ifnextchar <{\putptrianglep}{\putptrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
\def\ptriangle{\@ifnextchar <{\ptrianglep}{\ptrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
                                              %          #5
\def\ptrianglep<#1>[#2`#3`#4;#5`#6`#7]{{%%    %      #2----->#3
\settriparms[#1]%                             %      |      /
\diagram%                                     %      |     /
\putptrianglep<\arrowtypea`\arrowtypeb`%      %    #6|    /#7
\arrowtypec;\height>%                         %      |   /
(0,0)[#2`#3`#4;#5`#6`{#7}]%                   %      |  /
\enddiagram%%                                 %      v v
}}                                            %      #4

\def\putqtrianglep<#1>(#2,#3)[#4`#5`#6;#7`#8`#9]{{%
\settriparms[#1]%
\xpos=#2 \ypos=#3 \advance\ypos by\height
\puthmorphism(\xpos,\ypos)[#4`#5`{#7}]{\height}{\arrowtypea}a%
\putmorphism(\xpos,\ypos)(1,-1)[``{#8}]{\height}{\arrowtypeb}l%
\advance\xpos by\height
\putvmorphism(\xpos,\ypos)[`#6`{#9}]{\height}{\arrowtypec}r%
}}

\def\putqtriangle{\@ifnextchar <{\putqtrianglep}{\putqtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
\def\qtriangle{\@ifnextchar <{\qtrianglep}{\qtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
                                              %           #5
\def\qtrianglep<#1>[#2`#3`#4;#5`#6`#7]{{%%    %        #2----->#3
\settriparms[#1]%                             %         \      |
\width=\height                                %          \     |
\diagram%                                     %         #6\    |#7
\putqtrianglep<\arrowtypea`\arrowtypeb`%      %            \   |
\arrowtypec;\height>%                         %             \  |
(0,0)[#2`#3`#4;#5`#6`{#7}]%                   %              v v
\enddiagram%%                                 %               #4
}}

\def\putdtrianglep<#1>(#2,#3)[#4`#5`#6;#7`#8`#9]{{%
\settriparms[#1]%
\xpos=#2 \ypos=#3
\puthmorphism(\xpos,\ypos)[#5`#6`{#9}]{\height}{\arrowtypec}b%
\advance\xpos by \height \advance\ypos by\height
\putmorphism(\xpos,\ypos)(-1,-1)[``{#7}]{\height}{\arrowtypea}l%
\putvmorphism(\xpos,\ypos)[#4``{#8}]{\height}{\arrowtypeb}r%
}}

\def\putdtriangle{\@ifnextchar <{\putdtrianglep}{\putdtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
\def\dtriangle{\@ifnextchar <{\dtrianglep}{\dtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
                                              %                   #2
\def\dtrianglep<#1>[#2`#3`#4;#5`#6`#7]{{%%    %                  / |
\settriparms[#1]%                             %                 /  |
\width=\height                                %              #5/   |#6
\diagram%                                     %               /    |
\putdtrianglep<\arrowtypea`\arrowtypeb`%      %              /     |
\arrowtypec;\height>%                         %             v      v
(0,0)[#2`#3`#4;#5`#6`{#7}]%                   %            #3----->#4
\enddiagram%%                                 %                #7
}}

\def\putbtrianglep<#1>(#2,#3)[#4`#5`#6;#7`#8`#9]{{%
\settriparms[#1]%
\xpos=#2 \ypos=#3
\puthmorphism(\xpos,\ypos)[#5`#6`{#9}]{\height}{\arrowtypec}b%
\advance\ypos by\height
\putmorphism(\xpos,\ypos)(1,-1)[``{#8}]{\height}{\arrowtypeb}r%
\putvmorphism(\xpos,\ypos)[#4``{#7}]{\height}{\arrowtypea}l%
}}

\def\putbtriangle{\@ifnextchar <{\putbtrianglep}{\putbtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
\def\btriangle{\@ifnextchar <{\btrianglep}{\btrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
                                             %              #2
\def\btrianglep<#1>[#2`#3`#4;#5`#6`#7]{{%%   %              | \
\settriparms[#1]%                            %              |  \
\width=\height                               %            #5|   \#6
\diagram%                                    %              |    \
\putbtrianglep<\arrowtypea`\arrowtypeb`%     %              |     \
\arrowtypec;\height>%                        %              v      v
(0,0)[#2`#3`#4;#5`#6`{#7}]%                  %              #3----->#4
\enddiagram%%                                %                 #7
}}

\def\putAtrianglep<#1>(#2,#3)[#4`#5`#6;#7`#8`#9]{{%
\settriparms[#1]%
\xpos=#2 \ypos=#3 {\multiply \height by2
\puthmorphism(\xpos,\ypos)[#5`#6`{#9}]{\height}{\arrowtypec}b}%
\advance\xpos by\height \advance\ypos by\height
\putmorphism(\xpos,\ypos)(-1,-1)[#4``{#7}]{\height}{\arrowtypea}l%
\putmorphism(\xpos,\ypos)(1,-1)[``{#8}]{\height}{\arrowtypeb}r%
}}

\def\putAtriangle{\@ifnextchar <{\putAtrianglep}{\putAtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
\def\Atriangle{\@ifnextchar <{\Atrianglep}{\Atrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
                                                   %           #2
\def\Atrianglep<#1>[#2`#3`#4;#5`#6`#7]{{%%         %         /   \
\settriparms[#1]%                                  %        /     \
\width=\height                                     %     #5/       \#6
\diagram%                                          %      /         \
\putAtrianglep<\arrowtypea`\arrowtypeb`%           %     /           \
\arrowtypec;\height>%                              %    v             v
(0,0)[#2`#3`#4;#5`#6`{#7}]%                        %   #3------------>#4
\enddiagram%%                                      %          #7
}}

\def\putAtrianglepairp<#1>(#2)[#3;#4`#5`#6`#7`#8]{{%
\settripairparms[#1]%
\setpos(#2)%
\settokens`#3`%
\puthmorphism(\xpos,\ypos)[\tokenb`\tokenc`{#7}]{\height}{\arrowtyped}b%
\advance\xpos by\height
\puthmorphism(\xpos,\ypos)[\phantom{\tokenc}`\tokend`{#8}]%
{\height}{\arrowtypee}b%
\advance\ypos by\height
\putmorphism(\xpos,\ypos)(-1,-1)[\tokena``{#4}]{\height}{\arrowtypea}l%
\putvmorphism(\xpos,\ypos)[``{#5}]{\height}{\arrowtypeb}m%
\putmorphism(\xpos,\ypos)(1,-1)[``{#6}]{\height}{\arrowtypec}r%
}}

\def\putAtrianglepair{\@ifnextchar <{\putAtrianglepairp}{\putAtrianglepairp%
   <\arrowtypea`\arrowtypeb`\arrowtypec`\arrowtyped`\arrowtypee;\height>}}
\def\Atrianglepair{\@ifnextchar <{\Atrianglepairp}{\Atrianglepairp%
   <\arrowtypea`\arrowtypeb`\arrowtypec`\arrowtyped`\arrowtypee;\height>}}

\def\Atrianglepairp<#1>[#2;#3`#4`#5`#6`#7]{{%           %  #2a
\settripairparms[#1]%                         %           / | \
\settokens`#2`%                               %          /  |  \
\width=\height                                %       #3/  #4   \#5
\diagram%                                     %        /    |    \
\putAtrianglepairp                            %       /     |     \
<\arrowtypea`\arrowtypeb`\arrowtypec`%        %      v      v      v
\arrowtyped`\arrowtypee;\height>%             %     #2b---->#2c---->#2d
(0,0)[{#2};#3`#4`#5`#6`{#7}]%                 %         #6     #7
\enddiagram%%
}}

\def\putVtrianglep<#1>(#2,#3)[#4`#5`#6;#7`#8`#9]{{%
\settriparms[#1]%
\xpos=#2 \ypos=#3 \advance\ypos by\height {\multiply\height by2
\puthmorphism(\xpos,\ypos)[#4`#5`{#7}]{\height}{\arrowtypea}a}%
\putmorphism(\xpos,\ypos)(1,-1)[`#6`{#8}]{\height}{\arrowtypeb}l%
\advance\xpos by\height \advance\xpos by\height
\putmorphism(\xpos,\ypos)(-1,-1)[``{#9}]{\height}{\arrowtypec}r%
}}

\def\putVtriangle{\@ifnextchar <{\putVtrianglep}{\putVtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
\def\Vtriangle{\@ifnextchar <{\Vtrianglep}{\Vtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
                                               %               #5
\def\Vtrianglep<#1>[#2`#3`#4;#5`#6`#7]{{%%     %        #2------------->#3
\settriparms[#1]%                              %         \             /
\width=\height                                 %          \           /
\diagram%                                      %         #6\         /#7
\putVtrianglep<\arrowtypea`\arrowtypeb`%       %            \       /
\arrowtypec;\height>%                          %             \     /
(0,0)[#2`#3`#4;#5`#6`{#7}]%                    %              v   v
\enddiagram%%                                  %               #4
}}

\def\putVtrianglepairp<#1>(#2)[#3;#4`#5`#6`#7`#8]{{
\settripairparms[#1]%
\setpos(#2)%
\settokens`#3`%
\advance\ypos by\height
\putmorphism(\xpos,\ypos)(1,-1)[`\tokend`{#6}]{\height}{\arrowtypec}l%
\puthmorphism(\xpos,\ypos)[\tokena`\tokenb`{#4}]{\height}{\arrowtypea}a%
\advance\xpos by\height
\puthmorphism(\xpos,\ypos)[\phantom{\tokenb}`\tokenc`{#5}]%
{\height}{\arrowtypeb}a%
\putvmorphism(\xpos,\ypos)[``{#7}]{\height}{\arrowtyped}m%
\advance\xpos by\height
\putmorphism(\xpos,\ypos)(-1,-1)[``{#8}]{\height}{\arrowtypee}r%
}}

\def\putVtrianglepair{\@ifnextchar <{\putVtrianglepairp}{\putVtrianglepairp%
    <\arrowtypea`\arrowtypeb`\arrowtypec`\arrowtyped`\arrowtypee;\height>}}
\def\Vtrianglepair{\@ifnextchar <{\Vtrianglepairp}{\Vtrianglepairp%
    <\arrowtypea`\arrowtypeb`\arrowtypec`\arrowtyped`\arrowtypee;\height>}}
                                               %     #3      #4
\def\Vtrianglepairp<#1>[#2;#3`#4`#5`#6`#7]{{%  %  #2a---->#2b---->#2c
\settripairparms[#1]%                          %   \      |      /
\settokens`#2`%                                %    \     |     /
\diagram%                                      %   #5\   #6    /#7
\putVtrianglepairp                             %      \   |   /
<\arrowtypea`\arrowtypeb`\arrowtypec`%         %       \  |  /
\arrowtyped`\arrowtypee;\height>%              %        v v v
(0,0)[{#2};#3`#4`#5`#6`{#7}]%                  %         #2d
\enddiagram%%
}}


\def\putCtrianglep<#1>(#2,#3)[#4`#5`#6;#7`#8`#9]{{%
\settriparms[#1]%
\xpos=#2 \ypos=#3 \advance\ypos by\height
\putmorphism(\xpos,\ypos)(1,-1)[``{#9}]{\height}{\arrowtypec}l%
\advance\xpos by\height \advance\ypos by\height
\putmorphism(\xpos,\ypos)(-1,-1)[#4`#5`{#7}]{\height}{\arrowtypea}l%
{\multiply\height by 2
\putvmorphism(\xpos,\ypos)[`#6`{#8}]{\height}{\arrowtypeb}r}%
}}

\def\putCtriangle{\@ifnextchar <{\putCtrianglep}{\putCtrianglep
    <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
\def\Ctriangle{\@ifnextchar <{\Ctrianglep}{\Ctrianglep
    <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
                                             %                 #2
\def\Ctrianglep<#1>[#2`#3`#4;#5`#6`#7]{{%%   %                / |
\settriparms[#1]%                            %             #5/  |
\width=\height                               %              /   |
\diagram%                                    %             v    |
\putCtrianglep<\arrowtypea`\arrowtypeb`%     %           #3     |#6
\arrowtypec;\height>%                        %             \    |
(0,0)[#2`#3`#4;#5`#6`{#7}]%                  %            #7\   |
\enddiagram%%                                %               \  |
}}                                           %                v v
                                             %                 #4
\def\putDtrianglep<#1>(#2,#3)[#4`#5`#6;#7`#8`#9]{{%
\settriparms[#1]%
\xpos=#2 \ypos=#3 \advance\xpos by\height \advance\ypos by\height
\putmorphism(\xpos,\ypos)(-1,-1)[``{#9}]{\height}{\arrowtypec}r%
\advance\xpos by-\height \advance\ypos by\height
\putmorphism(\xpos,\ypos)(1,-1)[`#5`{#8}]{\height}{\arrowtypeb}r%
{\multiply\height by 2
\putvmorphism(\xpos,\ypos)[#4`#6`{#7}]{\height}{\arrowtypea}l}%
}}

\def\putDtriangle{\@ifnextchar <{\putDtrianglep}{\putDtrianglep
    <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
\def\Dtriangle{\@ifnextchar <{\Dtrianglep}{\Dtrianglep
   <\arrowtypea`\arrowtypeb`\arrowtypec;\height>}}
                                            %          #2
\def\Dtrianglep<#1>[#2`#3`#4;#5`#6`#7]{{%%  %          | \
\settriparms[#1]%                           %          |  \#6
\width=\height                              %          |   \
\diagram%                                   %          |    v
\putDtrianglep<\arrowtypea`\arrowtypeb`%    %        #5|    #3
\arrowtypec;\height>%                       %          |    /
(0,0)[#2`#3`#4;#5`#6`{#7}]%                 %          |   /#7
\enddiagram%%                               %          |  /
}}                                          %          v v
                                            %          #4
\def\setrecparms[#1`#2]{\width=#1 \height=#2}%
%              #4
%        #3b<-------#3a x #3b
%       ^ |             |
%      /  |             |
%   #5/   |             |
%    /    |             |
%   /     |             |
%  /      |             |
% #3c     |#6           |#3a x #5
%  \      |             |
%   \     |             |
%  #8\    |             |
%     \   |             |
%      \  |             |
%       v v             v
%        #3d<-------#3a x #3d
%              #8

\def\recursep<#1`#2>[#3;#4`#5`#6`#7`#8]{{\m@th
\width=#1 \height=#2 \settokens`#3`
\settowidth{\tempdimen}{$\tokena$} \ifdim\tempdimen=0pt
  \savebox{\tempboxa}{\hbox{$\tokenb$}}%
  \savebox{\tempboxb}{\hbox{$\tokend$}}%
  \savebox{\tempboxc}{\hbox{$#6$}}%
\else
  \savebox{\tempboxa}{\hbox{$\hbox{$\tokena$}\times\hbox{$\tokenb$}$}}%
  \savebox{\tempboxb}{\hbox{$\hbox{$\tokena$}\times\hbox{$\tokend$}$}}%
  \savebox{\tempboxc}{\hbox{$\hbox{$\tokena$}\times\hbox{$#6$}$}}%
\fi \ypos=\height \divide\ypos by 2 \xpos=\ypos \advance\xpos by
\width \bfig
\putCtrianglep<-1`1`1;\ypos>(0,0)[`\tokenc`;#5`#6`{#7}]%
\puthmorphism(\ypos,0)[\tokend`\usebox{\tempboxb}`{#8}]{\width}{-1}b%
\puthmorphism(\ypos,\height)[\tokenb`\usebox{\tempboxa}`{#4}]{\width}{-1}a%
\advance\ypos by \width
\putvmorphism(\ypos,\height)[``\usebox{\tempboxc}]{\height}1r%
\efig }}

\def\recurse{\@ifnextchar <{\recursep}{\recursep<\width`\height>}}

\def\puttwohmorphisms(#1,#2)[#3`#4;#5`#6]#7#8#9{{%
% 1 and 2 are position, 3 and 4 are the nodes, 5 and 6 the labels,
% 7 the distance between node centers and 8 & 9 are the arrow types.
%         #5
% #3 ===========> #4
%         #6
%
\puthmorphism(#1,#2)[#3`#4`]{#7}0a \ypos=#2 \advance\ypos by 20
\puthmorphism(#1,\ypos)[\phantom{#3}`\phantom{#4}`#5]{#7}{#8}a
\advance\ypos by -40
\puthmorphism(#1,\ypos)[\phantom{#3}`\phantom{#4}`#6]{#7}{#9}b }}

\def\puttwovmorphisms(#1,#2)[#3`#4;#5`#6]#7#8#9{{%
% 1 and 2 are position, 3 and 4 are the nodes, 5 and 6 the labels,
% 7 the distance between node centers and 8 & 9 are the arrow types.
%
%              #3
%              ||
%              ||
%           #5 || #6
%              ||
%              ||
%              vv
%              #4
%
\putvmorphism(#1,#2)[#3`#4`]{#7}0a \xpos=#1 \advance\xpos by -20
\putvmorphism(\xpos,#2)[\phantom{#3}`\phantom{#4}`#5]{#7}{#8}l
\advance\xpos by 40
\putvmorphism(\xpos,#2)[\phantom{#3}`\phantom{#4}`#6]{#7}{#9}r }}

\def\puthcoequalizer(#1)[#2`#3`#4;#5`#6`#7]#8#9{{%
% #1 is (\xpos,\ypos), the next 6 are the nodes and arrow labels
% #8 is the distance between each pair of nodes and #9 is the pos of #7
% either a (above) or b (below)
%         #5            #7
% #2 ===========> #3 --------> #4
%         #6
%
\setpos(#1)%
\puttwohmorphisms(\xpos,\ypos)[#2`#3;#5`#6]{#8}11%
\advance\xpos by #8
\puthmorphism(\xpos,\ypos)[\phantom{#3}`#4`#7]{#8}1{#9} }}

\def\putvcoequalizer(#1)[#2`#3`#4;#5`#6`#7]#8#9{{%
% #1 is (\xpos,\ypos), the next 6 are the nodes and arrow labels
% #8 is the distance between each pair of nodes and #9 is the pos of #7
% either l (left) or r (right)
%
%              #2
%              | |
%              | |
%           #5 | | #6
%              | |
%              | |
%              v v
%              #3
%               |
%               |
%            #7 |
%               |
%               v
%              #4
%
\setpos(#1)%
\puttwovmorphisms(\xpos,\ypos)[#2`#3;#5`#6]{#8}11%
\advance\ypos by -#8
\putvmorphism(\xpos,\ypos)[\phantom{#3}`#4`#7]{#8}1{#9} }}

\def\putthreehmorphisms(#1)[#2`#3;#4`#5`#6]#7(#8)#9{{%
% Use: \putthreehmorphisms(xpos,ypos)[lnode`rnode;toplabel`midlabel%
% botlabel]{distance}(toparrowtype,midarrowtype,botarrowtype){position}
\setpos(#1) \settypes(#8)
\if a#9 %
     \vertsize{\tempcounta}{#5}%
     \vertsize{\tempcountb}{#6}%
     \ifnum \tempcounta<\tempcountb \tempcounta=\tempcountb \fi
\else
     \vertsize{\tempcounta}{#4}%
     \vertsize{\tempcountb}{#5}%
     \ifnum \tempcounta<\tempcountb \tempcounta=\tempcountb \fi
\fi \advance \tempcounta by 60
\puthmorphism(\xpos,\ypos)[#2`#3`#5]{#7}{\arrowtypeb}{#9}
\advance\ypos by \tempcounta
\puthmorphism(\xpos,\ypos)[\phantom{#2}`\phantom{#3}`#4]{#7}{\arrowtypea}{#9}
\advance\ypos by -\tempcounta \advance\ypos by -\tempcounta
\puthmorphism(\xpos,\ypos)[\phantom{#2}`\phantom{#3}`#6]{#7}{\arrowtypec}{#9}
}}

\def\setarrowtoks[#1`#2`#3`#4`#5`#6]{%
\def\toka{#1}
\def\tokb{#2}
\def\tokc{#3}
\def\tokd{#4}
\def\toke{#5}
\def\tokf{#6}
}
\def\hex{\@ifnextchar <{\hexp}{\hexp<1000`400>}}
\def\hexp<#1`#2>[#3`#4`#5`#6`#7`#8;#9]{%
\setarrowtoks[#9] \yext=#2 \advance \yext by #2 \xext=#1
\advance\xext by \yext \bfig
\putCtriangle<-1`0`1;#2>(0,0)[`#5`;\tokb``\tokd] \xext=#1
\yext=#2 \advance \yext by #2
\putsquare<1`0`0`1;\xext`\yext>(#2,0)[#3`#4`#7`#8;\toka```\tokf]
\advance \xext by #2
\putDtriangle<0`1`-1;#2>(\xext,0)[`#6`;`\tokc`\toke] \efig }

\makeatother
